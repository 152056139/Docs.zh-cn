---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/common-configuration-differences-between-development-and-production-vb
title: "开发和生产环境 (VB) 之间的常见配置差异 |Microsoft 文档"
author: rick-anderson
description: "在前面的教程，我们通过将所有相关文件从开发环境复制到生产环境中部署了我们的网站。 但是，我..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/01/2009
ms.topic: article
ms.assetid: 548e75f6-4d6c-4cb4-8da8-417915eb8393
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/common-configuration-differences-between-development-and-production-vb
msc.type: authoredcontent
ms.openlocfilehash: 3a98ee93df9ef7c94b3d0da81c095cccedadf05f
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/10/2017
---
<a name="common-configuration-differences-between-development-and-production-vb"></a><span data-ttu-id="5ad5f-104">开发和生产环境 (VB) 之间的常见配置差异</span><span class="sxs-lookup"><span data-stu-id="5ad5f-104">Common Configuration Differences Between Development and Production (VB)</span></span>
====================
<span data-ttu-id="5ad5f-105">通过[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="5ad5f-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

[<span data-ttu-id="5ad5f-106">下载 PDF</span><span class="sxs-lookup"><span data-stu-id="5ad5f-106">Download PDF</span></span>](http://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial05_ConfigDifferences_vb.pdf)

> <span data-ttu-id="5ad5f-107">在前面的教程，我们通过将所有相关文件从开发环境复制到生产环境中部署了我们的网站。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-107">In earlier tutorials we deployed our website by copying all of the pertinent files from the development environment to the production environment.</span></span> <span data-ttu-id="5ad5f-108">但是，不少见，才会配置环境，这使得需要每个环境已具有唯一的 Web.config 文件之间的差异。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-108">However, it is not uncommon for there to be configuration differences between environments, which necessitates that each environment have a unique Web.config file.</span></span> <span data-ttu-id="5ad5f-109">本教程检查典型配置差异，并考察维护单独的配置信息的策略。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-109">This tutorial examines typical configuration differences and looks at strategies for maintaining separate configuration information.</span></span>


## <a name="introduction"></a><span data-ttu-id="5ad5f-110">介绍</span><span class="sxs-lookup"><span data-stu-id="5ad5f-110">Introduction</span></span>


<span data-ttu-id="5ad5f-111">最后两个教程在遍历部署简单的 web 应用程序。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-111">The last two tutorials walked through deploying a simple web application.</span></span> <span data-ttu-id="5ad5f-112">[*部署你的网站使用 FTP 客户端*](deploying-your-site-using-an-ftp-client-vb.md)教程介绍了如何使用独立的 FTP 客户端将所需的文件复制到生产开发环境中。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-112">The [*Deploying Your Site Using an FTP Client*](deploying-your-site-using-an-ftp-client-vb.md) tutorial showed how to use a stand-alone FTP client to copy the necessary files from the development environment up to production.</span></span> <span data-ttu-id="5ad5f-113">在前面的教程， [*部署您站点使用 Visual Studio*](deploying-your-site-using-visual-studio-vb.md)，查找在部署使用 Visual Studio 的复制网站工具和发布选项。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-113">The preceding tutorial, [*Deploying Your Site Using Visual Studio*](deploying-your-site-using-visual-studio-vb.md), looked at deployment using Visual Studio's Copy Web Site tool and Publish option.</span></span> <span data-ttu-id="5ad5f-114">在这两篇教程在生产环境中的每个文件是在开发环境文件的副本。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-114">In both tutorials every file in the production environment was a copy of a file on the development environment.</span></span> <span data-ttu-id="5ad5f-115">但是，不常见的不同于开发环境中的生产环境中的配置文件。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-115">However, it is not uncommon for configuration files in the production environment to differ from those in the development environment.</span></span> <span data-ttu-id="5ad5f-116">Web 应用程序的配置存储在`Web.config`文件，并通常包括有关外部资源，如数据库、 web 和电子邮件服务器的信息。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-116">A web application's configuration is stored in the `Web.config` file and typically includes information about external resources, such as database, web, and e-mail servers.</span></span> <span data-ttu-id="5ad5f-117">它还规定了某些情况下，例如的未经处理的异常发生时要采取的操作过程中的应用程序的行为。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-117">It also spells out the behavior of the application in certain situations, such as the course of action to take when an unhandled exception occurs.</span></span>

<span data-ttu-id="5ad5f-118">部署 web 应用程序时很重要，正确的配置信息结束，在生产环境中。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-118">When deploying a web application it is important that the correct configuration information end up in the production environment.</span></span> <span data-ttu-id="5ad5f-119">在大多数情况下`Web.config`在开发环境中的文件无法被复制到生产环境中作为-是。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-119">In most cases the `Web.config` file in the development environment cannot be copied to the production environment as-is.</span></span> <span data-ttu-id="5ad5f-120">相反的自定义的版本`Web.config`需要上载到生产环境。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-120">Instead, a customized version of `Web.config` needs to be uploaded to production.</span></span> <span data-ttu-id="5ad5f-121">本教程简要评审的一些较常见的配置差异;它还概述了一些技术进行维护环境之间的不同的配置信息。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-121">This tutorial briefly reviews some of the more common configuration differences; it also summarizes some techniques for maintaining different configuration information between the environments.</span></span>

## <a name="typical-configuration-differences-between-the-development-and-production-environments"></a><span data-ttu-id="5ad5f-122">典型配置开发和生产环境之间的差异</span><span class="sxs-lookup"><span data-stu-id="5ad5f-122">Typical Configuration Differences Between the Development and Production Environments</span></span>

<span data-ttu-id="5ad5f-123">`Web.config`文件包括多种类型的 ASP.NET 应用程序的配置信息。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-123">The `Web.config` file includes an assortment of configuration information for an ASP.NET application.</span></span> <span data-ttu-id="5ad5f-124">此配置信息的一些无论是相同的环境。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-124">Some of this configuration information is the same regardless of the environment.</span></span> <span data-ttu-id="5ad5f-125">例如，身份验证设置与 URL 授权规则拼中`Web.config`文件的`<authentication>`和`<authorization>`元素通常是相同的而不考虑环境。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-125">For instance, the authentication settings and URL authorization rules spelled out in the `Web.config` file's `<authentication>` and `<authorization>` elements are usually the same regardless of the environment.</span></span> <span data-ttu-id="5ad5f-126">但其他配置信息-如有关外部资源的信息通常取决于环境。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-126">But other configuration information - such as information about external resources - typically differs depending on the environment.</span></span>

<span data-ttu-id="5ad5f-127">数据库连接字符串是基于环境的不同的配置信息的一个极好示例。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-127">Database connections strings are a prime example of configuration information that differs based on the environment.</span></span> <span data-ttu-id="5ad5f-128">当 web 应用程序与数据库服务器通信它必须首先建立连接，并通过做到这一点[连接字符串](http://www.connectionstrings.com/Articles/Show/what-is-a-connection-string)。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-128">When a web application communicates with a database server it must first establish a connection, and that is achieved through a [connection string](http://www.connectionstrings.com/Articles/Show/what-is-a-connection-string).</span></span> <span data-ttu-id="5ad5f-129">尽管可以直接在 web 页或连接到数据库的代码中的数据库连接字符串进行硬编码，最好是将其放`Web.config`的[`<connectionStrings>`元素](https://msdn.microsoft.com/en-us/library/bf7sd233.aspx)以便连接字符串信息是在单一的集中式的位置。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-129">While it is possible to hard-code the database connection string directly in the web pages or the code that connects to the database, it is best to place it `Web.config`'s [`<connectionStrings>` element](https://msdn.microsoft.com/en-us/library/bf7sd233.aspx) so that the connection string information is in a single, centralized location.</span></span> <span data-ttu-id="5ad5f-130">通常不同的数据库使用在开发过程中不是在生产; 中使用因此，连接字符串信息必须是唯一的每个环境。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-130">Oftentimes a different database is used during development than is used in production; consequently, the connection string information must be unique for each environment.</span></span>

> [!NOTE]
> <span data-ttu-id="5ad5f-131">将来的教程浏览部署数据驱动的应用程序，此时我们将深入了解如何在配置文件中存储数据库连接字符串的详细信息。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-131">Future tutorials explore deploying data-driven applications, at which point we'll dive into the specifics of how database connection strings are stored in the configuration file.</span></span>


<span data-ttu-id="5ad5f-132">开发和生产环境的预期的行为不同大体上。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-132">The intended behavior of the development and production environments differs substantially.</span></span> <span data-ttu-id="5ad5f-133">在开发环境中的 web 应用程序正在创建，测试和调试通过小的一组开发人员。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-133">A web application in the development environment is being created, tested, and debugged by a small group of developers.</span></span> <span data-ttu-id="5ad5f-134">在生产环境中多个不同的同时进行用户正在访问同一应用程序。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-134">In the production environment that same application is being visited by many different simultaneous users.</span></span> <span data-ttu-id="5ad5f-135">ASP.NET 包括多种功能，可帮助开发人员在测试和调试应用程序，但应出于性能和安全原因，在生产环境中的禁用了这些功能。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-135">ASP.NET includes a number of features that help developers in testing and debugging an application, but these features should be disabled for performance and security reasons when in the production environment.</span></span> <span data-ttu-id="5ad5f-136">让我们看一下几个此类配置设置。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-136">Let's look at a few such configuration settings.</span></span>

### <a name="configuration-settings-that-impact-performance"></a><span data-ttu-id="5ad5f-137">会对性能影响的配置设置</span><span class="sxs-lookup"><span data-stu-id="5ad5f-137">Configuration Settings That Impact Performance</span></span>

<span data-ttu-id="5ad5f-138">当 ASP.NET 页访问对于第一次 （或后已更改第一次），必须将其声明性标记转换为一个类，并且必须编译此类。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-138">When an ASP.NET page is visited for the first time (or the first time after it has changed), its declarative markup must be converted into a class and this class must be compiled.</span></span> <span data-ttu-id="5ad5f-139">如果 web 应用程序使用自动编译页面的代码隐藏类将需要进行编译，太。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-139">If the web application uses automatic compilation then the page's code-behind class needs to be compiled, too.</span></span> <span data-ttu-id="5ad5f-140">你可以配置多种类型的通过编译选项`Web.config`文件的[`<compilation>`元素](https://msdn.microsoft.com/en-us/library/s10awwz0.aspx)。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-140">You can configure an assortment of compilation options via the `Web.config` file's [`<compilation>` element](https://msdn.microsoft.com/en-us/library/s10awwz0.aspx).</span></span>

<span data-ttu-id="5ad5f-141">调试属性是中最重要的特性之一`<compilation>`元素。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-141">The debug attribute is one of the most important attributes in the `<compilation>` element.</span></span> <span data-ttu-id="5ad5f-142">如果`debug`属性设置为"true"则在编译的程序集将调试符号，调试 Visual Studio 中的应用程序时需要用到它。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-142">If the `debug` attribute is set to "true" then the compiled assemblies include debug symbols, which are needed when debugging an application in Visual Studio.</span></span> <span data-ttu-id="5ad5f-143">但调试符号增加程序集的大小和运行代码时有更多的内存要求。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-143">But debug symbols increase the size of the assembly and impose additional memory requirements when running the code.</span></span> <span data-ttu-id="5ad5f-144">此外，当`debug`属性设置为"true"返回任何内容`WebResource.axd`不缓存，这意味着，每次用户访问页它们将需要重新下载返回的静态内容`WebResource.axd`。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-144">Furthermore, when the `debug` attribute is set to "true" any content returned by `WebResource.axd` is not cached, meaning that each time a user visits a page they will need to re-download the static content returned by `WebResource.axd`.</span></span>

> [!NOTE]
> <span data-ttu-id="5ad5f-145">`WebResource.axd`是一个内置的 HTTP 处理程序引入的 ASP.NET 2.0 中，服务器控件用于检索嵌入的资源，例如脚本文件、 图像、 CSS 文件和其他内容。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-145">`WebResource.axd` is a built-in HTTP Handler introduced in ASP.NET 2.0 that server controls use to retrieve embedded resources, such as script files, images, CSS files, and other content.</span></span> <span data-ttu-id="5ad5f-146">有关详细信息如何`WebResource.axd`工作原理以及如何使用该嵌入的资源访问来自自定义服务器控件，请参阅[访问嵌入资源通过 URL 使用`WebResource.axd` ](http://aspnet.4guysfromrolla.com/articles/080906-1.aspx)。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-146">For more information on how `WebResource.axd` works and how you can use it to access embedded resources from your custom server controls, see [Accessing Embedded Resources Through a URL Using `WebResource.axd`](http://aspnet.4guysfromrolla.com/articles/080906-1.aspx).</span></span>


<span data-ttu-id="5ad5f-147">`<compilation>`元素的`debug`属性通常设置为"true"，在开发环境中。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-147">The `<compilation>` element's `debug` attribute is usually set to "true" in the development environment.</span></span> <span data-ttu-id="5ad5f-148">事实上，此属性必须设置为"true"若要调试 web 应用程序;如果你尝试调试 ASP.NET 应用程序从 Visual Studio 和`debug`属性设置为"false"，Visual Studio 将显示一个消息，其中说明应用程序不能进行调试直到`debug`属性设置为"true"，将为你进行此更改的优惠。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-148">In fact, this attribute must be set to "true" in order to debug a web application; if you try to debug an ASP.NET application from Visual Studio and the `debug` attribute is set to "false", Visual Studio will display a message explaining that the application cannot be debugged until the `debug` attribute is set to "true" and will offer to make this change for you.</span></span>

<span data-ttu-id="5ad5f-149">你应**永远不会**具有`debug`属性设置为"true"，在生产环境中由于其对性能的影响。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-149">You should **never** have the `debug` attribute set to "true" in a production environment because of its impact on performance.</span></span> <span data-ttu-id="5ad5f-150">有关本主题的更全面讨论，请参阅[Scott Guthrie](https://weblogs.asp.net/scottgu/)的博客文章[不运行生产 ASP.NET 应用程序与`debug="true"`已启用](https://weblogs.asp.net/scottgu/442448)。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-150">For a more thorough discussion on this topic, refer to [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog post, [Don't Run Production ASP.NET Applications With `debug="true"` Enabled](https://weblogs.asp.net/scottgu/442448).</span></span>

### <a name="custom-errors-and-tracing"></a><span data-ttu-id="5ad5f-151">自定义错误和跟踪</span><span class="sxs-lookup"><span data-stu-id="5ad5f-151">Custom Errors and Tracing</span></span>

<span data-ttu-id="5ad5f-152">ASP.NET 应用程序中发生未经处理的异常时它将冒泡到运行的位置发生三个操作之一：</span><span class="sxs-lookup"><span data-stu-id="5ad5f-152">When an unhandled exception occurs in an ASP.NET application it bubbles up to the runtime at which point one of three things happens:</span></span>

- <span data-ttu-id="5ad5f-153">将显示一般的运行时错误消息。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-153">A generic runtime error message is displayed.</span></span> <span data-ttu-id="5ad5f-154">此页向用户通知存在的运行时错误，但不提供任何有关错误的详细信息。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-154">This page informs the user that there was a runtime error, but does not provide any details about the error.</span></span>
- <span data-ttu-id="5ad5f-155">将显示一条异常详细信息消息，其中包括只需引发的异常的信息。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-155">An exception details message is displayed, which includes information on the exception that was just thrown.</span></span>
- <span data-ttu-id="5ad5f-156">显示自定义错误页，这是一个 ASP.NET 页，你创建显示所需的任何消息。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-156">A custom error page is displayed, which is an ASP.NET page that you create that displays any message you desire.</span></span>

<span data-ttu-id="5ad5f-157">在遇到未经处理的异常时也会发生什么情况取决于`Web.config`文件的[`<customErrors>`部分](https://msdn.microsoft.com/en-us/library/h0hfz6fc.aspx)。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-157">What happens in the face of an unhandled exception depends on the `Web.config` file's [`<customErrors>` section](https://msdn.microsoft.com/en-us/library/h0hfz6fc.aspx).</span></span>

<span data-ttu-id="5ad5f-158">在开发和测试应用程序时，它有助于查看浏览器中的任何异常的详细信息。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-158">When developing and testing an application it helps to see details of any exception in the browser.</span></span> <span data-ttu-id="5ad5f-159">但是，在生产中的应用程序中显示异常详细信息是潜在的安全风险。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-159">However, showing exception details in an application on production is a potential security risk.</span></span> <span data-ttu-id="5ad5f-160">此外，它会 unflattering，会使你查找不专业的网站。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-160">Moreover, it's unflattering and makes your website look unprofessional.</span></span> <span data-ttu-id="5ad5f-161">理想情况下，发生未经处理的异常时在开发环境中的 web 应用程序将显示异常的详细信息时相同的应用程序在生产环境中将显示自定义错误页。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-161">Ideally, in the event of an unhandled exception a web application in the development environment will show the exception's details while the same application in production will show a custom error page.</span></span>

> [!NOTE]
> <span data-ttu-id="5ad5f-162">默认值`<customErrors>`部分设置显示异常详细信息消息仅在页正在访问通过 localhost，且否则显示泛型的运行时错误页时。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-162">The default `<customErrors>` section setting shows the exception details message only when the page is being visited through localhost, and shows the generic runtime error page otherwise.</span></span> <span data-ttu-id="5ad5f-163">这并不理想，但它确保须知的默认行为不显示非本地访问者的异常详细信息。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-163">This isn't ideal, but it's assuring to know that the default behavior doesn't reveal exception details to non-local visitors.</span></span> <span data-ttu-id="5ad5f-164">将来的教程检查`<customErrors>`部分中更多详细信息，并演示如何通过自定义错误页，显示在生产中发生错误时。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-164">A future tutorial examines the `<customErrors>` section in more detail and shows how to have a custom error page shown when an error occurs in production.</span></span>


<span data-ttu-id="5ad5f-165">跟踪在开发过程中很有用的另一个 ASP.NET 功能。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-165">Another ASP.NET feature that is useful during development is tracing.</span></span> <span data-ttu-id="5ad5f-166">跟踪，如果启用，记录有关每个传入请求的信息，可提供特殊的网页， `Trace.axd`，查看最近的请求详细信息。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-166">Tracing, if enabled, records information about each incoming request and provides a special web page, `Trace.axd`, for viewing recent request details.</span></span> <span data-ttu-id="5ad5f-167">你可以启用和配置跟踪通过[`<trace>`元素](https://msdn.microsoft.com/en-us/library/6915t83k.aspx)中`Web.config`。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-167">You can turn on and configure tracing via the [`<trace>` element](https://msdn.microsoft.com/en-us/library/6915t83k.aspx) in `Web.config`.</span></span>

<span data-ttu-id="5ad5f-168">如果你启用跟踪，请确保它会禁用在生产环境中。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-168">If you enable tracing make sure that it is disabled in production.</span></span> <span data-ttu-id="5ad5f-169">因为跟踪信息包括 cookie、 会话数据和其他潜在的敏感信息，务必禁用在生产环境中的跟踪。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-169">Because the trace information includes cookies, session data, and other potentially sensitive information, it is important to disable tracing in production.</span></span> <span data-ttu-id="5ad5f-170">好消息是，默认情况下，禁用跟踪和`Trace.axd`文件才可通过 localhost 访问。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-170">The good news is that, by default, tracing is disabled and the `Trace.axd` file is only accessible through localhost.</span></span> <span data-ttu-id="5ad5f-171">如果您更改这些默认设置在开发过程中确保，它们关闭回在生产环境中。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-171">If you change these default settings in development make sure that they are turned back off in production.</span></span>

## <a name="techniques-for-maintaining-separate-configuration-information"></a><span data-ttu-id="5ad5f-172">用于维护单独的配置信息的技术</span><span class="sxs-lookup"><span data-stu-id="5ad5f-172">Techniques for Maintaining Separate Configuration Information</span></span>

<span data-ttu-id="5ad5f-173">在开发和生产环境中具有不同的配置设置将增加复杂性部署过程。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-173">Having different configuration settings in the development and production environments complicates the deployment process.</span></span> <span data-ttu-id="5ad5f-174">在前面的两个教程中的部署过程涉及复制所有所需的文件从开发到生产环境，但该方法仅适用的配置信息是否这两个环境中相同。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-174">In the previous two tutorials the deployment process involved copying all of the necessary files from development to production, but that approach only works if the configuration information is the same in both environments.</span></span> <span data-ttu-id="5ad5f-175">有多种部署具有不同的配置信息的应用程序的技术。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-175">There are a variety of techniques for deploying an application with varying configuration information.</span></span> <span data-ttu-id="5ad5f-176">让我们的目录的一些托管的 web 应用程序的这些选项。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-176">Let's catalog some of these options for hosted web applications.</span></span>

### <a name="manually-deploying-the-production-environment-configuration-file"></a><span data-ttu-id="5ad5f-177">手动部署生产环境配置文件</span><span class="sxs-lookup"><span data-stu-id="5ad5f-177">Manually Deploying the Production Environment Configuration File</span></span>

<span data-ttu-id="5ad5f-178">最简单方法是维护两个版本的`Web.config`文件： 一个用于开发环境，一个用于生产环境。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-178">The simplest approach is to maintain two versions of the `Web.config` file: one for the development environment and one for the production environment.</span></span> <span data-ttu-id="5ad5f-179">部署到生产环境的站点需要的所有文件复制到生产服务器在开发环境中*除*为`Web.config`文件。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-179">Deploying a site to production entails copying all of the files to the production server in the development environment *except* for the `Web.config` file.</span></span> <span data-ttu-id="5ad5f-180">相反，生产环境而异`Web.config`文件都复制到生产环境。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-180">Instead, the production environment-specific `Web.config` file would be copied to production.</span></span>

<span data-ttu-id="5ad5f-181">此方法不是非常复杂，但很容易地实现，因为不经常更改配置信息。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-181">This approach is not very sophisticated, but it is easy to implement because configuration information changes infrequently.</span></span> <span data-ttu-id="5ad5f-182">它最适用于应用程序与小型开发团队，托管在单个 web 服务器上，很少更改其配置信息。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-182">It works best for applications with a small development team that are hosted on a single web server and whose configuration information is infrequently changed.</span></span> <span data-ttu-id="5ad5f-183">手动部署使用独立的 FTP 客户端应用程序文件时，它是最 tenable。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-183">It's most tenable when manually deploying the application files using a stand-alone FTP client.</span></span> <span data-ttu-id="5ad5f-184">使用 Visual Studio 的复制网站工具或发布选项时，你将需要首先换出特定于部署的`Web.config`之前部署，与生产特定文件，然后在部署完成后重新交换它们。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-184">When using Visual Studio's Copy Web Site tool or Publish option you'll need to first swap out the deployment-specific `Web.config` file with the production-specific one before deploying, and then swap them back after deployment completes.</span></span>

### <a name="change-the-configuration-during-the-build-or-deployment-process"></a><span data-ttu-id="5ad5f-185">更改在部署过程的生成配置</span><span class="sxs-lookup"><span data-stu-id="5ad5f-185">Change the Configuration During the Build or Deployment Process</span></span>

<span data-ttu-id="5ad5f-186">到目前为止的讨论具有假定即席生成和部署过程。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-186">The discussions thus far have assumed an ad-hoc build and deployment process.</span></span> <span data-ttu-id="5ad5f-187">许多大型软件项目中有更规范化的开放源代码，自行，使用或第三方工具的进程。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-187">Many larger software projects have more formalized processes that make use of open-source, home-grown, or third-party tools.</span></span> <span data-ttu-id="5ad5f-188">对于所有这些项目可以可能自定义生成或部署过程之前它将推送到生产适当地修改的配置信息。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-188">For such projects you can likely customize the build or deployment process to appropriately modify the configuration information before it is pushed to production.</span></span> <span data-ttu-id="5ad5f-189">如果你要构建 web 应用程序使用[MSBuild](http://en.wikipedia.org/wiki/MSBuild)， [NAnt](http://nant.sourceforge.net/)，或某些其他生成工具，可以可能添加生成步骤以修改`Web.config`文件以包括特定于生产的设置。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-189">If you build your web application using [MSBuild](http://en.wikipedia.org/wiki/MSBuild), [NAnt](http://nant.sourceforge.net/), or some other build tool, you can likely add a build step to modify the `Web.config` file to include the production-specific settings.</span></span> <span data-ttu-id="5ad5f-190">或部署工作流无法以编程方式连接到源代码管理服务器并检索相应`Web.config`文件。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-190">Or your deployment workflow could programmatically connect to the source control server and retrieve the appropriate `Web.config` file.</span></span>

<span data-ttu-id="5ad5f-191">获取到生产环境的相应配置信息的实际方法广泛根据你的工具和工作流而有所不同。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-191">The actual approach for getting the appropriate configuration information to production varies widely based on your tools and workflow.</span></span> <span data-ttu-id="5ad5f-192">在这种情况下，我们不将深入探讨此主题会进一步。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-192">As such, we will not delve into this topic further.</span></span> <span data-ttu-id="5ad5f-193">如果你使用如 MSBuild 或 NAnt 的常用的生成工具部署文章和教程可以查找特定于这些工具通过 web 搜索。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-193">If you are using a popular build tool like MSBuild or NAnt you can find deployment articles and tutorials specific to these tools through a web search.</span></span>

### <a name="managing-configuration-differences-via-the-web-deployment-project-add-in"></a><span data-ttu-id="5ad5f-194">通过 Web 部署的管理配置差异外接程序项目</span><span class="sxs-lookup"><span data-stu-id="5ad5f-194">Managing Configuration Differences via the Web Deployment Project Add-In</span></span>

<span data-ttu-id="5ad5f-195">2006 年 Microsoft Web 开发项目外接程序为发布 Visual Studio 2005。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-195">In 2006 Microsoft released the Web Development Project Add-In for Visual Studio 2005.</span></span> <span data-ttu-id="5ad5f-196">外接程序的 Visual Studio 2008 年发布 2008年。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-196">An Add-In for Visual Studio 2008 was released in 2008.</span></span> <span data-ttu-id="5ad5f-197">此外接程序中允许 ASP.NET 开发人员创建一个单独的 Web 部署项目，以及其 web 应用程序项目，生成时，显式编译 web 应用程序并将复制的文件将部署到本地的输出目录。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-197">This Add-In allows for ASP.NET developers to create a separate Web Deployment Project alongside their web application project that, when built, explicitly compiles the web application and copies the files to deploy to a local output directory.</span></span> <span data-ttu-id="5ad5f-198">Web 应用程序项目在幕后使用 MSBuild。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-198">The Web Application Project uses MSBuild behind the scenes.</span></span>

<span data-ttu-id="5ad5f-199">默认情况下，开发环境的`Web.config`文件复制到输出目录中，但你可以设置 Web 部署项目，以自定义</span><span class="sxs-lookup"><span data-stu-id="5ad5f-199">By default, the development environment's `Web.config` file is copied to the output directory, but you can setup the Web Deployment Project to customize the</span></span>

<span data-ttu-id="5ad5f-200">通过以下方式获取复制到此目录的配置信息：</span><span class="sxs-lookup"><span data-stu-id="5ad5f-200">configuration information that gets copied to this directory in the following ways:</span></span>

- <span data-ttu-id="5ad5f-201">通过`Web.config`文件部分更换过程中，在其中指定要替换的部分和一个包含替换文本的 XML 文件。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-201">Via `Web.config` file section replacement, in which you specify the section to replace and an XML file that contains the replacement text.</span></span>
- <span data-ttu-id="5ad5f-202">通过提供外部配置源文件的路径。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-202">By providing a path to an external configuration source file.</span></span> <span data-ttu-id="5ad5f-203">选择此选项，Web 部署项目复制特定`Web.config`到输出目录的文件 (而不是`Web.config`在开发环境中使用的文件)。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-203">With this option selected, the Web Deployment Project copies a particular `Web.config` file to the output directory (rather than the `Web.config` file used in the development environment).</span></span>
- <span data-ttu-id="5ad5f-204">通过将自定义规则添加到使用 Web 部署项目的 MSBuild 文件。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-204">By adding custom rules to the MSBuild file used by the Web Deployment Project.</span></span>

<span data-ttu-id="5ad5f-205">若要部署 web 应用程序生成 Web 部署项目，然后将文件从项目的输出文件夹复制到生产环境。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-205">To deploy the web application build the Web Deployment Project and then copy the files from the project's output folder to the production environment.</span></span>

<span data-ttu-id="5ad5f-206">若要了解有关使用 Web 部署项目的详细信息请查看[Web 部署项目本文](https://msdn.microsoft.com/en-us/magazine/cc163448.aspx)从 2007 年 4 月问题的[MSDN 杂志](https://msdn.microsoft.com/en-us/magazine/default.aspx)，或查阅处的其他阅读材料一节中的链接本教程末尾。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-206">To learn more about using the Web Deployment Project check out [this Web Deployment Projects article](https://msdn.microsoft.com/en-us/magazine/cc163448.aspx) from the April 2007 issue of [MSDN Magazine](https://msdn.microsoft.com/en-us/magazine/default.aspx), or consult the links in the Further Reading section at the end of this tutorial.</span></span>

> [!NOTE]
> <span data-ttu-id="5ad5f-207">不能与 Visual Web Developer 中使用 Web 部署项目，因为 Web 部署项目实现为 Visual Studio 外接程序和 Visual Studio Express 版本 （包括 Visual Web Developer） 不支持外接程序。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-207">You cannot use the Web Deployment Project with Visual Web Developer because the Web Deployment Project is implemented as a Visual Studio Add-In and the Visual Studio Express Editions (including Visual Web Developer) do not support Add-Ins.</span></span>


## <a name="summary"></a><span data-ttu-id="5ad5f-208">摘要</span><span class="sxs-lookup"><span data-stu-id="5ad5f-208">Summary</span></span>

<span data-ttu-id="5ad5f-209">外部资源和 web 应用程序开发中的行为是通常不同于相同的应用程序时在生产环境中。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-209">The external resources and behavior of a web application in development are typically different than when the same application is in production.</span></span> <span data-ttu-id="5ad5f-210">例如，数据库连接字符串、 编译选项，以及通常发生未处理的异常时的行为不同环境之间。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-210">For instance, database connection strings, compilation options, and the behavior when an unhandled exception occurs commonly differ between environments.</span></span> <span data-ttu-id="5ad5f-211">在部署过程必须适应这些区别。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-211">The deployment process must accommodate these differences.</span></span> <span data-ttu-id="5ad5f-212">如我们在本教程中所述，最简单方法是手动将备用的配置文件复制到生产环境。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-212">As we discussed in this tutorial, the simplest approach is to manually copy an alternate configuration file to the production environment.</span></span> <span data-ttu-id="5ad5f-213">更适合的解决方案，还可能使用 Web 部署项目外接程序时，或使用更正式的生成或部署进程可以满足此类自定义项。</span><span class="sxs-lookup"><span data-stu-id="5ad5f-213">More elegant solutions are possible when using the Web Deployment Project Add-In or with a more formalized build or deployment process that can accommodate such customizations.</span></span>

<span data-ttu-id="5ad5f-214">尽情享受编程 ！</span><span class="sxs-lookup"><span data-stu-id="5ad5f-214">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="5ad5f-215">其他阅读材料</span><span class="sxs-lookup"><span data-stu-id="5ad5f-215">Further Reading</span></span>

<span data-ttu-id="5ad5f-216">在本教程中讨论的主题的详细信息，请参阅以下资源：</span><span class="sxs-lookup"><span data-stu-id="5ad5f-216">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="5ad5f-217">所述的连接字符串</span><span class="sxs-lookup"><span data-stu-id="5ad5f-217">Connection Strings Explained</span></span>](http://www.connectionstrings.com/Articles/Show/what-is-a-connection-string)
- [<span data-ttu-id="5ad5f-218">数据库连接字符串 @ ConnectionStrings.com</span><span class="sxs-lookup"><span data-stu-id="5ad5f-218">Database Connection Strings @ ConnectionStrings.com</span></span>](http://www.connectionstrings.com/)
- [<span data-ttu-id="5ad5f-219">不要运行生产 ASP.NET 应用程序与`debug="true"`启用</span><span class="sxs-lookup"><span data-stu-id="5ad5f-219">Don't Run Production ASP.NET Applications with `debug="true"` Enabled</span></span>](https://weblogs.asp.net/scottgu/Don_1920_t-run-production-ASP.NET-Applications-with-debug_3D001D20_true_1D20_-enabled)
- [<span data-ttu-id="5ad5f-220">正常响应未经处理的异常-显示用户友好的错误页</span><span class="sxs-lookup"><span data-stu-id="5ad5f-220">Gracefully Responding to Unhandled Exceptions - Displaying User-Friendly Error Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/090606-1.aspx)
- [<span data-ttu-id="5ad5f-221">我如何： 使用 Visual Studio 2008 Web 部署项目？</span><span class="sxs-lookup"><span data-stu-id="5ad5f-221">How Do I: Use a Visual Studio 2008 Web Deployment Project?</span></span>](../../../videos/how-do-i/how-do-i-use-a-visual-studio-2008-web-deployment-project.md)
- [<span data-ttu-id="5ad5f-222">部署数据库时的密钥配置设置</span><span class="sxs-lookup"><span data-stu-id="5ad5f-222">Key Configuration Settings When Deploying a Database</span></span>](http://aspnet.4guysfromrolla.com/articles/121008-1.aspx)
- <span data-ttu-id="5ad5f-223">[Visual Studio 2008 Web 部署项目下载](https://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&amp;displaylang=en) | [Visual Studio 2005 Web 部署项目下载](https://download.microsoft.com/download/9/4/9/9496adc4-574e-4043-bb70-bc841e27f13c/WebDeploymentSetup.msi)</span><span class="sxs-lookup"><span data-stu-id="5ad5f-223">[Visual Studio 2008 Web Deployment Projects Download](https://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&amp;displaylang=en) | [Visual Studio 2005 Web Deployment Projects Download](https://download.microsoft.com/download/9/4/9/9496adc4-574e-4043-bb70-bc841e27f13c/WebDeploymentSetup.msi)</span></span>
- <span data-ttu-id="5ad5f-224">[VS 2008 Web 部署项目](https://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx) | [VS 2008 Web 部署项目支持发布](https://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)</span><span class="sxs-lookup"><span data-stu-id="5ad5f-224">[VS 2008 Web Deployment Projects](https://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx) | [VS 2008 Web Deployment Project Support Released](https://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)</span></span>
- [<span data-ttu-id="5ad5f-225">Web 部署项目</span><span class="sxs-lookup"><span data-stu-id="5ad5f-225">Web Deployment Projects</span></span>](https://msdn.microsoft.com/en-us/magazine/cc163448.aspx)

>[!div class="step-by-step"]
<span data-ttu-id="5ad5f-226">[上一页](deploying-your-site-using-visual-studio-vb.md)
[下一页](core-differences-between-iis-and-the-asp-net-development-server-vb.md)</span><span class="sxs-lookup"><span data-stu-id="5ad5f-226">[Previous](deploying-your-site-using-visual-studio-vb.md)
[Next](core-differences-between-iis-and-the-asp-net-development-server-vb.md)</span></span>
