---
uid: identity/overview/getting-started/introduction-to-aspnet-identity
title: "ASP.NET 标识简介 |Microsoft 文档"
author: jongalloway
description: "ASP.NET 成员资格系统中引入了 ASP.NET 2.0 后在 2005 中，并且由于然后进行了很多更改方式的 web 应用程序 typicall..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/17/2013
ms.topic: article
ms.assetid: 38717fc1-5989-43cf-952d-4007cc1dd923
ms.technology: 
ms.prod: .net-framework
msc.legacyurl: /identity/overview/getting-started/introduction-to-aspnet-identity
msc.type: authoredcontent
ms.openlocfilehash: a66e2a80668dbf291b9cc34f205b546b72d92bcc
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/10/2017
---
<a name="introduction-to-aspnet-identity"></a><span data-ttu-id="fb801-103">ASP.NET 标识简介</span><span class="sxs-lookup"><span data-stu-id="fb801-103">Introduction to ASP.NET Identity</span></span>
====================
<span data-ttu-id="fb801-104">通过[Jon Galloway](https://github.com/jongalloway)， [Pranav Rastogi](https://github.com/rustd)， [Rick Anderson](https://github.com/Rick-Anderson)， [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="fb801-104">by [Jon Galloway](https://github.com/jongalloway), [Pranav Rastogi](https://github.com/rustd), [Rick Anderson](https://github.com/Rick-Anderson), [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="fb801-105">ASP.NET 成员资格系统中引入了 ASP.NET 2.0 后在 2005 中，并且由于然后进行了很多更改 web 应用程序通常处理身份验证和授权的方式。</span><span class="sxs-lookup"><span data-stu-id="fb801-105">The ASP.NET membership system was introduced with ASP.NET 2.0 back in 2005, and since then there have been many changes in the ways web applications typically handle authentication and authorization.</span></span> <span data-ttu-id="fb801-106">ASP.NET 标识是全新查看成员资格系统在生成适用于 web、 电话或平板电脑的现代应用程序应该是什么。</span><span class="sxs-lookup"><span data-stu-id="fb801-106">ASP.NET Identity is a fresh look at what the membership system should be when you are building modern applications for the web, phone, or tablet.</span></span>
> 
> <span data-ttu-id="fb801-107">本文编写的 Pranav Rastogi ([@rustd](https://twitter.com/rustd))，Jon Galloway ([@jongalloway](https://twitter.com/jongalloway))，Tom Dykstra 和 Rick Anderson ([ @RickAndMSFT ](https://twitter.com/#!/RickAndMSFT) )。</span><span class="sxs-lookup"><span data-stu-id="fb801-107">This article was written by Pranav Rastogi ([@rustd](https://twitter.com/rustd)), Jon Galloway ([@jongalloway](https://twitter.com/jongalloway)), Tom Dykstra, and Rick Anderson ([@RickAndMSFT](https://twitter.com/#!/RickAndMSFT) ).</span></span>


## <a name="background-membership-in-aspnet"></a><span data-ttu-id="fb801-108">背景信息： 在 ASP.NET 中的成员身份</span><span class="sxs-lookup"><span data-stu-id="fb801-108">Background: Membership in ASP.NET</span></span>

### <a name="aspnet-membership"></a><span data-ttu-id="fb801-109">ASP.NET 成员资格</span><span class="sxs-lookup"><span data-stu-id="fb801-109">ASP.NET Membership</span></span>

<span data-ttu-id="fb801-110">[ASP.NET 成员资格](https://msdn.microsoft.com/en-us/library/yh26yfzy(v=VS.100).aspx)旨在解决常见 2005，均涉及到窗体身份验证和用户名、 密码和配置文件数据的 SQL Server 数据库中的站点成员身份要求。</span><span class="sxs-lookup"><span data-stu-id="fb801-110">[ASP.NET Membership](https://msdn.microsoft.com/en-us/library/yh26yfzy(v=VS.100).aspx) was designed to solve site membership requirements that were common in 2005, which involved Forms Authentication, and a SQL Server database for user names, passwords, and profile data.</span></span> <span data-ttu-id="fb801-111">目前没有 web 应用程序的数据存储选项的多更广泛数组，大多数开发人员想要使其站点能够使用社交标识提供者进行身份验证和授权功能。</span><span class="sxs-lookup"><span data-stu-id="fb801-111">Today there is a much broader array of data storage options for web applications, and most developers want to enable their sites to use social identity providers for authentication and authorization functionality.</span></span> <span data-ttu-id="fb801-112">ASP.NET 成员资格的设计限制难以此转换：</span><span class="sxs-lookup"><span data-stu-id="fb801-112">The limitations of ASP.NET Membership's design make this transition difficult:</span></span>

- <span data-ttu-id="fb801-113">数据库架构旨在用于 SQL Server，您无法更改它。</span><span class="sxs-lookup"><span data-stu-id="fb801-113">The database schema was designed for SQL Server and you can't change it.</span></span> <span data-ttu-id="fb801-114">您可以添加配置文件信息，但其他数据打包到另一个表，这会使难访问通过配置文件提供程序 API 通过任何方式除外。</span><span class="sxs-lookup"><span data-stu-id="fb801-114">You can add profile information, but the additional data is packed into a different table, which makes it difficult to access by any means except through the Profile Provider API.</span></span>
- <span data-ttu-id="fb801-115">提供程序系统使你能够更改后备数据存储，但系统围绕假设适用于关系数据库设计的。</span><span class="sxs-lookup"><span data-stu-id="fb801-115">The provider system enables you to change the backing data store, but the system is designed around assumptions appropriate for a relational database.</span></span> <span data-ttu-id="fb801-116">你可以编写一个提供程序来存储非关系存储机制，如 Azure 存储表中的成员身份信息但则必须通过编写大量的代码和大量要解决的关系设计`System.NotImplementedException`不的方法的异常适用于 NoSQL 数据库。</span><span class="sxs-lookup"><span data-stu-id="fb801-116">You can write a provider to store membership information in a non-relational storage mechanism, such as Azure Storage Tables, but then you have to work around the relational design by writing a lot of code and a lot of `System.NotImplementedException` exceptions for methods that don't apply to NoSQL databases.</span></span>
- <span data-ttu-id="fb801-117">由于日志/日志 out 功能基于窗体身份验证，不能使用成员资格系统[OWIN](../../../aspnet/overview/owin-and-katana/an-overview-of-project-katana.md)。</span><span class="sxs-lookup"><span data-stu-id="fb801-117">Since the log-in/log-out functionality is based on Forms Authentication, the membership system can't use [OWIN](../../../aspnet/overview/owin-and-katana/an-overview-of-project-katana.md).</span></span> <span data-ttu-id="fb801-118">OWIN 包括身份验证，包括登录名使用外部标识提供程序 （如 Microsoft 帐户、 Facebook、 Google、 Twitter)，支持的中间件组件和登录名使用组织帐户从本地 Active Directory 或Azure Active Directory。</span><span class="sxs-lookup"><span data-stu-id="fb801-118">OWIN includes middleware components for authentication, including support for log-ins using external identity providers (like Microsoft Accounts, Facebook, Google, Twitter), and log-ins using organizational accounts from on-premises Active Directory or Azure Active Directory.</span></span> <span data-ttu-id="fb801-119">OWIN 还包括支持 OAuth 2.0、 JWT 和 CORS。</span><span class="sxs-lookup"><span data-stu-id="fb801-119">OWIN also includes support for OAuth 2.0, JWT and CORS.</span></span>

### <a name="aspnet-simple-membership"></a><span data-ttu-id="fb801-120">ASP.NET 简单成员身份</span><span class="sxs-lookup"><span data-stu-id="fb801-120">ASP.NET Simple Membership</span></span>

<span data-ttu-id="fb801-121">[ASP.NET 简单成员资格](../../../web-pages/overview/security/16-adding-security-and-membership.md)开发，作为成员资格系统的 ASP.NET Web 页。</span><span class="sxs-lookup"><span data-stu-id="fb801-121">[ASP.NET simple membership](../../../web-pages/overview/security/16-adding-security-and-membership.md) was developed as a membership system for ASP.NET Web Pages.</span></span> <span data-ttu-id="fb801-122">它将已释放使用 WebMatrix 和 Visual Studio 2010 SP1。</span><span class="sxs-lookup"><span data-stu-id="fb801-122">It was released with WebMatrix and Visual Studio 2010 SP1.</span></span> <span data-ttu-id="fb801-123">简单的成员身份的目的是方便地将成员资格功能添加到网页应用程序。</span><span class="sxs-lookup"><span data-stu-id="fb801-123">The goal of Simple Membership was to make it easy to add membership functionality to a Web Pages application.</span></span>

<span data-ttu-id="fb801-124">简单的成员身份未更加轻松地自定义用户配置文件信息，而它仍共享 ASP.NET 成员资格的其他问题，它的一些限制：</span><span class="sxs-lookup"><span data-stu-id="fb801-124">Simple Membership did make it easier to customize user profile information, but it still shares the other problems with ASP.NET Membership, and it has some limitations:</span></span>

- <span data-ttu-id="fb801-125">很难将非关系存储区中的成员身份系统数据持久保存。</span><span class="sxs-lookup"><span data-stu-id="fb801-125">It was hard to persist membership system data in a non-relational store.</span></span>
- <span data-ttu-id="fb801-126">不能使用 OWIN 使用它。</span><span class="sxs-lookup"><span data-stu-id="fb801-126">You can't use it with OWIN.</span></span>
- <span data-ttu-id="fb801-127">它无法很好地使用现有的 ASP.NET 成员资格提供程序，并且不可扩展。</span><span class="sxs-lookup"><span data-stu-id="fb801-127">It doesn't work well with existing ASP.NET Membership providers, and it's not extensible.</span></span>

### <a name="aspnet-universal-providers"></a><span data-ttu-id="fb801-128">ASP.NET Universal Providers</span><span class="sxs-lookup"><span data-stu-id="fb801-128">ASP.NET Universal Providers</span></span>

<span data-ttu-id="fb801-129">[ASP.NET Universal Providers](http://www.hanselman.com/blog/IntroducingSystemWebProvidersASPNETUniversalProvidersForSessionMembershipRolesAndUserProfileOnSQLCompactAndSQLAzure.aspx)开发以使其能够进行保持 Azure SQL 数据库，但它们也起作用与 SQL Server Compact 在 Microsoft 中的成员身份信息。</span><span class="sxs-lookup"><span data-stu-id="fb801-129">[ASP.NET Universal Providers](http://www.hanselman.com/blog/IntroducingSystemWebProvidersASPNETUniversalProvidersForSessionMembershipRolesAndUserProfileOnSQLCompactAndSQLAzure.aspx) were developed to make it possible to persist membership information in Microsoft Azure SQL Database, and they also work with SQL Server Compact.</span></span> <span data-ttu-id="fb801-130">基于 Entity Framework Code First，这意味着通用提供程序可用于将数据保持受 EF 任何存储在生成了通用的提供程序。</span><span class="sxs-lookup"><span data-stu-id="fb801-130">The Universal Providers were built on Entity Framework Code First, which means that the Universal Providers can be used to persist data in any store supported by EF.</span></span> <span data-ttu-id="fb801-131">使用通用提供程序，数据库架构已清理也相当多的很多。</span><span class="sxs-lookup"><span data-stu-id="fb801-131">With the Universal Providers, the database schema was cleaned up quite a lot as well.</span></span>

<span data-ttu-id="fb801-132">通用提供程序基于 ASP.NET 成员资格的基础结构，以便它们仍执行相同的限制为 SqlMembership 提供程序。</span><span class="sxs-lookup"><span data-stu-id="fb801-132">The Universal Providers are built on the ASP.NET Membership infrastructure, so they still carry the same limitations as the SqlMembership Provider.</span></span> <span data-ttu-id="fb801-133">也就是说，它们为关系数据库设计和很难自定义配置文件和用户信息。</span><span class="sxs-lookup"><span data-stu-id="fb801-133">That is, they were designed for relational databases and it's hard to customize profile and user information.</span></span> <span data-ttu-id="fb801-134">这些提供程序还使用窗体身份验证登录和注销功能。</span><span class="sxs-lookup"><span data-stu-id="fb801-134">These providers also still use Forms Authentication for log-in and log-out functionality.</span></span>

## <a name="aspnet-identity"></a><span data-ttu-id="fb801-135">ASP.NET 标识</span><span class="sxs-lookup"><span data-stu-id="fb801-135">ASP.NET Identity</span></span>

<span data-ttu-id="fb801-136">与成员资格中 ASP.NET 的情景已得到发展多年来，ASP.NET 团队已大量得出客户的反馈。</span><span class="sxs-lookup"><span data-stu-id="fb801-136">As the membership story in ASP.NET has evolved over the years, the ASP.NET team has learned a lot from feedback from customers.</span></span>

<span data-ttu-id="fb801-137">用户将登录通过输入用户名和密码在自己的应用程序中注册它们的假设将不再有效。</span><span class="sxs-lookup"><span data-stu-id="fb801-137">The assumption that users will log in by entering a user name and password that they have registered in your own application is no longer valid.</span></span> <span data-ttu-id="fb801-138">Web 已变得更社交。</span><span class="sxs-lookup"><span data-stu-id="fb801-138">The web has become more social.</span></span> <span data-ttu-id="fb801-139">用户通过社交通道，如 Facebook、 Twitter 和其他社交网站实时相互交互。</span><span class="sxs-lookup"><span data-stu-id="fb801-139">Users are interacting with each other in real time through social channels such as Facebook, Twitter, and other social web sites.</span></span> <span data-ttu-id="fb801-140">开发人员希望用户能够登录其社交标识，以便它们可以在自己网站上具有丰富的体验。</span><span class="sxs-lookup"><span data-stu-id="fb801-140">Developers want users to be able to log in with their social identities so that they can have a rich experience on their web sites.</span></span> <span data-ttu-id="fb801-141">现代的成员身份系统必须启用到身份验证提供程序，如 Facebook、 Twitter 和其他基于重定向的日志项。</span><span class="sxs-lookup"><span data-stu-id="fb801-141">A modern membership system must enable redirection-based log-ins to authentication providers such as Facebook, Twitter, and others.</span></span>

<span data-ttu-id="fb801-142">随着 web 开发发展，因此未 web 开发的模式。</span><span class="sxs-lookup"><span data-stu-id="fb801-142">As web development evolved, so did the patterns of web development.</span></span> <span data-ttu-id="fb801-143">单元测试的应用程序代码成为应用程序开发人员的问题。</span><span class="sxs-lookup"><span data-stu-id="fb801-143">Unit testing of application code became a core concern for application developers.</span></span> <span data-ttu-id="fb801-144">在 2008 年 ASP.NET 添加一个新的框架，基于模型-视图-控制器 (MVC) 模式，部分来帮助开发人员构建可测试 ASP.NET 应用程序的单元。</span><span class="sxs-lookup"><span data-stu-id="fb801-144">In 2008 ASP.NET added a new framework based on the Model-View-Controller (MVC) pattern, in part to help developers build unit testable ASP.NET applications.</span></span> <span data-ttu-id="fb801-145">开发人员希望对单元测试还希望能够执行该操作与成员资格系统对其应用程序逻辑。</span><span class="sxs-lookup"><span data-stu-id="fb801-145">Developers who wanted to unit test their application logic also wanted to be able to do that with the membership system.</span></span>

<span data-ttu-id="fb801-146">考虑这些更改 web 应用程序开发中，ASP.NET 标识被开发与以下目标：</span><span class="sxs-lookup"><span data-stu-id="fb801-146">Considering these changes in web application development, ASP.NET Identity was developed with the following goals:</span></span>

- <span data-ttu-id="fb801-147">**一个 ASP.NET 标识系统**</span><span class="sxs-lookup"><span data-stu-id="fb801-147">**One ASP.NET Identity system**</span></span>

    - <span data-ttu-id="fb801-148">ASP.NET 标识可以用于所有的 ASP.NET 框架，例如 ASP.NET MVC、 Web 窗体、 网页、 Web API 和 SignalR。</span><span class="sxs-lookup"><span data-stu-id="fb801-148">ASP.NET Identity can be used with all of the ASP.NET frameworks, such as ASP.NET MVC, Web Forms, Web Pages, Web API, and SignalR.</span></span>
    - <span data-ttu-id="fb801-149">在生成 web、 电话、 存储或混合应用程序，可以使用 ASP.NET 标识。</span><span class="sxs-lookup"><span data-stu-id="fb801-149">ASP.NET Identity can be used when you are building web, phone, store, or hybrid applications.</span></span>
- <span data-ttu-id="fb801-150">**有关用户的配置文件数据中插入的易用性**</span><span class="sxs-lookup"><span data-stu-id="fb801-150">**Ease of plugging in profile data about the user**</span></span>

    - <span data-ttu-id="fb801-151">你可以控制用户及其配置文件信息的架构。</span><span class="sxs-lookup"><span data-stu-id="fb801-151">You have control over the schema of user and profile information.</span></span> <span data-ttu-id="fb801-152">例如，你可以轻松地实现系统来存储在它们在你的应用程序中注册一个帐户时输入用户的出生日期。</span><span class="sxs-lookup"><span data-stu-id="fb801-152">For example, you can easily enable the system to store birth dates entered by users when they register an account in your application.</span></span>

- <span data-ttu-id="fb801-153">**持久性控件**</span><span class="sxs-lookup"><span data-stu-id="fb801-153">**Persistence control**</span></span>

    - <span data-ttu-id="fb801-154">默认情况下，ASP.NET 标识系统数据库中存储的所有用户信息。</span><span class="sxs-lookup"><span data-stu-id="fb801-154">By default, the ASP.NET Identity system stores all the user information in a database.</span></span> <span data-ttu-id="fb801-155">ASP.NET 标识使用 Entity Framework Code First 来实现所有其持久性机制。</span><span class="sxs-lookup"><span data-stu-id="fb801-155">ASP.NET Identity uses Entity Framework Code First to implement all of its persistence mechanism.</span></span>
    - <span data-ttu-id="fb801-156">由于您控制数据库架构、 常见任务，如更改表名称或更改主键的数据类型很简单。</span><span class="sxs-lookup"><span data-stu-id="fb801-156">Since you control the database schema, common tasks such as changing table names or changing the data type of primary keys is simple to do.</span></span>
    - <span data-ttu-id="fb801-157">很容易地插入不同的存储机制，例如 SharePoint、 Azure 存储表服务、 NoSQL 数据库等，而不必引发`System.NotImplementedExceptions`异常。</span><span class="sxs-lookup"><span data-stu-id="fb801-157">It's easy to plug in different storage mechanisms such as SharePoint, Azure Storage Table Service, NoSQL databases, etc., without having to throw `System.NotImplementedExceptions` exceptions.</span></span>
- <span data-ttu-id="fb801-158">**单元可测试性**</span><span class="sxs-lookup"><span data-stu-id="fb801-158">**Unit testability**</span></span>

    - <span data-ttu-id="fb801-159">ASP.NET 标识让 web 应用程序多个单元可测试。</span><span class="sxs-lookup"><span data-stu-id="fb801-159">ASP.NET Identity makes the web application more unit testable.</span></span> <span data-ttu-id="fb801-160">你可以编写使用 ASP.NET 标识应用程序的部分的单元测试。</span><span class="sxs-lookup"><span data-stu-id="fb801-160">You can write unit tests for the parts of your application that use ASP.NET Identity.</span></span>
- <span data-ttu-id="fb801-161">**角色提供程序**</span><span class="sxs-lookup"><span data-stu-id="fb801-161">**Role provider**</span></span>

    - <span data-ttu-id="fb801-162">没有角色提供程序，这样就可以限制到你的应用程序的部分的角色的访问权限。</span><span class="sxs-lookup"><span data-stu-id="fb801-162">There is a role provider which lets you restrict access to parts of your application by roles.</span></span> <span data-ttu-id="fb801-163">你可以轻松创建角色，例如"Admin"和用户添加到角色。</span><span class="sxs-lookup"><span data-stu-id="fb801-163">You can easily create roles such as "Admin" and add users to roles.</span></span>
- <span data-ttu-id="fb801-164">**基于声明**</span><span class="sxs-lookup"><span data-stu-id="fb801-164">**Claims Based**</span></span>

    - <span data-ttu-id="fb801-165">ASP.NET 标识支持基于声明的身份验证，其中用户的标识表示为一组声明。</span><span class="sxs-lookup"><span data-stu-id="fb801-165">ASP.NET Identity supports claims-based authentication, where the user's identity is represented as a set of claims.</span></span> <span data-ttu-id="fb801-166">声明允许开发人员描述用户的标识，不是角色允许很多更有意义。</span><span class="sxs-lookup"><span data-stu-id="fb801-166">Claims allow developers to be a lot more expressive in describing a user's identity than roles allow.</span></span> <span data-ttu-id="fb801-167">角色成员身份是只是一个布尔值 （成员或非成员），而声明可以包括有关用户的标识和成员身份的丰富信息。</span><span class="sxs-lookup"><span data-stu-id="fb801-167">Whereas role membership is just a boolean (member or non-member), a claim can include rich information about the user's identity and membership.</span></span>
- <span data-ttu-id="fb801-168">**社交登录提供程序**</span><span class="sxs-lookup"><span data-stu-id="fb801-168">**Social Login Providers**</span></span>

    - <span data-ttu-id="fb801-169">你可以轻松添加到你的应用程序，如 Microsoft 帐户、 Facebook、 Twitter、 Google、 及其他的社交日志接和存储你的应用程序中的特定于用户的数据。</span><span class="sxs-lookup"><span data-stu-id="fb801-169">You can easily add social log-ins such as Microsoft Account, Facebook, Twitter, Google, and others to your application, and store the user-specific data in your application.</span></span>
- <span data-ttu-id="fb801-170">**Azure Active Directory**</span><span class="sxs-lookup"><span data-stu-id="fb801-170">**Azure Active Directory**</span></span>

    - <span data-ttu-id="fb801-171">你可以添加日志功能使用 Azure Active Directory 和特定于用户的数据存储在你的应用程序。</span><span class="sxs-lookup"><span data-stu-id="fb801-171">You can also add log-in functionality using Azure Active Directory, and store the user-specific data in your application.</span></span> <span data-ttu-id="fb801-172">有关详细信息，请参阅[组织帐户](../../../visual-studio/overview/2013/creating-web-projects-in-visual-studio.md#orgauth)在 Visual Studio 2013 中创建 ASP.NET Web 项目中</span><span class="sxs-lookup"><span data-stu-id="fb801-172">For more information, see [Organizational Accounts](../../../visual-studio/overview/2013/creating-web-projects-in-visual-studio.md#orgauth) in Creating ASP.NET Web Projects in Visual Studio 2013</span></span>
- <span data-ttu-id="fb801-173">**OWIN 集成**</span><span class="sxs-lookup"><span data-stu-id="fb801-173">**OWIN Integration**</span></span>

    - <span data-ttu-id="fb801-174">ASP.NET 身份验证现在基于可在任何基于 OWIN 的主机的 OWIN 中间件。</span><span class="sxs-lookup"><span data-stu-id="fb801-174">ASP.NET authentication is now based on OWIN middleware that can be used on any OWIN-based host.</span></span> <span data-ttu-id="fb801-175">ASP.NET 标识 System.Web 没有任何依赖项。</span><span class="sxs-lookup"><span data-stu-id="fb801-175">ASP.NET Identity does not have any dependency on System.Web.</span></span> <span data-ttu-id="fb801-176">它是一个完全符合 OWIN 框架，并且可以用在任何托管的 OWIN 应用程序。</span><span class="sxs-lookup"><span data-stu-id="fb801-176">It is a fully compliant OWIN framework and can be used in any OWIN hosted application.</span></span>
    - <span data-ttu-id="fb801-177">ASP.NET 标识为在/日志-注销的 web 站点中的用户使用 OWIN 身份验证。</span><span class="sxs-lookup"><span data-stu-id="fb801-177">ASP.NET Identity uses OWIN Authentication for log-in/log-out of users in the web site.</span></span> <span data-ttu-id="fb801-178">这意味着，而不是使用 FormsAuthentication 生成 cookie，应用程序使用 OWIN CookieAuthentication 执行该操作。</span><span class="sxs-lookup"><span data-stu-id="fb801-178">This means that instead of using FormsAuthentication to generate the cookie, the application uses OWIN CookieAuthentication to do that.</span></span>
- <span data-ttu-id="fb801-179">**NuGet 包**</span><span class="sxs-lookup"><span data-stu-id="fb801-179">**NuGet package**</span></span>

    - <span data-ttu-id="fb801-180">ASP.NET 标识会为它们安装在随附在 Visual Studio 2013 的 ASP.NET MVC、 Web 窗体和 Web API 模板的 NuGet 包重新分发。</span><span class="sxs-lookup"><span data-stu-id="fb801-180">ASP.NET Identity is redistributed as a NuGet package which is installed in the ASP.NET MVC, Web Forms and Web API templates that ship with Visual Studio 2013.</span></span> <span data-ttu-id="fb801-181">你可以从 NuGet 库下载此 NuGet 程序包。</span><span class="sxs-lookup"><span data-stu-id="fb801-181">You can download this NuGet package from the NuGet gallery.</span></span>
    - <span data-ttu-id="fb801-182">释放与 NuGet 的 ASP.NET 标识包使容易 ASP.NET 团队来循环访问新功能和 bug 修复和交付到开发人员敏捷的方式。</span><span class="sxs-lookup"><span data-stu-id="fb801-182">Releasing ASP.NET Identity as a NuGet package makes it easier for the ASP.NET team to iterate on new features and bug fixes, and deliver these to developers in an agile manner.</span></span>

## <a name="getting-started-with-aspnet-identity"></a><span data-ttu-id="fb801-183">开始使用 ASP.NET 标识</span><span class="sxs-lookup"><span data-stu-id="fb801-183">Getting started with ASP.NET Identity</span></span>

<span data-ttu-id="fb801-184">Visual Studio 2013 项目模板中使用 ASP.NET 标识为 ASP.NET MVC、 Web 窗体、 Web API 和 SPA。</span><span class="sxs-lookup"><span data-stu-id="fb801-184">ASP.NET Identity is used in the Visual Studio 2013 project templates for ASP.NET MVC, Web Forms, Web API and SPA.</span></span> <span data-ttu-id="fb801-185">在此演练中，我们将说明项目模板如何使用 ASP.NET 标识来添加功能，用于注册、 登录和注销用户。</span><span class="sxs-lookup"><span data-stu-id="fb801-185">In this walkthrough, we'll illustrate how the project templates use ASP.NET Identity to add functionality to register, log in and log out a user.</span></span>

<span data-ttu-id="fb801-186">使用以下过程来实现 ASP.NET 标识。</span><span class="sxs-lookup"><span data-stu-id="fb801-186">ASP.NET Identity is implemented using the following procedure.</span></span> <span data-ttu-id="fb801-187">本文的目的是让你的 ASP.NET 标识; 高级别概述你可以按照分步来或只需读取的详细信息。</span><span class="sxs-lookup"><span data-stu-id="fb801-187">The purpose of this article is to give you a high level overview of ASP.NET Identity; you can follow it step by step or just read the details.</span></span> <span data-ttu-id="fb801-188">有关更多详细说明创建应用程序使用 ASP.NET 标识，包括使用新 API 添加用户、 角色和配置文件信息，请参阅本文末尾的后续步骤部分。</span><span class="sxs-lookup"><span data-stu-id="fb801-188">For more detailed instructions on creating apps using ASP.NET Identity, including using the new API to add users, roles and profile information, see the Next Steps section at the end of this article.</span></span>

1. <span data-ttu-id="fb801-189">使用个人帐户中创建 ASP.NET MVC 应用程序。</span><span class="sxs-lookup"><span data-stu-id="fb801-189">Create an ASP.NET MVC application with Individual Accounts.</span></span> <span data-ttu-id="fb801-190">你可以使用 ASP.NET MVC、 Web 窗体、 Web API、 SignalR 等中的 ASP.NET 标识。这篇文章中我们将启动与 ASP.NET MVC 应用程序。</span><span class="sxs-lookup"><span data-stu-id="fb801-190">You can use ASP.NET Identity in ASP.NET MVC, Web Forms, Web API, SignalR etc. In this article we will start with an ASP.NET MVC application.</span></span>  
  
    ![](introduction-to-aspnet-identity/_static/image1.png)
2. <span data-ttu-id="fb801-191">创建的项目包含 ASP.NET 标识以下三个包。</span><span class="sxs-lookup"><span data-stu-id="fb801-191">The created project contains the following three packages for ASP.NET Identity.</span></span>

    - [`Microsoft.AspNet.Identity.EntityFramework`](http://www.nuget.org/packages/Microsoft.AspNet.Identity.EntityFramework/)  
 <span data-ttu-id="fb801-192">此包已将保持 ASP.NET 标识数据和架构与 SQL Server ASP.NET 标识的实体框架实现。</span><span class="sxs-lookup"><span data-stu-id="fb801-192">This package has the Entity Framework implementation of ASP.NET Identity which will persist the ASP.NET Identity data and schema to SQL Server.</span></span>
    - [`Microsoft.AspNet.Identity.Core`](http://www.nuget.org/packages/Microsoft.AspNet.Identity.Core/)  
 <span data-ttu-id="fb801-193">此包为 ASP.NET 标识有核心接口。</span><span class="sxs-lookup"><span data-stu-id="fb801-193">This package has the core interfaces for ASP.NET Identity.</span></span> <span data-ttu-id="fb801-194">此包可用于编写实现 ASP.NET 标识，目标不同的持久性存储 （如 Azure 表存储） NoSQL 数据库等。</span><span class="sxs-lookup"><span data-stu-id="fb801-194">This package can be used to write an implementation for ASP.NET Identity that targets different persistence stores such as Azure Table Storage, NoSQL databases etc.</span></span>
    - [`Microsoft.AspNet.Identity.OWIN`](http://www.nuget.org/packages/Microsoft.AspNet.Identity.Owin/)  
 <span data-ttu-id="fb801-195">此程序包包含用于在 ASP.NET 应用程序中加入与 ASP.NET Identity OWIN 身份验证的功能。</span><span class="sxs-lookup"><span data-stu-id="fb801-195">This package contains functionality that is used to plug in OWIN authentication with ASP.NET Identity in ASP.NET applications.</span></span> <span data-ttu-id="fb801-196">这用于日志的功能添加到你的应用程序和 OWIN Cookie 身份验证中间件调用生成 cookie 时。</span><span class="sxs-lookup"><span data-stu-id="fb801-196">This is used when you add log in functionality to your application and call into OWIN Cookie Authentication middleware to generate a cookie.</span></span>
3. <span data-ttu-id="fb801-197">创建用户。</span><span class="sxs-lookup"><span data-stu-id="fb801-197">Creating a user.</span></span>  
 <span data-ttu-id="fb801-198">启动应用程序，然后单击**注册**链接来创建的用户。</span><span class="sxs-lookup"><span data-stu-id="fb801-198">Launch the application and then click on the **Register** link to create a user.</span></span> <span data-ttu-id="fb801-199">下图显示了注册页它收集用户名和密码。</span><span class="sxs-lookup"><span data-stu-id="fb801-199">The following image shows the Register page which collects the user name and password.</span></span>  
  
    ![](introduction-to-aspnet-identity/_static/image2.png)  
  
 <span data-ttu-id="fb801-200">当用户单击**注册**按钮，`Register`在 Account 控制器的操作通过调用 ASP.NET 标识 API 中，为以下突出显示部分创建用户：</span><span class="sxs-lookup"><span data-stu-id="fb801-200">When the user clicks the **Register** button, the `Register` action of the Account controller creates the user by calling the ASP.NET Identity API, as highlighted below:</span></span>

    [!code-csharp[Main](introduction-to-aspnet-identity/samples/sample1.cs?highlight=8-9)]
4. <span data-ttu-id="fb801-201">登录。</span><span class="sxs-lookup"><span data-stu-id="fb801-201">Log in.</span></span>  
 <span data-ttu-id="fb801-202">如果已成功创建用户，她将通过记录中`SignInAsync`方法。</span><span class="sxs-lookup"><span data-stu-id="fb801-202">If the user was successfully created, she is logged in by the `SignInAsync` method.</span></span>  

    [!code-csharp[Main](introduction-to-aspnet-identity/samples/sample2.cs?highlight=12)]

    [!code-csharp[Main](introduction-to-aspnet-identity/samples/sample3.cs?highlight=5-6)]

 <span data-ttu-id="fb801-203">在上面的突出显示的代码`SignInAsync`方法生成[ClaimsIdentity](https://msdn.microsoft.com/en-us/library/system.security.claims.claimsidentity.aspx)。</span><span class="sxs-lookup"><span data-stu-id="fb801-203">The highlighted code above in the `SignInAsync` method generates a [ClaimsIdentity](https://msdn.microsoft.com/en-us/library/system.security.claims.claimsidentity.aspx).</span></span> <span data-ttu-id="fb801-204">ASP.NET 标识和 OWIN Cookie 身份验证是基于声明的系统事件，因为框架需要生成用户 ClaimsIdentity 应用程序。</span><span class="sxs-lookup"><span data-stu-id="fb801-204">Since ASP.NET Identity and OWIN Cookie Authentication are claims-based system, the framework requires the app to generate a ClaimsIdentity for the user.</span></span> <span data-ttu-id="fb801-205">ClaimsIdentity 具有的用户，如用户所属的角色的所有声明的信息。</span><span class="sxs-lookup"><span data-stu-id="fb801-205">ClaimsIdentity has information about all the claims for the user, such as what roles the user belongs to.</span></span> <span data-ttu-id="fb801-206">在此阶段，你还可以添加用户的多个的声明。</span><span class="sxs-lookup"><span data-stu-id="fb801-206">You can also add more claims for the user at this stage.</span></span>  
  
 <span data-ttu-id="fb801-207">以下代码中的突出显示`SignInAsync`方法在用户使用签名从 OWIN 和调用 AuthenticationManager`SignIn`和在 ClaimsIdentity 中传递。</span><span class="sxs-lookup"><span data-stu-id="fb801-207">The highlighted code below in the `SignInAsync` method signs in the user by using the AuthenticationManager from OWIN and calling `SignIn` and passing in the ClaimsIdentity.</span></span>  

    [!code-csharp[Main](introduction-to-aspnet-identity/samples/sample4.cs?highlight=8-11)]
5. <span data-ttu-id="fb801-208">注销。</span><span class="sxs-lookup"><span data-stu-id="fb801-208">Log off.</span></span>  
 <span data-ttu-id="fb801-209">单击**注销**链接帐户控制器中调用该注销操作。</span><span class="sxs-lookup"><span data-stu-id="fb801-209">Clicking the **Log off** link calls the LogOff action in the account controller.</span></span> 

    [!code-csharp[Main](introduction-to-aspnet-identity/samples/sample5.cs?highlight=6)]

 <span data-ttu-id="fb801-210">突出显示的代码所示 OWIN`AuthenticationManager.SignOut`方法。</span><span class="sxs-lookup"><span data-stu-id="fb801-210">The highlighted code above shows the OWIN `AuthenticationManager.SignOut` method.</span></span> <span data-ttu-id="fb801-211">这是类似于[FormsAuthentication.SignOut](https://msdn.microsoft.com/en-us/library/system.web.security.formsauthentication.signout.aspx)方法，由[FormsAuthentication](https://msdn.microsoft.com/en-us/library/system.web.security.formsauthenticationmodule.aspx) Web 窗体中的模块。</span><span class="sxs-lookup"><span data-stu-id="fb801-211">This is analogous to [FormsAuthentication.SignOut](https://msdn.microsoft.com/en-us/library/system.web.security.formsauthentication.signout.aspx) method used by the [FormsAuthentication](https://msdn.microsoft.com/en-us/library/system.web.security.formsauthenticationmodule.aspx) module in Web Forms.</span></span>

## <a name="components-of-aspnet-identity"></a><span data-ttu-id="fb801-212">ASP.NET 标识的组件</span><span class="sxs-lookup"><span data-stu-id="fb801-212">Components of ASP.NET Identity</span></span>

<span data-ttu-id="fb801-213">下图显示了 ASP.NET 标识系统中的各组成部分 (单击[这](introduction-to-aspnet-identity/_static/image3.png)或放大关系图上)。</span><span class="sxs-lookup"><span data-stu-id="fb801-213">The diagram below shows the components of the ASP.NET Identity system (click on [this](introduction-to-aspnet-identity/_static/image3.png) or on the diagram to enlarge it).</span></span> <span data-ttu-id="fb801-214">绿色中的包构成了 ASP.NET 标识系统。</span><span class="sxs-lookup"><span data-stu-id="fb801-214">The packages in green make up the ASP.NET Identity system.</span></span> <span data-ttu-id="fb801-215">所有其他包都需要 ASP.NET 应用程序中使用的 ASP.NET 标识系统的依赖项。</span><span class="sxs-lookup"><span data-stu-id="fb801-215">All the other packages are dependencies which are needed to use the ASP.NET Identity system in ASP.NET applications.</span></span>

[![](introduction-to-aspnet-identity/_static/image5.png)](introduction-to-aspnet-identity/_static/image4.png)

<span data-ttu-id="fb801-216">下面是不前面提到的 NuGet 包的简短说明：</span><span class="sxs-lookup"><span data-stu-id="fb801-216">The following is a brief description of the NuGet packages not mentioned previously:</span></span>

- [<span data-ttu-id="fb801-217">Microsoft.Owin.Security.Cookies</span><span class="sxs-lookup"><span data-stu-id="fb801-217">Microsoft.Owin.Security.Cookies</span></span>](http://www.nuget.org/packages/Microsoft.Owin.Security.Cookies/)  
 <span data-ttu-id="fb801-218">可让应用程序使用 cookie 中间件基于身份验证，类似于 ASP。NET 的窗体身份验证。</span><span class="sxs-lookup"><span data-stu-id="fb801-218">Middleware that enables an application to use cookie based authentication, similar to ASP.NET's Forms Authentication.</span></span>
- [<span data-ttu-id="fb801-219">EntityFramework</span><span class="sxs-lookup"><span data-stu-id="fb801-219">EntityFramework</span></span>](http://www.nuget.org/packages/EntityFramework/)  
 <span data-ttu-id="fb801-220">实体框架是用于关系数据库的 Microsoft 的推荐使用此数据访问技术。</span><span class="sxs-lookup"><span data-stu-id="fb801-220">Entity Framework is Microsoft's recommended data access technology for relational databases.</span></span>

## <a name="migrating-from-membership-to-aspnet-identity"></a><span data-ttu-id="fb801-221">从成员资格迁移到 ASP.NET 标识</span><span class="sxs-lookup"><span data-stu-id="fb801-221">Migrating from Membership to ASP.NET Identity</span></span>

<span data-ttu-id="fb801-222">我们希望很快迁移现有应用到新的 ASP.NET 标识系统中使用 ASP.NET 成员资格或简单的成员身份提供指导。</span><span class="sxs-lookup"><span data-stu-id="fb801-222">We hope to soon provide guidance on migrating your existing apps that use ASP.NET Membership or Simple Membership to the new ASP.NET Identity system.</span></span>

## <a name="next-steps"></a><span data-ttu-id="fb801-223">后续步骤</span><span class="sxs-lookup"><span data-stu-id="fb801-223">Next Steps</span></span>

- [<span data-ttu-id="fb801-224">创建 ASP.NET MVC 5 应用程序使用 Facebook 和 Google OAuth2 和 OpenID 登录</span><span class="sxs-lookup"><span data-stu-id="fb801-224">Create an ASP.NET MVC 5 App with Facebook and Google OAuth2 and OpenID Sign-on</span></span>](../../../mvc/overview/security/create-an-aspnet-mvc-5-app-with-facebook-and-google-oauth2-and-openid-sign-on.md)  
 <span data-ttu-id="fb801-225">本教程使用 ASP.NET 标识 API 添加到用户数据库的配置文件信息以及如何使用 Google 和 Facebook 进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="fb801-225">The tutorial uses the ASP.NET Identity API to add profile information to the user database, and how to authenticate with Google and Facebook.</span></span>
- [<span data-ttu-id="fb801-226">使用身份验证和 SQL 数据库中创建的 ASP.NET MVC 应用并部署到 Azure App Service</span><span class="sxs-lookup"><span data-stu-id="fb801-226">Create an ASP.NET MVC app with auth and SQL DB and deploy to Azure App Service</span></span>](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data)  
 <span data-ttu-id="fb801-227">本教程演示如何使用标识 API 来添加用户和角色。</span><span class="sxs-lookup"><span data-stu-id="fb801-227">This tutorial shows how to use the Identity API to add users and roles.</span></span>
- <span data-ttu-id="fb801-228">[单个用户帐户](../../../visual-studio/overview/2013/creating-web-projects-in-visual-studio.md#indauth)中创建 ASP.NET Web 项目在 Visual Studio 2013</span><span class="sxs-lookup"><span data-stu-id="fb801-228">[Individual User Accounts](../../../visual-studio/overview/2013/creating-web-projects-in-visual-studio.md#indauth) in Creating ASP.NET Web Projects in Visual Studio 2013</span></span>
- <span data-ttu-id="fb801-229">[组织帐户](../../../visual-studio/overview/2013/creating-web-projects-in-visual-studio.md#orgauth)中创建 ASP.NET Web 项目在 Visual Studio 2013</span><span class="sxs-lookup"><span data-stu-id="fb801-229">[Organizational Accounts](../../../visual-studio/overview/2013/creating-web-projects-in-visual-studio.md#orgauth) in Creating ASP.NET Web Projects in Visual Studio 2013</span></span>
- [<span data-ttu-id="fb801-230">在 ASP.NET Identity 中 VS 2013 模板中的自定义配置文件信息</span><span class="sxs-lookup"><span data-stu-id="fb801-230">Customizing profile information in ASP.NET Identity in VS 2013 templates</span></span>](https://blogs.msdn.com/b/webdev/archive/2013/10/16/customizing-profile-information-in-asp-net-identity-in-vs-2013-templates.aspx)
- [<span data-ttu-id="fb801-231">从 VS 2013 项目模板中使用的社交提供商获取详细信息</span><span class="sxs-lookup"><span data-stu-id="fb801-231">Get more information from Social providers used in the VS 2013 project templates</span></span>](https://blogs.msdn.com/b/webdev/archive/2013/10/16/get-more-information-from-social-providers-used-in-the-vs-2013-project-templates.aspx)
- [<span data-ttu-id="fb801-232">https://github.com/rustd/AspnetIdentitySample</span><span class="sxs-lookup"><span data-stu-id="fb801-232">https://github.com/rustd/AspnetIdentitySample</span></span>](https://github.com/rustd/AspnetIdentitySample)  
 <span data-ttu-id="fb801-233">演示如何添加基本的角色和用户支持以及如何执行角色和用户管理的示例应用程序。</span><span class="sxs-lookup"><span data-stu-id="fb801-233">Sample application that shows how to add basic roles and user support and how to do roles and user management.</span></span>
