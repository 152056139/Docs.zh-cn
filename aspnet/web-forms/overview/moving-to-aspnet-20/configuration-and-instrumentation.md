---
uid: web-forms/overview/moving-to-aspnet-20/configuration-and-instrumentation
title: 配置和检测 |Microsoft 文档
author: microsoft
description: 有配置中的重大更改和 ASP.NET 2.0 中的检测。 使用新的 ASP.NET 配置 API，配置更改进行 pr...
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2005
ms.topic: article
ms.assetid: 21ebbaee-7ed8-45ae-b6c1-c27c88342e48
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/moving-to-aspnet-20/configuration-and-instrumentation
msc.type: authoredcontent
ms.openlocfilehash: 16dfe3c899dfa028d8a52b4b5f9c2868887e8fa9
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/10/2018
---
<a name="configuration-and-instrumentation"></a><span data-ttu-id="e8c77-104">配置和检测</span><span class="sxs-lookup"><span data-stu-id="e8c77-104">Configuration and Instrumentation</span></span>
====================
<span data-ttu-id="e8c77-105">by [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="e8c77-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="e8c77-106">有配置中的重大更改和 ASP.NET 2.0 中的检测。</span><span class="sxs-lookup"><span data-stu-id="e8c77-106">There are major changes in configuration and instrumentation in ASP.NET 2.0.</span></span> <span data-ttu-id="e8c77-107">新的 ASP.NET 配置 API 允许以编程方式进行配置更改。</span><span class="sxs-lookup"><span data-stu-id="e8c77-107">The new ASP.NET configuration API allows for configuration changes to be made programmatically.</span></span> <span data-ttu-id="e8c77-108">此外，许多新的配置设置存在允许对新的配置和检测。</span><span class="sxs-lookup"><span data-stu-id="e8c77-108">In addition, many new configuration settings exist allow for new configurations and instrumentation.</span></span>


<span data-ttu-id="e8c77-109">有配置中的重大更改和 ASP.NET 2.0 中的检测。</span><span class="sxs-lookup"><span data-stu-id="e8c77-109">There are major changes in configuration and instrumentation in ASP.NET 2.0.</span></span> <span data-ttu-id="e8c77-110">新的 ASP.NET 配置 API 允许以编程方式进行配置更改。</span><span class="sxs-lookup"><span data-stu-id="e8c77-110">The new ASP.NET configuration API allows for configuration changes to be made programmatically.</span></span> <span data-ttu-id="e8c77-111">此外，许多新的配置设置存在允许对新的配置和检测。</span><span class="sxs-lookup"><span data-stu-id="e8c77-111">In addition, many new configuration settings exist allow for new configurations and instrumentation.</span></span>

<span data-ttu-id="e8c77-112">在此模块中，我们将讨论 ASP.NET 配置 API，它与读取和写入 ASP.NET 配置文件，以及我们还将介绍 ASP.NET 检测。</span><span class="sxs-lookup"><span data-stu-id="e8c77-112">In this module, we will discuss ASP.NET the configuration API as it relates to reading from and writing to ASP.NET configuration files, and we will also cover ASP.NET instrumentation.</span></span> <span data-ttu-id="e8c77-113">我们将介绍在 ASP.NET 跟踪中的新功能。</span><span class="sxs-lookup"><span data-stu-id="e8c77-113">We will also cover the new features available in ASP.NET tracing.</span></span>

## <a name="aspnet-configuration-api"></a><span data-ttu-id="e8c77-114">ASP.NET 配置 API</span><span class="sxs-lookup"><span data-stu-id="e8c77-114">ASP.NET Configuration API</span></span>

<span data-ttu-id="e8c77-115">ASP.NET 配置 API 允许你开发、 部署和管理通过使用一个编程接口的应用程序配置数据。</span><span class="sxs-lookup"><span data-stu-id="e8c77-115">The ASP.NET configuration API allows you to develop, deploy, and manage application configuration data by using a single programming interface.</span></span> <span data-ttu-id="e8c77-116">配置 API 可用于开发和以编程方式修改完成 ASP.NET 配置，而无需直接编辑配置文件中的 XML。</span><span class="sxs-lookup"><span data-stu-id="e8c77-116">You can use the configuration API to develop and modify complete ASP.NET configurations programmatically without directly editing the XML in the configuration files.</span></span> <span data-ttu-id="e8c77-117">此外，你可以使用配置 API 在控制台应用程序和开发的脚本、 基于 Web 的管理工具以及 Microsoft 管理控制台 (MMC) 管理单元。</span><span class="sxs-lookup"><span data-stu-id="e8c77-117">In addition, you can use the configuration API in console applications and scripts that you develop, in Web-based management tools, and in Microsoft Management Console (MMC) snap-ins.</span></span>

<span data-ttu-id="e8c77-118">以下两个配置管理工具使用的配置 API，并且会随附.NET Framework 2.0 版：</span><span class="sxs-lookup"><span data-stu-id="e8c77-118">The following two configuration-management tools use the configuration API and are included with the .NET Framework version 2.0:</span></span>

- <span data-ttu-id="e8c77-119">ASP.NET MMC 管理单元中，使用配置 API 以简化管理任务，提供本地配置数据从配置层次结构的所有级别的集成的视图。</span><span class="sxs-lookup"><span data-stu-id="e8c77-119">The ASP.NET MMC snap-in, which uses the configuration API to simplify administrative tasks, providing an integrated view of local configuration data from all levels of the configuration hierarchy.</span></span>
- <span data-ttu-id="e8c77-120">网站管理工具，将允许你管理本地和远程应用程序的配置设置，包括托管的站点。</span><span class="sxs-lookup"><span data-stu-id="e8c77-120">The Web Site Administration Tool, which allows you to manage configuration settings for local and remote applications, including hosted sites.</span></span>

<span data-ttu-id="e8c77-121">ASP.NET 配置 API 包含一组可用于以编程方式配置网站和应用程序的 ASP.NET 管理对象。</span><span class="sxs-lookup"><span data-stu-id="e8c77-121">The ASP.NET configuration API comprises a set of ASP.NET management objects that you can use to configure Web sites and applications programmatically.</span></span> <span data-ttu-id="e8c77-122">管理对象是为.NET Framework 类库实现的。</span><span class="sxs-lookup"><span data-stu-id="e8c77-122">Management objects are implemented as a .NET Framework class library.</span></span> <span data-ttu-id="e8c77-123">配置 API 编程模型有助于确保通过在编译时强制数据类型的代码的一致性和可靠性。</span><span class="sxs-lookup"><span data-stu-id="e8c77-123">The configuration API programming model helps ensure code consistency and reliability by enforcing data types at compile time.</span></span> <span data-ttu-id="e8c77-124">若要更加轻松地管理应用程序配置，配置 API，你可以查看作为单个集合，而不是将这些数据视为通过不同的单独集合情况下从配置层次结构中的所有点合并的数据配置文件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-124">To make it easier to manage application configurations, the configuration API allows you to view data that is merged from all points in the configuration hierarchy as a single collection, instead of viewing the data as separate collections from different configuration files.</span></span> <span data-ttu-id="e8c77-125">此外，配置 API 使你能够无需直接编辑配置文件中的 XML 处理整个应用程序配置。</span><span class="sxs-lookup"><span data-stu-id="e8c77-125">Additionally, the configuration API enables you to manipulate entire application configurations without directly editing the XML in the configuration files.</span></span> <span data-ttu-id="e8c77-126">最后，该 API 简化了通过支持管理工具，如网站管理工具的配置任务。</span><span class="sxs-lookup"><span data-stu-id="e8c77-126">Finally, the API simplifies configuration tasks by supporting administrative tools, such as the Web Site Administration Tool.</span></span> <span data-ttu-id="e8c77-127">配置 API 简化了通过支持的配置文件的计算机上创建和运行配置脚本在多台计算机的部署。</span><span class="sxs-lookup"><span data-stu-id="e8c77-127">The configuration API simplifies deployment by supporting the creation of configuration files on a computer and running configuration scripts across multiple computers.</span></span>

> [!NOTE]
> <span data-ttu-id="e8c77-128">配置 API 不支持 IIS 应用程序的创建。</span><span class="sxs-lookup"><span data-stu-id="e8c77-128">The configuration API does not support the creation of IIS applications.</span></span>


## <a name="working-with-local-and-remote-configuration-settings"></a><span data-ttu-id="e8c77-129">使用本地和远程配置设置</span><span class="sxs-lookup"><span data-stu-id="e8c77-129">Working with Local and Remote Configuration Settings</span></span>

<span data-ttu-id="e8c77-130">配置对象表示应用于特定的物理实体，如一台计算机，或逻辑实体，如应用程序或网站的配置设置的合并的视图。</span><span class="sxs-lookup"><span data-stu-id="e8c77-130">A Configuration object represents the merged view of the configuration settings that apply to a specific physical entity, such as a computer, or to a logical entity, such as an application or a Web site.</span></span> <span data-ttu-id="e8c77-131">在本地计算机或远程服务器上，可以存在指定的逻辑实体。</span><span class="sxs-lookup"><span data-stu-id="e8c77-131">The specified logical entity can exist on the local computer or on a remote server.</span></span> <span data-ttu-id="e8c77-132">当配置文件不存在为指定的实体时，配置对象表示由 Machine.config 文件定义的默认配置设置。</span><span class="sxs-lookup"><span data-stu-id="e8c77-132">When no configuration file exists for a specified entity, the Configuration object represents the default configuration settings as defined by the Machine.config file.</span></span>

<span data-ttu-id="e8c77-133">你可以通过使用以下类中的打开配置方法之一来获取配置对象：</span><span class="sxs-lookup"><span data-stu-id="e8c77-133">You can get a Configuration object by using one of the open configuration methods from the following classes:</span></span>

1. <span data-ttu-id="e8c77-134">ConfigurationManager 类中，如果你的实体是一个客户端应用程序。</span><span class="sxs-lookup"><span data-stu-id="e8c77-134">The ConfigurationManager class, if your entity is a client application.</span></span>
2. <span data-ttu-id="e8c77-135">WebConfigurationManager 类中，如果你的实体是一个 Web 应用程序。</span><span class="sxs-lookup"><span data-stu-id="e8c77-135">The WebConfigurationManager class, if your entity is a Web application.</span></span>

<span data-ttu-id="e8c77-136">这些方法将返回配置对象，它又提供所需的方法和属性，以处理基础的配置文件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-136">These methods will return a Configuration object, which in turn provides the required methods and properties to handle the underlying configuration files.</span></span> <span data-ttu-id="e8c77-137">你可以访问这些文件进行读取或写入。</span><span class="sxs-lookup"><span data-stu-id="e8c77-137">You can access these files for reading or writing.</span></span>

### <a name="reading"></a><span data-ttu-id="e8c77-138">阅读</span><span class="sxs-lookup"><span data-stu-id="e8c77-138">Reading</span></span>

<span data-ttu-id="e8c77-139">GetSection 或 GetSectionGroup 方法用于读取配置信息。</span><span class="sxs-lookup"><span data-stu-id="e8c77-139">You use the GetSection or GetSectionGroup method to read configuration information.</span></span> <span data-ttu-id="e8c77-140">用户或读取的进程必须具有读取所有层次结构中的配置文件上的权限。</span><span class="sxs-lookup"><span data-stu-id="e8c77-140">The user or process that reads must have Read permissions on all of the configuration files in the hierarchy.</span></span>

> [!NOTE]
> <span data-ttu-id="e8c77-141">如果你使用一个带 path 参数的静态 GetSection 方法，path 参数必须引用在其中运行代码的应用程序。</span><span class="sxs-lookup"><span data-stu-id="e8c77-141">If you use a static GetSection method that takes a path parameter, the path parameter must refer to the application in which the code is running.</span></span> <span data-ttu-id="e8c77-142">否则为将忽略此参数并返回当前正在运行的应用程序的配置信息。</span><span class="sxs-lookup"><span data-stu-id="e8c77-142">Otherwise, the parameter is ignored and the configuration information for the currently running application is returned.</span></span>


### <a name="writing"></a><span data-ttu-id="e8c77-143">写入</span><span class="sxs-lookup"><span data-stu-id="e8c77-143">Writing</span></span>

<span data-ttu-id="e8c77-144">你可以使用一种保存方法以编写配置信息。</span><span class="sxs-lookup"><span data-stu-id="e8c77-144">You use one of the Save methods to write configuration information.</span></span> <span data-ttu-id="e8c77-145">用户或进程的写入操作必须具有写入权限的配置文件和目录在当前配置层次结构级别，以及读取所有层次结构中的配置文件上的权限。</span><span class="sxs-lookup"><span data-stu-id="e8c77-145">The user or process that writes must have Write permissions on the configuration file and directory at the current configuration hierarchy level, as well as Read permissions on all of the configuration files in the hierarchy.</span></span>

<span data-ttu-id="e8c77-146">若要生成表示指定的实体的继承的配置设置的配置文件，请使用保存配置的以下方法之一：</span><span class="sxs-lookup"><span data-stu-id="e8c77-146">To generate a configuration file that represents the inherited configuration settings for a specified entity, use one of the following save-configuration methods:</span></span>

1. <span data-ttu-id="e8c77-147">Save 方法来创建新的配置文件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-147">The Save method to create a new configuration file.</span></span>
2. <span data-ttu-id="e8c77-148">要生成新的配置文件在另一个位置的另存为方法。</span><span class="sxs-lookup"><span data-stu-id="e8c77-148">The SaveAs method to generate a new configuration file at another location.</span></span>

## <a name="configuration-classes-and-namespaces"></a><span data-ttu-id="e8c77-149">配置类和命名空间</span><span class="sxs-lookup"><span data-stu-id="e8c77-149">Configuration Classes and Namespaces</span></span>

<span data-ttu-id="e8c77-150">很多配置类和方法都类似于彼此。</span><span class="sxs-lookup"><span data-stu-id="e8c77-150">Many configuration classes and methods are similar to each other.</span></span> <span data-ttu-id="e8c77-151">下表描述的最常用的配置类和命名空间。</span><span class="sxs-lookup"><span data-stu-id="e8c77-151">The following table describes the most commonly used configuration classes and namespaces.</span></span>

| <span data-ttu-id="e8c77-152">**配置类或命名空间**</span><span class="sxs-lookup"><span data-stu-id="e8c77-152">**Configuration class or namespace**</span></span> | <span data-ttu-id="e8c77-153">**说明**</span><span class="sxs-lookup"><span data-stu-id="e8c77-153">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="e8c77-154">[System.Configuration](https://msdn.microsoft.com/library/system.configuration.aspx) namespace</span><span class="sxs-lookup"><span data-stu-id="e8c77-154">[System.Configuration](https://msdn.microsoft.com/library/system.configuration.aspx) namespace</span></span> | <span data-ttu-id="e8c77-155">包含所有.NET Framework 应用程序的主要配置类。</span><span class="sxs-lookup"><span data-stu-id="e8c77-155">Contains the main configuration classes for all .NET Framework applications.</span></span> <span data-ttu-id="e8c77-156">部分处理程序类用于从方法，如 GetSection 和 GetSectionGroup 获取节的配置数据。</span><span class="sxs-lookup"><span data-stu-id="e8c77-156">Section handler classes are used to obtain configuration data for a section from methods, such as GetSection and GetSectionGroup.</span></span> <span data-ttu-id="e8c77-157">这两种方法是非静态。</span><span class="sxs-lookup"><span data-stu-id="e8c77-157">These two methods are non-static.</span></span> |
| <span data-ttu-id="e8c77-158">System.Configuration.Configuration 类</span><span class="sxs-lookup"><span data-stu-id="e8c77-158">System.Configuration.Configuration class</span></span> | <span data-ttu-id="e8c77-159">表示一组对计算机、 应用程序、 Web 目录或其他资源的配置数据。</span><span class="sxs-lookup"><span data-stu-id="e8c77-159">Represents a set of configuration data for a computer, application, Web directory, or other resource.</span></span> <span data-ttu-id="e8c77-160">此类包含有用的方法，如 GetSection 和 GetSectionGroup，用于更新配置设置和获取对节和节组的引用。</span><span class="sxs-lookup"><span data-stu-id="e8c77-160">This class contains useful methods, such as GetSection and GetSectionGroup, for updating configuration settings and obtaining references to sections and section groups.</span></span> <span data-ttu-id="e8c77-161">此类用作获取设计时配置数据，如 WebConfigurationManager 和 ConfigurationManager 类方法的方法的返回类型。</span><span class="sxs-lookup"><span data-stu-id="e8c77-161">This class is used as a return type for methods that obtain design-time configuration data, such as the methods of the WebConfigurationManager and ConfigurationManager classes.</span></span> |
| <span data-ttu-id="e8c77-162">System.Web.Configuration 命名空间</span><span class="sxs-lookup"><span data-stu-id="e8c77-162">System.Web.Configuration namespace</span></span> | <span data-ttu-id="e8c77-163">ASP.NET 配置节定义在包含节处理程序类[ASP.NET 配置设置](https://msdn.microsoft.com/library/b5ysx397.aspx)。</span><span class="sxs-lookup"><span data-stu-id="e8c77-163">Contains the section handler classes for the ASP.NET configuration sections defined at [ASP.NET Configuration Settings](https://msdn.microsoft.com/library/b5ysx397.aspx).</span></span> <span data-ttu-id="e8c77-164">部分处理程序类用于从方法，如 GetSection 和 GetSectionGroup 获取节的配置数据。</span><span class="sxs-lookup"><span data-stu-id="e8c77-164">Section handler classes are used to obtain configuration data for a section from methods, such as GetSection and GetSectionGroup.</span></span> |
| <span data-ttu-id="e8c77-165">System.Web.Configuration.WebConfigurationManager class</span><span class="sxs-lookup"><span data-stu-id="e8c77-165">System.Web.Configuration.WebConfigurationManager class</span></span> | <span data-ttu-id="e8c77-166">提供用于获取指向运行时和设计时的配置设置的引用的有用方法。</span><span class="sxs-lookup"><span data-stu-id="e8c77-166">Provides useful methods for obtaining references to run-time and design-time configuration settings.</span></span> <span data-ttu-id="e8c77-167">这些方法将该 System.Configuration.Configuration 类用作返回类型。</span><span class="sxs-lookup"><span data-stu-id="e8c77-167">These methods use the System.Configuration.Configuration class as a return type.</span></span> <span data-ttu-id="e8c77-168">你可以交替使用此类的静态 GetSection 方法或 System.Configuration.ConfigurationManager 类的非静态 GetSection 方法。</span><span class="sxs-lookup"><span data-stu-id="e8c77-168">You can use the static GetSection method of this class or the non-static GetSection method of the System.Configuration.ConfigurationManager class interchangeably.</span></span> <span data-ttu-id="e8c77-169">对于 Web 应用程序配置，而不是 System.Configuration.ConfigurationManager 类建议 System.Web.Configuration.WebConfigurationManager 类。</span><span class="sxs-lookup"><span data-stu-id="e8c77-169">For Web application configurations, the System.Web.Configuration.WebConfigurationManager class is recommended instead of the System.Configuration.ConfigurationManager class.</span></span> |
| <span data-ttu-id="e8c77-170">[System.Configuration.Provider](https://msdn.microsoft.com/library/system.configuration.provider.aspx) namespace</span><span class="sxs-lookup"><span data-stu-id="e8c77-170">[System.Configuration.Provider](https://msdn.microsoft.com/library/system.configuration.provider.aspx) namespace</span></span> | <span data-ttu-id="e8c77-171">使您能够自定义和扩展的配置提供程序。</span><span class="sxs-lookup"><span data-stu-id="e8c77-171">Provides a way to customize and extend the configuration provider.</span></span> <span data-ttu-id="e8c77-172">这是配置系统中的所有提供程序类的基类。</span><span class="sxs-lookup"><span data-stu-id="e8c77-172">This is the base class for all provider classes in the configuration system.</span></span> |
| <span data-ttu-id="e8c77-173">[System.Web.Management](https://msdn.microsoft.com/library/system.web.management.aspx)命名空间</span><span class="sxs-lookup"><span data-stu-id="e8c77-173">[System.Web.Management](https://msdn.microsoft.com/library/system.web.management.aspx) namespace</span></span> | <span data-ttu-id="e8c77-174">包含类和接口用于管理和监视的 Web 应用程序的运行状况。</span><span class="sxs-lookup"><span data-stu-id="e8c77-174">Contains classes and interfaces for managing and monitoring the health of Web applications.</span></span> <span data-ttu-id="e8c77-175">严格地说，此命名空间不被视为配置 API 的一部分。</span><span class="sxs-lookup"><span data-stu-id="e8c77-175">Strictly speaking, this namespace is not considered part of the configuration API.</span></span> <span data-ttu-id="e8c77-176">例如，跟踪和事件触发做出是通过此命名空间中的类实现。</span><span class="sxs-lookup"><span data-stu-id="e8c77-176">For example, tracing and event firing is accomplished by the classes in this namespace.</span></span> |
| <span data-ttu-id="e8c77-177">[System.Management.Instrumentation](https://msdn.microsoft.com/library/system.management.instrumentation.aspx)命名空间</span><span class="sxs-lookup"><span data-stu-id="e8c77-177">[System.Management.Instrumentation](https://msdn.microsoft.com/library/system.management.instrumentation.aspx) namespace</span></span> | <span data-ttu-id="e8c77-178">提供所需的检测应用程序公开其管理信息和潜在的使用者通过 Windows Management Instrumentation (WMI) 事件的类。</span><span class="sxs-lookup"><span data-stu-id="e8c77-178">Provides the classes necessary for the instrumentation of applications to expose their management information and events through Windows Management Instrumentation (WMI) to potential consumers.</span></span> <span data-ttu-id="e8c77-179">ASP.NET 运行状况监视使用 WMI 来提供事件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-179">ASP.NET health monitoring uses WMI to deliver events.</span></span> <span data-ttu-id="e8c77-180">严格地说，此命名空间不被视为配置 API 的一部分。</span><span class="sxs-lookup"><span data-stu-id="e8c77-180">Strictly speaking, this namespace is not considered part of the configuration API.</span></span> |

## <a name="reading-from-aspnet-configuration-files"></a><span data-ttu-id="e8c77-181">从 ASP.NET 配置文件读取</span><span class="sxs-lookup"><span data-stu-id="e8c77-181">Reading from ASP.NET Configuration Files</span></span>

<span data-ttu-id="e8c77-182">WebConfigurationManager 类是从 ASP.NET 配置文件进行读取的核心类。</span><span class="sxs-lookup"><span data-stu-id="e8c77-182">The WebConfigurationManager class is the core class for reading from ASP.NET configuration files.</span></span> <span data-ttu-id="e8c77-183">有三个步骤实质上是读取 ASP.NET 配置文件：</span><span class="sxs-lookup"><span data-stu-id="e8c77-183">There are essentially three steps to reading ASP.NET configuration files:</span></span>

1. <span data-ttu-id="e8c77-184">获取配置对象使用 OpenWebConfiguration 方法。</span><span class="sxs-lookup"><span data-stu-id="e8c77-184">Get a Configuration object using the OpenWebConfiguration method.</span></span>
2. <span data-ttu-id="e8c77-185">获取对所需的部分配置文件中的引用。</span><span class="sxs-lookup"><span data-stu-id="e8c77-185">Get a reference to the desired section in the configuration file.</span></span>
3. <span data-ttu-id="e8c77-186">从配置文件中读取所需的信息。</span><span class="sxs-lookup"><span data-stu-id="e8c77-186">Read the desired information from the configuration file.</span></span>

<span data-ttu-id="e8c77-187">对象表示的配置不表示特定配置文件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-187">The Configuration object represents does not represent a particular configuration file.</span></span> <span data-ttu-id="e8c77-188">相反，它表示计算机、 应用程序或网站的配置的合并的视图。</span><span class="sxs-lookup"><span data-stu-id="e8c77-188">Instead, it represents a merged view of the configuration of a computer, application, or Web site.</span></span> <span data-ttu-id="e8c77-189">下面的代码示例实例化一个表示调用一个 Web 应用程序的配置的配置对象*ProductInfo*。</span><span class="sxs-lookup"><span data-stu-id="e8c77-189">The following code sample instantiates a Configuration object representing the configuration of a Web application called *ProductInfo*.</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample1.cs)]

> [!NOTE]
> <span data-ttu-id="e8c77-190">请注意，是否 /ProductInfo 路径不存在，上面的代码将在 machine.config 文件中返回指定的默认配置。</span><span class="sxs-lookup"><span data-stu-id="e8c77-190">Note that if the /ProductInfo path doesn't exist, the above code will return the default configuration as specified in the machine.config file.</span></span>


<span data-ttu-id="e8c77-191">配置对象之后，可以使用 GetSection 或 GetSectionGroup 方法以向下钻取的配置设置。</span><span class="sxs-lookup"><span data-stu-id="e8c77-191">Once you have the Configuration object, you can then use the GetSection or GetSectionGroup method to drill into the configuration settings.</span></span> <span data-ttu-id="e8c77-192">下面的示例获取了对上述 ProductInfo 应用程序的模拟设置的引用：</span><span class="sxs-lookup"><span data-stu-id="e8c77-192">The following example gets a reference to the impersonation settings for the above ProductInfo application:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample2.cs)]

## <a name="writing-to-aspnet-configuration-files"></a><span data-ttu-id="e8c77-193">写入 ASP.NET 配置文件</span><span class="sxs-lookup"><span data-stu-id="e8c77-193">Writing to ASP.NET Configuration Files</span></span>

<span data-ttu-id="e8c77-194">如下所示从配置文件中读取，WebConfigurationManager 类是用于写入到 Asp.NET 配置文件的核心。</span><span class="sxs-lookup"><span data-stu-id="e8c77-194">As in reading from configuration files, the WebConfigurationManager class is the core for writing to Asp.NET configuration files.</span></span> <span data-ttu-id="e8c77-195">也有三个步骤向 ASP.NET 配置文件写入。</span><span class="sxs-lookup"><span data-stu-id="e8c77-195">There are also three steps to writing to ASP.NET configuration files.</span></span>

1. <span data-ttu-id="e8c77-196">获取配置对象使用 OpenWebConfiguration 方法。</span><span class="sxs-lookup"><span data-stu-id="e8c77-196">Get a Configuration object using the OpenWebConfiguration method.</span></span>
2. <span data-ttu-id="e8c77-197">获取对所需的部分配置文件中的引用。</span><span class="sxs-lookup"><span data-stu-id="e8c77-197">Get a reference to the desired section in the configuration file.</span></span>
3. <span data-ttu-id="e8c77-198">从使用保存或另存为配置文件将写入所需的信息方法。</span><span class="sxs-lookup"><span data-stu-id="e8c77-198">Write the desired information from the configuration file using the Save or SaveAs method.</span></span>

<span data-ttu-id="e8c77-199">下面的代码更改**调试**属性&lt;编译&gt;为 false 的元素：</span><span class="sxs-lookup"><span data-stu-id="e8c77-199">The following code changes the **debug** attribute of the &lt;compilation&gt; element to false:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample3.cs)]

<span data-ttu-id="e8c77-200">此代码执行时，**调试**属性&lt;编译&gt;元素将设置为 false *webApp*应用程序的 web.config 文件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-200">When this code is executed, the **debug** attribute of the &lt;compilation&gt; element will be set to false for the *webApp* application's web.config file.</span></span>

## <a name="systemwebmanagement-namespace"></a><span data-ttu-id="e8c77-201">System.Web.Management Namespace</span><span class="sxs-lookup"><span data-stu-id="e8c77-201">System.Web.Management Namespace</span></span>

<span data-ttu-id="e8c77-202">System.Web.Management 命名空间提供的类和接口用于管理和监视 ASP.NET 应用程序的运行状况。</span><span class="sxs-lookup"><span data-stu-id="e8c77-202">The System.Web.Management namespace provides the classes and interfaces for managing and monitoring the health of ASP.NET applications.</span></span>

<span data-ttu-id="e8c77-203">日志记录通过定义将事件与提供程序相关联的规则。</span><span class="sxs-lookup"><span data-stu-id="e8c77-203">Logging is accomplished by defining a rule that associates events with a provider.</span></span> <span data-ttu-id="e8c77-204">规则定义发送到提供程序的事件的类型。</span><span class="sxs-lookup"><span data-stu-id="e8c77-204">The rule defines the type of events that are sent to the provider.</span></span> <span data-ttu-id="e8c77-205">下面的基本事件是可供你登录：</span><span class="sxs-lookup"><span data-stu-id="e8c77-205">The following base events are available for you to log:</span></span>

| <span data-ttu-id="e8c77-206">**WebBaseEvent**</span><span class="sxs-lookup"><span data-stu-id="e8c77-206">**WebBaseEvent**</span></span> | <span data-ttu-id="e8c77-207">基事件类的所有事件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-207">The base event class for all events.</span></span> <span data-ttu-id="e8c77-208">包含所需属性的所有事件，如事件代码、 事件详细信息代码、 日期和时间引发该事件时，序列号、 事件消息和事件的详细信息。</span><span class="sxs-lookup"><span data-stu-id="e8c77-208">Contains the required properties for all events such as event code, event detail code, the date and time the event was raised, sequence number, the event message, and event details.</span></span> |
| --- | --- |
| <span data-ttu-id="e8c77-209">**WebManagementEvent**</span><span class="sxs-lookup"><span data-stu-id="e8c77-209">**WebManagementEvent**</span></span> | <span data-ttu-id="e8c77-210">基事件类，对于管理事件，如应用程序生命周期、 请求、 错误和审核事件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-210">The base event class for management events, such as application lifetime, request, error, and audit events.</span></span> |
| <span data-ttu-id="e8c77-211">**WebHeartbeatEvent**</span><span class="sxs-lookup"><span data-stu-id="e8c77-211">**WebHeartbeatEvent**</span></span> | <span data-ttu-id="e8c77-212">生成的固定时间间隔中的应用程序，以捕获有用的运行时状态信息事件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-212">The event generated by the application in regular intervals to capture useful runtime state information.</span></span> |
| <span data-ttu-id="e8c77-213">**WebAuditEvent**</span><span class="sxs-lookup"><span data-stu-id="e8c77-213">**WebAuditEvent**</span></span> | <span data-ttu-id="e8c77-214">安全审核事件，用于将标记条件授权失败，解密失败，如类的基类*等。*</span><span class="sxs-lookup"><span data-stu-id="e8c77-214">The base class for security audit events, which are used to mark conditions such as authorization failure, decryption failure, *etc.*</span></span> |
| <span data-ttu-id="e8c77-215">**WebRequestEvent**</span><span class="sxs-lookup"><span data-stu-id="e8c77-215">**WebRequestEvent**</span></span> | <span data-ttu-id="e8c77-216">所有信息性请求事件的基类。</span><span class="sxs-lookup"><span data-stu-id="e8c77-216">The base class for all informational request events.</span></span> |
| <span data-ttu-id="e8c77-217">**WebBaseErrorEvent**</span><span class="sxs-lookup"><span data-stu-id="e8c77-217">**WebBaseErrorEvent**</span></span> | <span data-ttu-id="e8c77-218">类的基类，该值指示错误条件的所有事件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-218">The base class for all events indicating error conditions.</span></span> |

<span data-ttu-id="e8c77-219">可用提供程序的类型，可以将事件输出发送到事件查看器、 SQL Server、 Windows Management Instrumentation (WMI) 和电子邮件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-219">The types of providers available allow you to send event output to Event Viewer, SQL Server, Windows Management Instrumentation (WMI), and email.</span></span> <span data-ttu-id="e8c77-220">预配置的提供程序和事件映射减少记录的事件输出所需的工作量。</span><span class="sxs-lookup"><span data-stu-id="e8c77-220">The pre-configured providers and event mappings reduce the amount of work necessary to get event output logged.</span></span>

<span data-ttu-id="e8c77-221">ASP.NET 2.0 使用事件日志提供程序的的现成记录事件基于应用程序域启动和停止，以及日志记录任何未经处理的异常。</span><span class="sxs-lookup"><span data-stu-id="e8c77-221">ASP.NET 2.0 uses the Event Log provider out-of-the-box to log events based on application domains starting and stopping, as well as logging any unhandled exceptions.</span></span> <span data-ttu-id="e8c77-222">这可帮助介绍一些基本方案。</span><span class="sxs-lookup"><span data-stu-id="e8c77-222">This helps to cover some of the basic scenarios.</span></span> <span data-ttu-id="e8c77-223">例如，假设你的应用程序引发异常，但用户不会保存错误，你不能再现它。</span><span class="sxs-lookup"><span data-stu-id="e8c77-223">For example, let's say that your application throws an exception, but the user doesn't save the error and you can't reproduce it.</span></span> <span data-ttu-id="e8c77-224">使用默认的事件日志规则，你将能够收集要更好地了解哪种错误发生的异常和堆栈的信息。</span><span class="sxs-lookup"><span data-stu-id="e8c77-224">With the default Event Log rule, you would be able to gather the exception and stack information to get a better idea of what kind of error occurred.</span></span> <span data-ttu-id="e8c77-225">如果你的应用程序丢失会话状态，另一个示例将应用。</span><span class="sxs-lookup"><span data-stu-id="e8c77-225">Another example applies if your application is losing session state.</span></span> <span data-ttu-id="e8c77-226">在这种情况下，你可以查看事件日志以确定是否回收应用程序域，以及应用程序域首先停止的原因。</span><span class="sxs-lookup"><span data-stu-id="e8c77-226">In that case, you can look in the Event Log to determine whether the application domain is recycling, and why the application domain stopped in the first place.</span></span>

<span data-ttu-id="e8c77-227">此外，监视系统的运行状况是可扩展的。</span><span class="sxs-lookup"><span data-stu-id="e8c77-227">Also, the health monitoring system is extensible.</span></span> <span data-ttu-id="e8c77-228">例如，你可以定义自定义 Web 事件、 应用程序中激发它们，然后定义一个规则以将事件信息发送到提供程序，例如你的电子邮件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-228">For example, you can define custom Web events, fire them within your application, and then define a rule to send the event information to a provider such as your email.</span></span> <span data-ttu-id="e8c77-229">这使您轻松地将你检测到监视提供程序的运行状况。</span><span class="sxs-lookup"><span data-stu-id="e8c77-229">This allows you to easily tie your instrumentation to the health monitoring providers.</span></span> <span data-ttu-id="e8c77-230">再举一例，无法触发事件每次处理订单并将其设置将每个事件发送到 SQL Server 数据库的规则。</span><span class="sxs-lookup"><span data-stu-id="e8c77-230">As another example, you could fire an event each time an order is processed and set up a rule that sends each event to the SQL Server database.</span></span> <span data-ttu-id="e8c77-231">也可以激发事件时用户无法登录多次在行中，并将事件设置为使用基于电子邮件的提供程序。</span><span class="sxs-lookup"><span data-stu-id="e8c77-231">You could also fire an event when a user fails to log on multiple times in a row, and set up the event to use the email-based providers.</span></span>

<span data-ttu-id="e8c77-232">默认的提供程序和事件的配置存储在全局的 Web.config 文件中。</span><span class="sxs-lookup"><span data-stu-id="e8c77-232">The configuration for the default providers and events is stored in the global Web.config file.</span></span> <span data-ttu-id="e8c77-233">全局的 Web.config 文件将存储所有的基于 Web 的设置的字符串存储在 Machine.config 文件在 ASP.NET 中 1 x。</span><span class="sxs-lookup"><span data-stu-id="e8c77-233">The global Web.config file stores all the Web-based settings that were stored in the Machine.config file in ASP.NET 1x.</span></span> <span data-ttu-id="e8c77-234">全局的 Web.config 文件位于以下目录：</span><span class="sxs-lookup"><span data-stu-id="e8c77-234">The global Web.config file is located in the following directory:</span></span>

`%windir%\Microsoft.Net\Framework\v2.0.*\config\Web.config`

<span data-ttu-id="e8c77-235">&lt;HealthMonitoring&gt;全局的 Web.config 文件的一部分提供了默认配置设置。</span><span class="sxs-lookup"><span data-stu-id="e8c77-235">The &lt;healthMonitoring&gt; section of the global Web.config file provides default configuration settings.</span></span> <span data-ttu-id="e8c77-236">你可以重写这些设置或配置你自己的设置方法是实现&lt;healthMonitoring&gt;你的应用程序的 Web.config 文件中的部分。</span><span class="sxs-lookup"><span data-stu-id="e8c77-236">You can override these setting or configure your own settings by implementing the &lt;healthMonitoring&gt; section in the Web.config file for your application.</span></span>

<span data-ttu-id="e8c77-237">&lt;HealthMonitoring&gt;部分的全局的 Web.config 文件包含以下各项：</span><span class="sxs-lookup"><span data-stu-id="e8c77-237">The &lt;healthMonitoring&gt; section of the global Web.config file contains the following items:</span></span>

| <span data-ttu-id="e8c77-238">**providers**</span><span class="sxs-lookup"><span data-stu-id="e8c77-238">**providers**</span></span> | <span data-ttu-id="e8c77-239">包含提供程序的事件查看器、 WMI、 和 SQL Server 设置。</span><span class="sxs-lookup"><span data-stu-id="e8c77-239">Contains providers set up for the Event Viewer, WMI, and SQL Server.</span></span> |
| --- | --- |
| <span data-ttu-id="e8c77-240">**eventMappings**</span><span class="sxs-lookup"><span data-stu-id="e8c77-240">**eventMappings**</span></span> | <span data-ttu-id="e8c77-241">包含各种 WebBase 类的映射。</span><span class="sxs-lookup"><span data-stu-id="e8c77-241">Contains mappings for the various WebBase classes.</span></span> <span data-ttu-id="e8c77-242">如果你生成自己事件的类，你可以扩展此列表。</span><span class="sxs-lookup"><span data-stu-id="e8c77-242">You can extend this list if you generate your own event class.</span></span> <span data-ttu-id="e8c77-243">生成您自己的事件类使能够你更细的粒度对发送到的信息的提供程序。</span><span class="sxs-lookup"><span data-stu-id="e8c77-243">Generating your own event class gives you finer granularity over the providers you send information to.</span></span> <span data-ttu-id="e8c77-244">例如，你可以配置未经处理的异常时将自己的自定义事件发送到电子邮件发送到 SQL Server。</span><span class="sxs-lookup"><span data-stu-id="e8c77-244">For example, you could configure unhandled exceptions to be sent to SQL Server, while sending your own custom events to email.</span></span> |
| <span data-ttu-id="e8c77-245">**rules**</span><span class="sxs-lookup"><span data-stu-id="e8c77-245">**rules**</span></span> | <span data-ttu-id="e8c77-246">链接到提供程序 eventMappings。</span><span class="sxs-lookup"><span data-stu-id="e8c77-246">Links the eventMappings to the provider.</span></span> |
| <span data-ttu-id="e8c77-247">**buffering**</span><span class="sxs-lookup"><span data-stu-id="e8c77-247">**buffering**</span></span> | <span data-ttu-id="e8c77-248">与 SQL Server 和电子邮件提供程序使用，来确定如何通常刷新到提供程序的事件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-248">Used with SQL Server and email providers to determine how often to flush the events to the provider.</span></span> |

<span data-ttu-id="e8c77-249">下面是全局的 Web.config 文件中的一个代码示例。</span><span class="sxs-lookup"><span data-stu-id="e8c77-249">Below is a code example from the global Web.config file.</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample4.xml)]

## <a name="how-to-store-events-to-event-viewer"></a><span data-ttu-id="e8c77-250">如何将存储到事件查看器的事件</span><span class="sxs-lookup"><span data-stu-id="e8c77-250">How to store events to Event Viewer</span></span>

<span data-ttu-id="e8c77-251">如前所述，来记录事件提供程序在事件查看器将为您配置在全局的 Web.config 文件中。</span><span class="sxs-lookup"><span data-stu-id="e8c77-251">As mentioned earlier, the provider for logging events in the Event Viewer is configured for you in the global Web.config file.</span></span> <span data-ttu-id="e8c77-252">默认情况下，所有事件都基于**WebBaseErrorEvent**和**WebFailureAuditEvent**记录。</span><span class="sxs-lookup"><span data-stu-id="e8c77-252">By default, all events based on **WebBaseErrorEvent** and **WebFailureAuditEvent** are logged.</span></span> <span data-ttu-id="e8c77-253">你可以添加其他规则，以记录到事件日志中的其他信息。</span><span class="sxs-lookup"><span data-stu-id="e8c77-253">You can add additional rules to log additional information to the Event Log.</span></span> <span data-ttu-id="e8c77-254">例如，如果你想要记录所有事件 (*即*，每个事件基于**WebBaseEvent**)，无法添加到 Web.config 文件的以下规则：</span><span class="sxs-lookup"><span data-stu-id="e8c77-254">For example, if you wanted to log all events (*i.e.*, every event based on **WebBaseEvent**), you could add the following rule to your Web.config file:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample5.xml)]

<span data-ttu-id="e8c77-255">此规则都可以链接**所有事件**事件映射到事件日志提供程序。</span><span class="sxs-lookup"><span data-stu-id="e8c77-255">This rule would link the **All Events** event map to the Event Log provider.</span></span> <span data-ttu-id="e8c77-256">EventMapping 和提供程序包含在全局的 Web.config 文件中。</span><span class="sxs-lookup"><span data-stu-id="e8c77-256">Both eventMapping and the provider are included in the global Web.config file.</span></span>

## <a name="how-to-store-events-to-sql-server"></a><span data-ttu-id="e8c77-257">如何将存储到 SQL Server 事件</span><span class="sxs-lookup"><span data-stu-id="e8c77-257">How to store events to SQL Server</span></span>

<span data-ttu-id="e8c77-258">此方法使用**ASPNETDB**数据库，生成的 Aspnet\_regsql.exe 工具。</span><span class="sxs-lookup"><span data-stu-id="e8c77-258">This method uses the **ASPNETDB** database, which is generated by the Aspnet\_regsql.exe tool.</span></span> <span data-ttu-id="e8c77-259">默认的提供程序使用 LocalSqlServer 连接字符串，它在应用程序中使用这两个基于文件的数据库\_数据文件夹或 SQL Server 的本地 SQLExpress 实例。</span><span class="sxs-lookup"><span data-stu-id="e8c77-259">The default provider uses the LocalSqlServer connection string, which uses either a file-based database in the App\_data folder or the local SQLExpress instance of SQL Server.</span></span> <span data-ttu-id="e8c77-260">LocalSqlServer 连接字符串和 SqlProvider 中全局的 Web.config 文件进行配置。</span><span class="sxs-lookup"><span data-stu-id="e8c77-260">Both the LocalSqlServer connection string and the SqlProvider are configured in the global Web.config file.</span></span>

<span data-ttu-id="e8c77-261">全局的 Web.config 文件中的 LocalSqlServer 连接字符串如下所示：</span><span class="sxs-lookup"><span data-stu-id="e8c77-261">The LocalSqlServer connection string in the global Web.config file looks like this:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample6.xml)]

<span data-ttu-id="e8c77-262">如果你想要使用另一个 SQL Server 实例，你将需要使用 Aspnet\_regsql.exe 工具，可在 %windir%\microsoft.net\framework\v2.0。\*文件夹。</span><span class="sxs-lookup"><span data-stu-id="e8c77-262">If you want to use another SQL Server instance, you'll need to use the Aspnet\_regsql.exe tool, which can be found in the %windir%\Microsoft.Net\Framework\v2.0.\* folder.</span></span> <span data-ttu-id="e8c77-263">使用 Aspnet\_regsql.exe 工具生成一个自定义**ASPNETDB**数据库的 SQL Server 实例上，然后将连接字符串添加到你的应用程序配置文件，然后使用新的添加提供程序连接字符串。</span><span class="sxs-lookup"><span data-stu-id="e8c77-263">Use the Aspnet\_regsql.exe tool to generate a custom **ASPNETDB** database on the SQL Server instance, then add the connection string to your applications configuration file, and then add a provider by using the new connection string.</span></span> <span data-ttu-id="e8c77-264">一旦**ASPNETDB**创建的数据库，你将需要设置规则，将 eventMapping 链接到 sqlProvider。</span><span class="sxs-lookup"><span data-stu-id="e8c77-264">Once you have the **ASPNETDB** database created, you'll need to set a rule to link an eventMapping to the sqlProvider.</span></span>

<span data-ttu-id="e8c77-265">是否使用默认 SqlProvider 或配置自己的提供程序时，你将需要添加链接具有事件映射的提供程序的规则。</span><span class="sxs-lookup"><span data-stu-id="e8c77-265">Whether you use the default SqlProvider or configure your own provider, you'll need to add a rule linking the provider with an event map.</span></span> <span data-ttu-id="e8c77-266">以下规则链接到上面创建的新提供程序**所有事件**事件映射。</span><span class="sxs-lookup"><span data-stu-id="e8c77-266">The following rule links the new provider that you created above to the **All Events** event map.</span></span> <span data-ttu-id="e8c77-267">此规则将日志基于的所有事件**WebBaseEvent**并将它们发送给将使用 MYASPNETDB 连接字符串 MySqlWebEventProvider。</span><span class="sxs-lookup"><span data-stu-id="e8c77-267">This rule will log all the events based on **WebBaseEvent** and send them to the MySqlWebEventProvider that will use the MYASPNETDB connection string.</span></span> <span data-ttu-id="e8c77-268">下面的代码添加规则以将具有事件映射的提供程序的链接：</span><span class="sxs-lookup"><span data-stu-id="e8c77-268">The following code adds a rule to link the provider with an event map:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample7.xml)]

<span data-ttu-id="e8c77-269">如果你想要仅将错误发送给 SQL Server，则可以添加以下规则：</span><span class="sxs-lookup"><span data-stu-id="e8c77-269">If you wanted to only send errors to SQL Server, you could add the following rule:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample8.xml)]

## <a name="how-to-forward-events-to-wmi"></a><span data-ttu-id="e8c77-270">如何将事件转发到 WMI</span><span class="sxs-lookup"><span data-stu-id="e8c77-270">How to forward events to WMI</span></span>

<span data-ttu-id="e8c77-271">你还可以将事件转发到 WMI。</span><span class="sxs-lookup"><span data-stu-id="e8c77-271">You can also forward the events to WMI.</span></span> <span data-ttu-id="e8c77-272">WMI 提供程序为你在全局的 Web.config 文件中配置，默认情况下。</span><span class="sxs-lookup"><span data-stu-id="e8c77-272">The WMI provider is configured for you in the global Web.config file by default.</span></span>

<span data-ttu-id="e8c77-273">下面的代码示例将添加一个规则以将事件转发到 WMI:</span><span class="sxs-lookup"><span data-stu-id="e8c77-273">The following code example adds a rule to forward the events to WMI:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample9.xml)]

<span data-ttu-id="e8c77-274">你将需要添加规则以将提供程序，而且还需要 WMI 侦听器应用程序侦听事件 eventMapping 相关联。</span><span class="sxs-lookup"><span data-stu-id="e8c77-274">You will need to add a rule to associate an eventMapping to the provider, and also a WMI listener application to listen for the events.</span></span> <span data-ttu-id="e8c77-275">下面的代码示例将添加一个规则以链接到 WMI 提供程序**所有事件**事件映射：</span><span class="sxs-lookup"><span data-stu-id="e8c77-275">The following code example adds a rule to link the WMI provider to the **All Events** event map:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample10.xml)]

## <a name="how-to-forward-events-to-email"></a><span data-ttu-id="e8c77-276">如何将事件转发到电子邮件</span><span class="sxs-lookup"><span data-stu-id="e8c77-276">How to forward events to email</span></span>

<span data-ttu-id="e8c77-277">你还可以转发电子邮件事件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-277">You can also forward events to email.</span></span> <span data-ttu-id="e8c77-278">注意有关你可以将其映射到你的电子邮件提供商，你可以无意中向自己发送大量的信息，如哪些事件规则可能是更好地适用于 SQL Server 或事件日志。</span><span class="sxs-lookup"><span data-stu-id="e8c77-278">Be careful about which event rules you map to your email provider, as you can unintentionally send yourself a lot of information that may be better suited for SQL Server or the Event Log.</span></span> <span data-ttu-id="e8c77-279">有两个电子邮件提供商;SimpleMailWebEventProvider 和 TemplatedMailWebEventProvider。</span><span class="sxs-lookup"><span data-stu-id="e8c77-279">There are two email providers; SimpleMailWebEventProvider and TemplatedMailWebEventProvider.</span></span> <span data-ttu-id="e8c77-280">每个具有相同的配置属性，除了的"模板"和"detailedTemplateErrors"的属性，这两种才 TemplatedMailWebEventProvider 上可用。</span><span class="sxs-lookup"><span data-stu-id="e8c77-280">Each has the same configuration attributes, with the exception of the "template" and "detailedTemplateErrors" attributes, both of which are only available on the TemplatedMailWebEventProvider.</span></span>

> [!NOTE]
> <span data-ttu-id="e8c77-281">这些电子邮件提供商任一是为你配置的。</span><span class="sxs-lookup"><span data-stu-id="e8c77-281">Neither of these email providers is configured for you.</span></span> <span data-ttu-id="e8c77-282">你将需要将它们添加到你的 Web.config 文件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-282">You'll need to add them to your Web.config file.</span></span>


<span data-ttu-id="e8c77-283">这些两个电子邮件提供商之间的主要区别是 SimpleMailWebEventProvider 泛型模板不能修改中发送电子邮件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-283">The main difference between these two email providers is that SimpleMailWebEventProvider sends emails in a generic template that cannot be modified.</span></span> <span data-ttu-id="e8c77-284">示例 Web.config 文件使用以下规则将此电子邮件提供程序添加到配置提供程序的列表：</span><span class="sxs-lookup"><span data-stu-id="e8c77-284">The sample Web.config file adds this email provider to the list of configured providers by using the following rule:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample11.xml)]

<span data-ttu-id="e8c77-285">此外添加以下规则以将绑定到电子邮件提供商**所有事件**事件映射：</span><span class="sxs-lookup"><span data-stu-id="e8c77-285">The following rule is also added to tie the email provider to the **All Events** event map:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample12.xml)]

## <a name="aspnet-20-tracing"></a><span data-ttu-id="e8c77-286">ASP.NET 2.0 Tracing</span><span class="sxs-lookup"><span data-stu-id="e8c77-286">ASP.NET 2.0 Tracing</span></span>

<span data-ttu-id="e8c77-287">有三个主要增强功能，与 ASP.NET 2.0 中的跟踪。</span><span class="sxs-lookup"><span data-stu-id="e8c77-287">There are three major enhancements to tracing in ASP.NET 2.0.</span></span>

1. <span data-ttu-id="e8c77-288">集成的跟踪功能</span><span class="sxs-lookup"><span data-stu-id="e8c77-288">Integrated tracing functionality</span></span>
2. <span data-ttu-id="e8c77-289">以编程方式访问跟踪消息</span><span class="sxs-lookup"><span data-stu-id="e8c77-289">Programmatic access to trace messages</span></span>
3. <span data-ttu-id="e8c77-290">改进了应用程序级跟踪</span><span class="sxs-lookup"><span data-stu-id="e8c77-290">Improved application-level tracing</span></span>

## <a name="integrated-tracing-functionality"></a><span data-ttu-id="e8c77-291">集成跟踪功能</span><span class="sxs-lookup"><span data-stu-id="e8c77-291">Integrated Tracing Functionality</span></span>

<span data-ttu-id="e8c77-292">现在可以将消息发出到 ASP.NET 跟踪输出，System.Diagnostics.Trace 类的路由和路由到 System.Diagnostics.Trace ASP.NET 跟踪发出的消息。</span><span class="sxs-lookup"><span data-stu-id="e8c77-292">You can now route messages emitted by the System.Diagnostics.Trace class to ASP.NET tracing output, and route messages emitted by ASP.NET tracing to System.Diagnostics.Trace.</span></span> <span data-ttu-id="e8c77-293">你还可以将 ASP.NET 检测事件转发到 System.Diagnostics.Trace。</span><span class="sxs-lookup"><span data-stu-id="e8c77-293">You can also forward ASP.NET instrumentation events to System.Diagnostics.Trace.</span></span> <span data-ttu-id="e8c77-294">此功能提供新的**writeToDiagnosticsTrace**属性&lt;跟踪&gt;元素。</span><span class="sxs-lookup"><span data-stu-id="e8c77-294">This functionality is provided by the new **writeToDiagnosticsTrace** attribute of the &lt;trace&gt; element.</span></span> <span data-ttu-id="e8c77-295">当此布尔值为 true 时，ASP.NET 跟踪消息将转发到使用 System.Diagnostics 跟踪基础结构，通过注册来显示跟踪消息的任何侦听器。</span><span class="sxs-lookup"><span data-stu-id="e8c77-295">When this Boolean value is true, ASP.NET Trace messages are forwarded to the System.Diagnostics tracing infrastructure for use by any listeners that are registered to display Trace messages.</span></span>

## <a name="programmatic-access-to-trace-messages"></a><span data-ttu-id="e8c77-296">编程访问以跟踪消息</span><span class="sxs-lookup"><span data-stu-id="e8c77-296">Programmatic Access to Trace Messages</span></span>

<span data-ttu-id="e8c77-297">ASP.NET 2.0 允许以编程方式访问通过的所有跟踪消息**TraceContextRecord**类和**TraceRecords**集合。</span><span class="sxs-lookup"><span data-stu-id="e8c77-297">ASP.NET 2.0 allows for programmatic access to all trace messages via the **TraceContextRecord** class and the **TraceRecords** collection.</span></span> <span data-ttu-id="e8c77-298">访问跟踪消息的最有效的方式是注册**TraceContextEventHandler** （ASP.NET 2.0 中还新） 的委托来处理新**TraceFinished**事件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-298">The most efficient way of accessing trace messages is to register a **TraceContextEventHandler** delegate (also new in ASP.NET 2.0) to handle the new **TraceFinished** event.</span></span> <span data-ttu-id="e8c77-299">根据需要，然后可以循环访问的跟踪消息。</span><span class="sxs-lookup"><span data-stu-id="e8c77-299">You can then loop through the trace messages as you wish.</span></span>

<span data-ttu-id="e8c77-300">下面的代码示例阐释了这一点：</span><span class="sxs-lookup"><span data-stu-id="e8c77-300">The following code sample illustrates this:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample13.cs)]

<span data-ttu-id="e8c77-301">在上面的示例中，我 TraceRecords 集合中循环，然后将每条消息写入到响应流。</span><span class="sxs-lookup"><span data-stu-id="e8c77-301">In the above example, I loop through the TraceRecords collection and then write each message to the Response stream.</span></span>

## <a name="improved-application-level-tracing"></a><span data-ttu-id="e8c77-302">改进了应用程序级跟踪</span><span class="sxs-lookup"><span data-stu-id="e8c77-302">Improved Application-Level Tracing</span></span>

<span data-ttu-id="e8c77-303">通过引入新改进应用程序级跟踪**mostRecent**属性&lt;跟踪&gt;元素。</span><span class="sxs-lookup"><span data-stu-id="e8c77-303">Application-level tracing is improved via the introduction of the new **mostRecent** attribute of the &lt;trace&gt; element.</span></span> <span data-ttu-id="e8c77-304">此属性指定是否显示最新的应用程序级跟踪输出，由 requestLimit 限制以外的较旧的跟踪数据将被丢弃。</span><span class="sxs-lookup"><span data-stu-id="e8c77-304">This attribute specifies whether the most recent application-level tracing output is displayed and older trace data beyond the limits that are indicated by the requestLimit are discarded.</span></span> <span data-ttu-id="e8c77-305">如果为 false，跟踪数据将显示的请求，直到达到 requestLimit 属性。</span><span class="sxs-lookup"><span data-stu-id="e8c77-305">If false, trace data are displayed for requests until the requestLimit attribute is reached.</span></span>

## <a name="aspnet-command-line-tools"></a><span data-ttu-id="e8c77-306">ASP.NET 命令行工具</span><span class="sxs-lookup"><span data-stu-id="e8c77-306">ASP.NET Command Line Tools</span></span>

<span data-ttu-id="e8c77-307">有几个命令行工具，可帮助中的 ASP.NET 的配置。</span><span class="sxs-lookup"><span data-stu-id="e8c77-307">There are several command-line tools to aid in configuration of ASP.NET.</span></span> <span data-ttu-id="e8c77-308">ASP.NET 开发人员应熟悉 aspnet\_regiis.exe 工具。</span><span class="sxs-lookup"><span data-stu-id="e8c77-308">ASP.NET developers should be familiar with the aspnet\_regiis.exe tool.</span></span> <span data-ttu-id="e8c77-309">ASP.NET 2.0 提供了三个其他命令行工具，可帮助在配置中。</span><span class="sxs-lookup"><span data-stu-id="e8c77-309">ASP.NET 2.0 provides three other command-line tools to aid in configuration.</span></span>

<span data-ttu-id="e8c77-310">以下命令行工具有：</span><span class="sxs-lookup"><span data-stu-id="e8c77-310">The following command-line tools are available:</span></span>

| <span data-ttu-id="e8c77-311">**工具**</span><span class="sxs-lookup"><span data-stu-id="e8c77-311">**Tool**</span></span> | <span data-ttu-id="e8c77-312">**使用**</span><span class="sxs-lookup"><span data-stu-id="e8c77-312">**Use**</span></span> |
| --- | --- |
| <span data-ttu-id="e8c77-313">**aspnet\_regiis.exe**</span><span class="sxs-lookup"><span data-stu-id="e8c77-313">**aspnet\_regiis.exe**</span></span> | <span data-ttu-id="e8c77-314">允许注册 iis ASP.NET。</span><span class="sxs-lookup"><span data-stu-id="e8c77-314">Allows for registration of ASP.NET with IIS.</span></span> <span data-ttu-id="e8c77-315">有此工具的两个版本所附带 ASP.NET 2.0，32 位系统 （在框架文件夹中） 和 64 位系统 （在 Framework64 文件夹中。）未将在 32 位操作系统上安装 64 位版本。</span><span class="sxs-lookup"><span data-stu-id="e8c77-315">There are two versions of this tools that ship with ASP.NET 2.0, one for 32-bit systems (in the Framework folder) and one for 64-bit systems (in the Framework64 folder.) The 64-bit version will not be installed on a 32-bit OS.</span></span> |
| <span data-ttu-id="e8c77-316">**aspnet\_regsql.exe**</span><span class="sxs-lookup"><span data-stu-id="e8c77-316">**aspnet\_regsql.exe**</span></span> | <span data-ttu-id="e8c77-317">ASP.NET SQL 服务器注册工具用于在 ASP.NET 中，创建由 SQL Server 提供程序使用 Microsoft SQL Server 数据库，或用于添加或删除从现有数据库的选项。</span><span class="sxs-lookup"><span data-stu-id="e8c77-317">The ASP.NET SQL Server Registration tool is used to create a Microsoft SQL Server database for use by the SQL Server providers in ASP.NET, or to add or remove options from an existing database.</span></span> <span data-ttu-id="e8c77-318">Aspnet\_regsql.exe 文件位于 [drive:]\WINDOWS\Microsoft.NET\Framework\versionNumber Web 服务器上的文件夹。</span><span class="sxs-lookup"><span data-stu-id="e8c77-318">The Aspnet\_regsql.exe file is located in the [drive:]\WINDOWS\Microsoft.NET\Framework\versionNumber folder on your Web server.</span></span> |
| <span data-ttu-id="e8c77-319">**aspnet\_regbrowsers.exe**</span><span class="sxs-lookup"><span data-stu-id="e8c77-319">**aspnet\_regbrowsers.exe**</span></span> | <span data-ttu-id="e8c77-320">ASP.NET 浏览器注册工具分析和编译成一个程序集的所有系统级浏览器定义并将该程序集安装到全局程序集缓存。</span><span class="sxs-lookup"><span data-stu-id="e8c77-320">The ASP.NET Browser Registration tool parses and compiles all system-wide browser definitions into an assembly and installs the assembly into the global assembly cache.</span></span> <span data-ttu-id="e8c77-321">该工具使用浏览器定义文件 (。浏览器文件） 从.NET Framework 浏览器子目录。</span><span class="sxs-lookup"><span data-stu-id="e8c77-321">The tool uses the browser definition files (.BROWSER files) from the .NET Framework Browsers subdirectory.</span></span> <span data-ttu-id="e8c77-322">该工具可以 %SystemRoot%\Microsoft.NET\Framework\version\ 目录中找到。</span><span class="sxs-lookup"><span data-stu-id="e8c77-322">The tool can be found in the %SystemRoot%\Microsoft.NET\Framework\version\ directory.</span></span> |
| <span data-ttu-id="e8c77-323">**aspnet\_compiler.exe**</span><span class="sxs-lookup"><span data-stu-id="e8c77-323">**aspnet\_compiler.exe**</span></span> | <span data-ttu-id="e8c77-324">ASP.NET 编译工具，可编译的 ASP.NET Web 应用，就地或部署到目标位置，如生产服务器。</span><span class="sxs-lookup"><span data-stu-id="e8c77-324">The ASP.NET Compilation tool enables you to compile an ASP.NET Web application, either in place or for deployment to a target location such as a production server.</span></span> <span data-ttu-id="e8c77-325">就地编译有助于提高应用程序性能，因为最终用户不会遇到的延迟到应用程序的第一个请求时应用程序编译。</span><span class="sxs-lookup"><span data-stu-id="e8c77-325">In-place compilation helps application performance because end users do not encounter a delay on the first request to the application while the application is compiled.</span></span> |

<span data-ttu-id="e8c77-326">因为 aspnet\_regiis.exe 工具不熟悉 ASP.NET 2.0，此处我们将不讨论。</span><span class="sxs-lookup"><span data-stu-id="e8c77-326">Because the aspnet\_regiis.exe tool is not new to ASP.NET 2.0, we will not discuss it here.</span></span>

## <a name="aspnet-sql-server-registration-tool---aspnetregsqlexe"></a><span data-ttu-id="e8c77-327">ASP.NET SQL 服务器注册工具 aspnet\_regsql.exe</span><span class="sxs-lookup"><span data-stu-id="e8c77-327">ASP.NET SQL Server Registration Tool - aspnet\_regsql.exe</span></span>

<span data-ttu-id="e8c77-328">你可以设置多个类型的使用 ASP.NET SQL 服务器注册工具的选项。</span><span class="sxs-lookup"><span data-stu-id="e8c77-328">You can set several types of options using the ASP.NET SQL Server Registration tool.</span></span> <span data-ttu-id="e8c77-329">可以指定 SQL 连接、 指定的 ASP.NET 应用程序服务使用 SQL Server 来管理信息、 指示哪些数据库或表适用于 SQL 缓存依赖项，并添加或删除有关使用 SQL Server 存储过程和会话状态支持。</span><span class="sxs-lookup"><span data-stu-id="e8c77-329">You can specify a SQL connection, specify which ASP.NET application services use SQL Server to manage information, indicate which database or table is used for SQL cache dependency, and add or remove support for using SQL Server to store procedures and session state.</span></span>

<span data-ttu-id="e8c77-330">多个 ASP.NET 应用程序服务依赖于提供程序来管理存储和从数据源检索数据。</span><span class="sxs-lookup"><span data-stu-id="e8c77-330">Several ASP.NET application services rely on a provider to manage storing and retrieving data from a data source.</span></span> <span data-ttu-id="e8c77-331">每个提供程序是特定于数据源。</span><span class="sxs-lookup"><span data-stu-id="e8c77-331">Each provider is specific to the data source.</span></span> <span data-ttu-id="e8c77-332">ASP.NET 包括的 SQL Server 提供程序在以下 ASP.NET 功能：</span><span class="sxs-lookup"><span data-stu-id="e8c77-332">ASP.NET includes a SQL Server provider for the following ASP.NET features:</span></span>

- <span data-ttu-id="e8c77-333">成员资格 ( [SqlMembershipProvider](https://msdn.microsoft.com/library/system.web.security.sqlmembershipprovider.aspx)类)。</span><span class="sxs-lookup"><span data-stu-id="e8c77-333">Membership (the [SqlMembershipProvider](https://msdn.microsoft.com/library/system.web.security.sqlmembershipprovider.aspx) class).</span></span>
- <span data-ttu-id="e8c77-334">角色管理 ( [SqlRoleProvider](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx)类)。</span><span class="sxs-lookup"><span data-stu-id="e8c77-334">Role Management (the [SqlRoleProvider](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx) class).</span></span>
- <span data-ttu-id="e8c77-335">配置文件 ( [SqlProfileProvider](https://msdn.microsoft.com/library/system.web.profile.sqlprofileprovider.aspx)类)。</span><span class="sxs-lookup"><span data-stu-id="e8c77-335">Profile (the [SqlProfileProvider](https://msdn.microsoft.com/library/system.web.profile.sqlprofileprovider.aspx) class).</span></span>
- <span data-ttu-id="e8c77-336">Web 部件个性化设置 ( [SqlPersonalizationProvider](https://msdn.microsoft.com/library/system.web.ui.webcontrols.webparts.sqlpersonalizationprovider.aspx)类)。</span><span class="sxs-lookup"><span data-stu-id="e8c77-336">Web Parts Personalization (the [SqlPersonalizationProvider](https://msdn.microsoft.com/library/system.web.ui.webcontrols.webparts.sqlpersonalizationprovider.aspx) class).</span></span>
- <span data-ttu-id="e8c77-337">Web 事件 ( [SqlWebEventProvider](https://msdn.microsoft.com/library/system.web.management.sqlwebeventprovider.aspx)类)。</span><span class="sxs-lookup"><span data-stu-id="e8c77-337">Web Events (the [SqlWebEventProvider](https://msdn.microsoft.com/library/system.web.management.sqlwebeventprovider.aspx) class).</span></span>

<span data-ttu-id="e8c77-338">在安装 ASP.NET 时，你的服务器的 Machine.config 文件包括指定每个依赖于提供程序的 ASP.NET 功能的 SQL Server 提供程序的配置元素。</span><span class="sxs-lookup"><span data-stu-id="e8c77-338">When you install ASP.NET, the Machine.config file for your server includes configuration elements that specify SQL Server providers for each of the ASP.NET features that rely on a provider.</span></span> <span data-ttu-id="e8c77-339">这些提供程序配置，默认情况下，若要连接到 SQL Server Express 2005 的本地用户实例。</span><span class="sxs-lookup"><span data-stu-id="e8c77-339">These providers are configured, by default, to connect to a local user instance of SQL Server Express 2005.</span></span> <span data-ttu-id="e8c77-340">如果更改使用的提供程序的默认连接字符串，则你可以使用任何在计算机配置中，配置的 ASP.NET 功能之前必须安装 SQL Server 数据库和数据库元素针对使用 Aspnet你选功能\_regsql.exe。</span><span class="sxs-lookup"><span data-stu-id="e8c77-340">If you change the default connection string used by the providers, then before you can use any of the ASP.NET features configured in the machine configuration, you must install the SQL Server database and the database elements for your chosen feature using Aspnet\_regsql.exe.</span></span> <span data-ttu-id="e8c77-341">如果你使用 SQL 注册工具指定的数据库不存在 （aspnetdb 将默认数据库如果未指定命令行上），则当前用户必须具有在 SQL Server 以及采用创建架构 e 中创建数据库的权限在数据库中的元素。</span><span class="sxs-lookup"><span data-stu-id="e8c77-341">If the database that you specify with the SQL registration tool does not already exist (aspnetdb will be the default database if one is not specified on the command line), then the current user must have rights to create databases in SQL Server as well as to create schema elements within a database.</span></span>

### <a name="sql-cache-dependency"></a><span data-ttu-id="e8c77-342">SQL 缓存依赖项</span><span class="sxs-lookup"><span data-stu-id="e8c77-342">SQL Cache Dependency</span></span>

<span data-ttu-id="e8c77-343">一项高级的功能的 ASP.NET 输出缓存是 SQL 缓存依赖项。</span><span class="sxs-lookup"><span data-stu-id="e8c77-343">An advanced feature of ASP.NET output caching is SQL cache dependency.</span></span> <span data-ttu-id="e8c77-344">SQL 缓存依赖项支持两个不同的操作模式： 一个使用 ASP.NET 实现的表轮询间隔和使用 SQL Server 2005 的查询通知功能的第二个模式。</span><span class="sxs-lookup"><span data-stu-id="e8c77-344">SQL cache dependency supports two different modes of operation: one that uses an ASP.NET implementation of table polling and a second mode that uses the query notification features of SQL Server 2005.</span></span> <span data-ttu-id="e8c77-345">SQL 注册工具可以用于配置的表轮询操作模式。</span><span class="sxs-lookup"><span data-stu-id="e8c77-345">The SQL registration tool can be used to configure the table-polling mode of operation.</span></span>

### <a name="session-state"></a><span data-ttu-id="e8c77-346">会话状态</span><span class="sxs-lookup"><span data-stu-id="e8c77-346">Session State</span></span>

<span data-ttu-id="e8c77-347">默认情况下，在 ASP.NET 进程内的内存中存储会话状态的值和信息。</span><span class="sxs-lookup"><span data-stu-id="e8c77-347">By default, session state values and information are stored in memory within the ASP.NET process.</span></span> <span data-ttu-id="e8c77-348">或者，你可以在 SQL Server 数据库中，其中它可以由多个 Web 服务器共享存储会话数据。</span><span class="sxs-lookup"><span data-stu-id="e8c77-348">Alternatively, you can store session data in a SQL Server database, where it can be shared by multiple Web servers.</span></span> <span data-ttu-id="e8c77-349">如果你使用 SQL 注册工具的会话状态为指定的数据库不存在，当前用户必须有权在 SQL Server 以及创建一个数据库中的架构元素中创建数据库。</span><span class="sxs-lookup"><span data-stu-id="e8c77-349">If the database that you specify for session state with the SQL registration tool does not already exist, then the current user must have rights to create databases in SQL Server as well as to create schema elements within a database.</span></span> <span data-ttu-id="e8c77-350">如果数据库不存在，当前用户必须有权在现有的数据库中创建架构元素。</span><span class="sxs-lookup"><span data-stu-id="e8c77-350">If the database does exist, then the current user must have rights to create schema elements in the existing database.</span></span>

<span data-ttu-id="e8c77-351">若要安装在 SQL Server 会话状态数据库，运行 Aspnet\_regsql.exe 工具并提供使用命令的以下信息：</span><span class="sxs-lookup"><span data-stu-id="e8c77-351">To install the session state database on SQL Server, run the Aspnet\_regsql.exe tool and supply the following information with the command:</span></span>

- <span data-ttu-id="e8c77-352">SQL Server 的名称实例，请使用**-S**选项。</span><span class="sxs-lookup"><span data-stu-id="e8c77-352">The name of the SQL Server instance, using the **-S** option.</span></span>
- <span data-ttu-id="e8c77-353">具有运行 SQL Server 的计算机上创建数据库的权限的帐户登录凭据。</span><span class="sxs-lookup"><span data-stu-id="e8c77-353">The logon credentials for an account that has permission to create a database on a computer running SQL Server.</span></span> <span data-ttu-id="e8c77-354">使用**-E**选项以使用当前登录的用户，或使用**-U**选项以指定用户 ID，并使用**-P**选项以指定密码。</span><span class="sxs-lookup"><span data-stu-id="e8c77-354">Use the **-E** option to use the currently logged-on user, or use the **-U** option to specify a user ID along with the **-P** option to specify a password.</span></span>
- <span data-ttu-id="e8c77-355">**-Ssadd**命令行选项用于添加会话状态数据库。</span><span class="sxs-lookup"><span data-stu-id="e8c77-355">The **-ssadd** command-line option to add the session state database.</span></span>

<span data-ttu-id="e8c77-356">默认情况下，不能使用 Aspnet\_regsql.exe 工具在运行 SQL Server 2005 Express Edition 的计算机上安装的会话状态数据库。</span><span class="sxs-lookup"><span data-stu-id="e8c77-356">By default, you cannot use the Aspnet\_regsql.exe tool to install the session state database on a computer running SQL Server 2005 Express Edition.</span></span>

### <a name="the-aspnet-browser-registration-tool---aspnetregbrowsersexe"></a><span data-ttu-id="e8c77-357">ASP.NET 浏览器注册工具-aspnet\_regbrowsers.exe</span><span class="sxs-lookup"><span data-stu-id="e8c77-357">The ASP.NET Browser Registration Tool - aspnet\_regbrowsers.exe</span></span>

<span data-ttu-id="e8c77-358">在 ASP.NET 1.1 版中，Machine.config 文件包含名为一节&lt;browserCaps&gt;。</span><span class="sxs-lookup"><span data-stu-id="e8c77-358">In ASP.NET version 1.1, the Machine.config file contained a section called &lt;browserCaps&gt;.</span></span> <span data-ttu-id="e8c77-359">本部分包含一系列定义基于正则表达式的各种浏览器的配置的 XML 项。</span><span class="sxs-lookup"><span data-stu-id="e8c77-359">This section contained a series of XML entries that defined the configurations for various browsers based on a regular expression.</span></span> <span data-ttu-id="e8c77-360">Asp.net 版本 2.0 中，新。浏览器文件定义的特定浏览器使用 XML 项的参数。</span><span class="sxs-lookup"><span data-stu-id="e8c77-360">For ASP.NET version 2.0, a new .BROWSER file defines the parameters of a particular browser using XML entries.</span></span> <span data-ttu-id="e8c77-361">您添加新的浏览器上添加一个新的信息。浏览器文件复制到位于你的系统上的 %SystemRoot%\Microsoft.NET\Framework\version\CONFIG\Browsers 的文件夹。</span><span class="sxs-lookup"><span data-stu-id="e8c77-361">You add information on a new browser by adding a new .BROWSER file to the folder located at %SystemRoot%\Microsoft.NET\Framework\version\CONFIG\Browsers on your system.</span></span>

<span data-ttu-id="e8c77-362">由于应用程序没有读取.config 文件每次它需要浏览器信息时，你可以创建一个新。浏览器文件和运行的 Aspnet\_regbrowsers.exe 将所需的更改添加到程序集。</span><span class="sxs-lookup"><span data-stu-id="e8c77-362">Because an application is not reading a .config file every time it requires browser information, you can create a new .BROWSER file and run Aspnet\_regbrowsers.exe to add the required changes to the assembly.</span></span> <span data-ttu-id="e8c77-363">这允许服务器立即访问新的浏览器信息，因此不需要关闭任何应用程序以拾取信息。</span><span class="sxs-lookup"><span data-stu-id="e8c77-363">This allows the server to access the new browser information immediately so you do not have to shut down any of your applications to pick up the information.</span></span> <span data-ttu-id="e8c77-364">应用程序可以访问通过当前 HttpRequest 的浏览器属性浏览器功能。</span><span class="sxs-lookup"><span data-stu-id="e8c77-364">An application can access browser capabilities through the Browser property of the current HttpRequest.</span></span>

<span data-ttu-id="e8c77-365">运行 aspnet 时，还提供以下选项\_regbrowser.exe:</span><span class="sxs-lookup"><span data-stu-id="e8c77-365">The following options are available when running aspnet\_regbrowser.exe:</span></span>

| <span data-ttu-id="e8c77-366">**选项**</span><span class="sxs-lookup"><span data-stu-id="e8c77-366">**Option**</span></span> | <span data-ttu-id="e8c77-367">**说明**</span><span class="sxs-lookup"><span data-stu-id="e8c77-367">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="e8c77-368">**-?**</span><span class="sxs-lookup"><span data-stu-id="e8c77-368">**-?**</span></span> | <span data-ttu-id="e8c77-369">显示 Aspnet\_regbbrowsers.exe 命令窗口中的帮助文本。</span><span class="sxs-lookup"><span data-stu-id="e8c77-369">Displays the Aspnet\_regbbrowsers.exe Help text in the command window.</span></span> |
| <span data-ttu-id="e8c77-370">**-i**</span><span class="sxs-lookup"><span data-stu-id="e8c77-370">**-i**</span></span> | <span data-ttu-id="e8c77-371">创建运行时浏览器功能程序集并将其安装在全局程序集缓存。</span><span class="sxs-lookup"><span data-stu-id="e8c77-371">Creates the runtime browser capabilities assembly and installs it in the global assembly cache.</span></span> |
| <span data-ttu-id="e8c77-372">**-u**</span><span class="sxs-lookup"><span data-stu-id="e8c77-372">**-u**</span></span> | <span data-ttu-id="e8c77-373">从全局程序集缓存中卸载的运行时浏览器功能程序集。</span><span class="sxs-lookup"><span data-stu-id="e8c77-373">Uninstalls the runtime browser capabilities assembly from the global assembly cache.</span></span> |

## <a name="the-aspnet-compilation-tool---aspnetcompilerexe"></a><span data-ttu-id="e8c77-374">ASP.NET 编译工具-aspnet\_compiler.exe</span><span class="sxs-lookup"><span data-stu-id="e8c77-374">The ASP.NET Compilation Tool - aspnet\_compiler.exe</span></span>

<span data-ttu-id="e8c77-375">ASP.NET 编译工具可以使用两种常规方式： 进行就地编译和部署，其中指定目标输出目录的编译。</span><span class="sxs-lookup"><span data-stu-id="e8c77-375">The ASP.NET Compilation tool can be used in two general ways: for in-place compilation and compilation for deployment, where a target output directory is specified.</span></span>

### <a name="compiling-an-application-in-placehttpsmsdnmicrosoftcomlibraryms229863aspx"></a>[<span data-ttu-id="e8c77-376">编译位置中的应用程序</span><span class="sxs-lookup"><span data-stu-id="e8c77-376">Compiling an Application in Place</span></span>](https://msdn.microsoft.com/library/ms229863.aspx)

<span data-ttu-id="e8c77-377">ASP.NET 编译工具可以编译位置中的应用程序，即，它模仿的应用程序，从而导致正则编译发出多个请求的行为。</span><span class="sxs-lookup"><span data-stu-id="e8c77-377">The ASP.NET Compilation tool can compile an application in place, that is, it mimics the behavior of making multiple requests to the application, thus causing regular compilation.</span></span> <span data-ttu-id="e8c77-378">预编译网站的用户不会通过编译上第一次请求的页面而导致的延迟。</span><span class="sxs-lookup"><span data-stu-id="e8c77-378">Users of a pre-compiled site will not experience a delay caused by compiling the page on first request.</span></span>

<span data-ttu-id="e8c77-379">当你进行预编译的位置中的站点时，应该注意下列事项：</span><span class="sxs-lookup"><span data-stu-id="e8c77-379">When you precompile a site in place, the following items apply:</span></span>

- <span data-ttu-id="e8c77-380">站点将保留其文件和目录结构。</span><span class="sxs-lookup"><span data-stu-id="e8c77-380">The site retains its files and directory structure.</span></span>
- <span data-ttu-id="e8c77-381">你必须使用的服务器上的站点的所有编程语言的编译器。</span><span class="sxs-lookup"><span data-stu-id="e8c77-381">You must have compilers for all programming languages used by the site on the server.</span></span>
- <span data-ttu-id="e8c77-382">如果任何文件的编译将失败，整个站点编译将失败。</span><span class="sxs-lookup"><span data-stu-id="e8c77-382">If any file fails compilation, the entire site fails compilation.</span></span>

<span data-ttu-id="e8c77-383">你可以重新编译应用程序就地后向其添加新的源文件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-383">You can also recompile an application in place after adding new source files to it.</span></span> <span data-ttu-id="e8c77-384">此工具将编译仅将新的或更改的文件，除非你包括**-c**选项。</span><span class="sxs-lookup"><span data-stu-id="e8c77-384">The tool compiles only the new or changed files unless you include the **-c** option.</span></span>

> [!NOTE]
> <span data-ttu-id="e8c77-385">编译的应用程序包含嵌套的应用程序不编译嵌套的应用程序。</span><span class="sxs-lookup"><span data-stu-id="e8c77-385">Compilation of an application that contains a nested application does not compile the nested application.</span></span> <span data-ttu-id="e8c77-386">必须单独编译嵌套的应用程序。</span><span class="sxs-lookup"><span data-stu-id="e8c77-386">The nested application must be compiled separately.</span></span>


### <a name="compiling-an-application-for-deploymenthttpsmsdnmicrosoftcomlibraryms229863aspx"></a>[<span data-ttu-id="e8c77-387">编译为部署的应用程序</span><span class="sxs-lookup"><span data-stu-id="e8c77-387">Compiling an Application for Deployment</span></span>](https://msdn.microsoft.com/library/ms229863.aspx)

<span data-ttu-id="e8c77-388">通过指定 targetDir 参数编译的应用程序部署 （编译到的目标位置）。</span><span class="sxs-lookup"><span data-stu-id="e8c77-388">You compile an application for deployment (compilation to a target location) by specifying the targetDir parameter.</span></span> <span data-ttu-id="e8c77-389">TargetDir 可以对 Web 应用程序的最终位置，也可以进一步部署编译的应用程序。</span><span class="sxs-lookup"><span data-stu-id="e8c77-389">The targetDir can be the final location for the Web application, or the compiled application can be further deployed.</span></span> <span data-ttu-id="e8c77-390">使用**-u**选项编译的方式，你可以无需重新编译它，编译的应用程序中的某些文件进行更改的应用程序。</span><span class="sxs-lookup"><span data-stu-id="e8c77-390">Using the **-u** option compiles the application in such a way that you can make changes to certain files in the compiled application without recompiling it.</span></span> <span data-ttu-id="e8c77-391">Aspnet\_compiler.exe 进行静态和动态文件类型之间的差异，并创建生成的应用程序时以不同方式处理它们。</span><span class="sxs-lookup"><span data-stu-id="e8c77-391">Aspnet\_compiler.exe makes a distinction between static and dynamic file types, and handles them differently when creating the resulting application.</span></span>

- <span data-ttu-id="e8c77-392">静态文件类型是指没有关联的编译器或生成提供程序，如文件的那些命名具有如.css、.gif、.htm、.html、.jpg、.js 的扩展，依此类推。</span><span class="sxs-lookup"><span data-stu-id="e8c77-392">Static file types are those that do not have an associated compiler or build provider, such as files whose named have extensions such as .css, .gif, .htm, .html, .jpg, .js and so on.</span></span> <span data-ttu-id="e8c77-393">这些文件只需复制到目标位置，并且它们保留的目录结构中的相对位置。</span><span class="sxs-lookup"><span data-stu-id="e8c77-393">These files are simply copied to the target location, with their relative places in the directory structure preserved.</span></span>
- <span data-ttu-id="e8c77-394">动态文件类型是指那些具有关联的编译器或生成提供程序，包括具有特定于 ASP.NET 等.asax、.ascx、.ashx、.aspx、.browser、.master，文件扩展名的文件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-394">Dynamic file types are those that have an associated compiler or build provider, including files with ASP.NET-specific file name extensions such as .asax, .ascx, .ashx, .aspx, .browser, .master, and so on.</span></span> <span data-ttu-id="e8c77-395">ASP.NET 编译工具从这些文件中生成程序集。</span><span class="sxs-lookup"><span data-stu-id="e8c77-395">The ASP.NET Compilation tool generates assemblies from these files.</span></span> <span data-ttu-id="e8c77-396">如果**-u**省略选项，该工具还会创建文件的文件扩展名。映射到其程序集的原始源文件的编译。</span><span class="sxs-lookup"><span data-stu-id="e8c77-396">If the **-u** option is omitted, the tool also creates files with the file name extension .COMPILED that map the original source files to their assembly.</span></span> <span data-ttu-id="e8c77-397">若要确保保留应用程序源的目录结构，该工具，请生成目标应用程序中的相应位置中的占位符文件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-397">To ensure that the directory structure of the application source is preserved, the tool generates placeholder files in the corresponding locations in the target application.</span></span>

<span data-ttu-id="e8c77-398">必须使用**-u**选项以指示是否可以修改已编译应用程序的内容。</span><span class="sxs-lookup"><span data-stu-id="e8c77-398">You must use the **-u** option to indicate that the content of the compiled application can be modified.</span></span> <span data-ttu-id="e8c77-399">否则为后续的修改将被忽略，或导致运行时错误。</span><span class="sxs-lookup"><span data-stu-id="e8c77-399">Otherwise, subsequent modifications are ignored or cause run-time errors.</span></span>

<span data-ttu-id="e8c77-400">下表描述了如何将 ASP.NET 编译工具处理不同的文件类型时**-u**已包含选项。</span><span class="sxs-lookup"><span data-stu-id="e8c77-400">The following table describes how the ASP.NET Compilation tool handles different file types when the **-u** option is included.</span></span>

| <span data-ttu-id="e8c77-401">**文件类型**</span><span class="sxs-lookup"><span data-stu-id="e8c77-401">**File type**</span></span> | <span data-ttu-id="e8c77-402">**编译器操作**</span><span class="sxs-lookup"><span data-stu-id="e8c77-402">**Compiler action**</span></span> |
| --- | --- |
| <span data-ttu-id="e8c77-403">.ascx, .aspx, .master</span><span class="sxs-lookup"><span data-stu-id="e8c77-403">.ascx, .aspx, .master</span></span> | <span data-ttu-id="e8c77-404">这些文件将被拆分为标记和源的代码，其中包括代码隐藏文件和任何代码都括在&lt;脚本 runat ="server"&gt;元素。</span><span class="sxs-lookup"><span data-stu-id="e8c77-404">These files are split into markup and source code, which includes both code-behind files and any code that is enclosed in &lt;script runat="server"&gt; elements.</span></span> <span data-ttu-id="e8c77-405">源代码编译到程序集中，使用派生自哈希算法的名称和程序集放置在 Bin 目录中。</span><span class="sxs-lookup"><span data-stu-id="e8c77-405">Source code is compiled into assemblies, with names that are derived from a hashing algorithm, and the assemblies are placed in the Bin directory.</span></span> <span data-ttu-id="e8c77-406">任何内联代码，即，代码括**&lt; %**和**% &gt;**方括号，附带标记，不进行编译。</span><span class="sxs-lookup"><span data-stu-id="e8c77-406">Any inline code, that is, code enclosed between the **&lt;%** and **%&gt;** brackets, is included with markup and not compiled.</span></span> <span data-ttu-id="e8c77-407">与源文件同名的新文件进行创建以包含标记，并在相应的输出目录中放入。</span><span class="sxs-lookup"><span data-stu-id="e8c77-407">New files with the same name as the source files are created to contain the markup and placed in the corresponding output directories.</span></span> |
| <span data-ttu-id="e8c77-408">.ashx、.asmx</span><span class="sxs-lookup"><span data-stu-id="e8c77-408">.ashx, .asmx</span></span> | <span data-ttu-id="e8c77-409">这些文件不进行编译，移动到输出目录，只要是，不进行编译。</span><span class="sxs-lookup"><span data-stu-id="e8c77-409">These files are not compiled and are moved to the output directories as is and not compiled.</span></span> <span data-ttu-id="e8c77-410">如果你想要具有编译的处理程序代码，将代码放入应用程序中的源代码文件\_代码目录。</span><span class="sxs-lookup"><span data-stu-id="e8c77-410">If you wish to have the handler code compiled, place the code into source code files in the App\_Code directory.</span></span> |
| <span data-ttu-id="e8c77-411">.cs、.vb、.jsl、.cpp （不包括前面列出的文件类型的代码隐藏文件）</span><span class="sxs-lookup"><span data-stu-id="e8c77-411">.cs, .vb, .jsl, .cpp (not including code-behind files for the file types listed earlier)</span></span> | <span data-ttu-id="e8c77-412">编译并在它们引用的程序集作为资源包括这些文件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-412">These files are compiled and included as a resource in assemblies that reference them.</span></span> <span data-ttu-id="e8c77-413">源文件不复制到输出目录中。</span><span class="sxs-lookup"><span data-stu-id="e8c77-413">Source files are not copied to the output directory.</span></span> <span data-ttu-id="e8c77-414">如果未引用代码文件，则它不会编译。</span><span class="sxs-lookup"><span data-stu-id="e8c77-414">If a code file is not referenced, it is not compiled.</span></span> |
| <span data-ttu-id="e8c77-415">自定义的文件类型</span><span class="sxs-lookup"><span data-stu-id="e8c77-415">Custom file types</span></span> | <span data-ttu-id="e8c77-416">这些文件不会编译。</span><span class="sxs-lookup"><span data-stu-id="e8c77-416">These files are not compiled.</span></span> <span data-ttu-id="e8c77-417">这些文件复制到相应的输出目录。</span><span class="sxs-lookup"><span data-stu-id="e8c77-417">These files are copied to the corresponding output directories.</span></span> |
| <span data-ttu-id="e8c77-418">源应用程序中的代码文件\_Code 子目录</span><span class="sxs-lookup"><span data-stu-id="e8c77-418">Source code files in the App\_Code subdirectory</span></span> | <span data-ttu-id="e8c77-419">这些文件进行编译到程序集中，并放入的 Bin 目录中。</span><span class="sxs-lookup"><span data-stu-id="e8c77-419">These files are compiled into assemblies and placed in the Bin directory.</span></span> |
| <span data-ttu-id="e8c77-420">在应用程序的.resx 和.resource 文件\_GlobalResources 子目录</span><span class="sxs-lookup"><span data-stu-id="e8c77-420">.resx and .resource files in the App\_GlobalResources subdirectory</span></span> | <span data-ttu-id="e8c77-421">这些文件进行编译到程序集中，并放入的 Bin 目录中。</span><span class="sxs-lookup"><span data-stu-id="e8c77-421">These files are compiled into assemblies and placed in the Bin directory.</span></span> <span data-ttu-id="e8c77-422">任何应用程序\_GlobalResources 子目录下的主输出目录中，创建并将位于源目录没有.resx 或.resources 文件复制到输出目录。</span><span class="sxs-lookup"><span data-stu-id="e8c77-422">No App\_GlobalResources subdirectory is created under the main output directory, and no .resx or .resources files located in the source directory are copied to the output directories.</span></span> |
| <span data-ttu-id="e8c77-423">在应用程序的.resx 和.resource 文件\_LocalResources 子目录</span><span class="sxs-lookup"><span data-stu-id="e8c77-423">.resx and .resource files in the App\_LocalResources subdirectory</span></span> | <span data-ttu-id="e8c77-424">这些文件不编译并复制到相应的输出目录。</span><span class="sxs-lookup"><span data-stu-id="e8c77-424">These files are not compiled and are copied to the corresponding output directories.</span></span> |
| <span data-ttu-id="e8c77-425">在应用程序的.skin 文件\_主题子目录</span><span class="sxs-lookup"><span data-stu-id="e8c77-425">.skin files in the App\_Themes subdirectory</span></span> | <span data-ttu-id="e8c77-426">.Skin 文件和静态主题文件不进行编译，复制到相应的输出目录。</span><span class="sxs-lookup"><span data-stu-id="e8c77-426">The .skin files and static theme files are not compiled and are copied to the corresponding output directories.</span></span> |
| <span data-ttu-id="e8c77-427">.browser Web.config 静态文件类型的 Bin 目录中已存在的程序集</span><span class="sxs-lookup"><span data-stu-id="e8c77-427">.browser Web.config Static file types Assemblies already present in the Bin directory</span></span> | <span data-ttu-id="e8c77-428">这些文件复制到输出目录。</span><span class="sxs-lookup"><span data-stu-id="e8c77-428">These files are copied as is to the output directories.</span></span> |

<span data-ttu-id="e8c77-429">下表描述了如何将 ASP.NET 编译工具处理不同的文件类型时**-u**省略选项。</span><span class="sxs-lookup"><span data-stu-id="e8c77-429">The following table describes how the ASP.NET Compilation tool handles different file types when the **-u** option is omitted.</span></span>

| <span data-ttu-id="e8c77-430">**文件类型**</span><span class="sxs-lookup"><span data-stu-id="e8c77-430">**File type**</span></span> | <span data-ttu-id="e8c77-431">**编译器操作**</span><span class="sxs-lookup"><span data-stu-id="e8c77-431">**Compiler action**</span></span> |
| --- | --- |
| <span data-ttu-id="e8c77-432">.aspx、.asmx、.ashx、.master</span><span class="sxs-lookup"><span data-stu-id="e8c77-432">.aspx, .asmx, .ashx, .master</span></span> | <span data-ttu-id="e8c77-433">这些文件将被拆分为标记和源的代码，其中包括代码隐藏文件和任何代码都括在&lt;脚本 runat ="server"&gt;元素。</span><span class="sxs-lookup"><span data-stu-id="e8c77-433">These files are split into markup and source code, which includes both code-behind files and any code that is enclosed in &lt;script runat="server"&gt; elements.</span></span> <span data-ttu-id="e8c77-434">源代码会编译成程序集，使用派生自哈希算法的名称。</span><span class="sxs-lookup"><span data-stu-id="e8c77-434">Source code is compiled into assemblies, with names that are derived from a hashing algorithm.</span></span> <span data-ttu-id="e8c77-435">生成的程序集放置在 Bin 目录中。</span><span class="sxs-lookup"><span data-stu-id="e8c77-435">The resulting assemblies are placed in the Bin directory.</span></span> <span data-ttu-id="e8c77-436">任何内联代码，即，代码括**&lt; %**和**% &gt;**方括号，附带标记，不进行编译。</span><span class="sxs-lookup"><span data-stu-id="e8c77-436">Any inline code, that is, code enclosed between the **&lt;%** and **%&gt;** brackets, is included with markup and not compiled.</span></span> <span data-ttu-id="e8c77-437">编译器将创建新文件以包含与源文件同名的标记。</span><span class="sxs-lookup"><span data-stu-id="e8c77-437">The compiler creates new files to contain the markup with the same name as the source files.</span></span> <span data-ttu-id="e8c77-438">这些生成的文件放置在 Bin 目录中。</span><span class="sxs-lookup"><span data-stu-id="e8c77-438">These resulting files are placed in the Bin directory.</span></span> <span data-ttu-id="e8c77-439">具有与源文件相同名称但扩展名为，编译器还会创建文件。包含的映射信息的编译。</span><span class="sxs-lookup"><span data-stu-id="e8c77-439">The compiler also creates files with the same name as the source files but with the extension .COMPILED that contain mapping information.</span></span> <span data-ttu-id="e8c77-440">。已编译的文件放置在源代码文件的原始位置所对应的输出目录。</span><span class="sxs-lookup"><span data-stu-id="e8c77-440">The .COMPILED files are placed in the output directories corresponding to the original location of the source files.</span></span> |
| <span data-ttu-id="e8c77-441">.ascx</span><span class="sxs-lookup"><span data-stu-id="e8c77-441">.ascx</span></span> | <span data-ttu-id="e8c77-442">这些文件被拆分为标记和源代码。</span><span class="sxs-lookup"><span data-stu-id="e8c77-442">These files are split into markup and source code.</span></span> <span data-ttu-id="e8c77-443">源代码编译到程序集和放置在 Bin 目录中，使用派生自哈希算法的名称。</span><span class="sxs-lookup"><span data-stu-id="e8c77-443">Source code is compiled into assemblies and placed in the Bin directory, with names that are derived from a hashing algorithm.</span></span> <span data-ttu-id="e8c77-444">生成没有标记文件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-444">No markup files are generated.</span></span> |
| <span data-ttu-id="e8c77-445">.cs、.vb、.jsl、.cpp （不包括前面列出的文件类型的代码隐藏文件）</span><span class="sxs-lookup"><span data-stu-id="e8c77-445">.cs, .vb, .jsl, .cpp (not including code-behind files for the file types listed earlier)</span></span> | <span data-ttu-id="e8c77-446">从.ascx、.ashx 或.aspx 文件生成的程序集引用的源代码是编译为程序集并放置在 Bin 目录中。</span><span class="sxs-lookup"><span data-stu-id="e8c77-446">Source code that is referenced by the assemblies generated from .ascx, .ashx, or .aspx files is compiled into assemblies and placed in the Bin directory.</span></span> <span data-ttu-id="e8c77-447">不源复制文件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-447">No source files are copied.</span></span> |
| <span data-ttu-id="e8c77-448">自定义的文件类型</span><span class="sxs-lookup"><span data-stu-id="e8c77-448">Custom file types</span></span> | <span data-ttu-id="e8c77-449">像动态文件一样，这些文件进行编译。</span><span class="sxs-lookup"><span data-stu-id="e8c77-449">These files are compiled like dynamic files.</span></span> <span data-ttu-id="e8c77-450">具体取决于其所基于的文件的类型，编译器可以在输出目录中放置映射文件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-450">Depending on the type of file they are based on, the compiler can place mapping files in the output directories.</span></span> |
| <span data-ttu-id="e8c77-451">在应用程序的文件\_Code 子目录</span><span class="sxs-lookup"><span data-stu-id="e8c77-451">Files in the App\_Code subdirectory</span></span> | <span data-ttu-id="e8c77-452">此子目录中的源代码文件进行编译到程序集中，并放入的 Bin 目录中。</span><span class="sxs-lookup"><span data-stu-id="e8c77-452">Source code files in this subdirectory are compiled into assemblies and placed in the Bin directory.</span></span> |
| <span data-ttu-id="e8c77-453">在应用程序的文件\_GlobalResources 子目录</span><span class="sxs-lookup"><span data-stu-id="e8c77-453">Files in the App\_GlobalResources subdirectory</span></span> | <span data-ttu-id="e8c77-454">这些文件进行编译到程序集中，并放入的 Bin 目录中。</span><span class="sxs-lookup"><span data-stu-id="e8c77-454">These files are compiled into assemblies and placed in the Bin directory.</span></span> <span data-ttu-id="e8c77-455">任何应用程序\_在主输出目录下创建 GlobalResources 子目录。</span><span class="sxs-lookup"><span data-stu-id="e8c77-455">No App\_GlobalResources subdirectory is created under the main output directory.</span></span> <span data-ttu-id="e8c77-456">如果配置文件指定 appliesTo ="All"，.resx 和.resources 文件复制到输出目录。</span><span class="sxs-lookup"><span data-stu-id="e8c77-456">If the configuration file specifies appliesTo="All", .resx and .resources files are copied to the output directories.</span></span> <span data-ttu-id="e8c77-457">因此不会复制如果它们由引用[BuildProvider](https://msdn.microsoft.com/library/system.web.configuration.buildprovider.aspx)。</span><span class="sxs-lookup"><span data-stu-id="e8c77-457">They are not copied if they are referenced by a [BuildProvider](https://msdn.microsoft.com/library/system.web.configuration.buildprovider.aspx).</span></span> |
| <span data-ttu-id="e8c77-458">在应用程序的.resx 和.resource 文件\_LocalResources 子目录</span><span class="sxs-lookup"><span data-stu-id="e8c77-458">.resx and .resource files in the App\_LocalResources subdirectory</span></span> | <span data-ttu-id="e8c77-459">这些文件进行编译到程序集中具有唯一名称，并放入的 Bin 目录中。</span><span class="sxs-lookup"><span data-stu-id="e8c77-459">These files are compiled into assemblies with unique names and placed in the Bin directory.</span></span> <span data-ttu-id="e8c77-460">没有文件.resx 或.resource 文件将复制到输出目录。</span><span class="sxs-lookup"><span data-stu-id="e8c77-460">No .resx or .resource files are copied to the output directories.</span></span> |
| <span data-ttu-id="e8c77-461">在应用程序的.skin 文件\_主题子目录</span><span class="sxs-lookup"><span data-stu-id="e8c77-461">.skin files in the App\_Themes subdirectory</span></span> | <span data-ttu-id="e8c77-462">主题进行编译到程序集中，并放入的 Bin 目录中。</span><span class="sxs-lookup"><span data-stu-id="e8c77-462">Themes are compiled into assemblies and placed in the Bin directory.</span></span> <span data-ttu-id="e8c77-463">存根 （stub） 文件进行为.skin 文件创建并放入相应的输出目录中。</span><span class="sxs-lookup"><span data-stu-id="e8c77-463">Stub files are created for .skin files and placed in the corresponding output directory.</span></span> <span data-ttu-id="e8c77-464">（如.css) 的静态文件将复制到输出目录。</span><span class="sxs-lookup"><span data-stu-id="e8c77-464">Static files (such as .css) are copied to the output directories.</span></span> |
| <span data-ttu-id="e8c77-465">.browser Web.config 静态文件类型的 Bin 目录中已存在的程序集</span><span class="sxs-lookup"><span data-stu-id="e8c77-465">.browser Web.config Static file types Assemblies already present in the Bin directory</span></span> | <span data-ttu-id="e8c77-466">这些文件复制到输出目录。</span><span class="sxs-lookup"><span data-stu-id="e8c77-466">These files are copied as is to the output directory.</span></span> |

### <a name="fixed-assembly-nameshttpsmsdnmicrosoftcomlibraryms229863aspx"></a>[<span data-ttu-id="e8c77-467">固定的程序集名称</span><span class="sxs-lookup"><span data-stu-id="e8c77-467">Fixed Assembly Names</span></span>](https://msdn.microsoft.com/library/ms229863.aspx##)

<span data-ttu-id="e8c77-468">某些情况下，如部署 Web 应用程序使用 MSI Windows 安装程序，需要使用一致的文件名称和内容，以及一致的目录结构，以确定程序集或更新的配置设置。</span><span class="sxs-lookup"><span data-stu-id="e8c77-468">Some scenarios, such as deploying a Web application using the MSI Windows Installer, require the use of consistent file names and contents, as well as consistent directory structures to identify assemblies or configuration settings for updates.</span></span> <span data-ttu-id="e8c77-469">在这些情况下，你可以使用**-fixednames**选项以指定 ASP.NET 编译工具应编译的程序集的每个源文件而不是使用 where 多页被编译到程序集。</span><span class="sxs-lookup"><span data-stu-id="e8c77-469">In those cases, you can use the **-fixednames** option to specify that the ASP.NET Compilation tool should compile an assembly for each source file instead of using the where multiple pages are compiled into assemblies.</span></span> <span data-ttu-id="e8c77-470">这可能会导致大量的程序集，因此如果您担心可伸缩性应小心使用此选项。</span><span class="sxs-lookup"><span data-stu-id="e8c77-470">This can lead to a large number of assemblies, so if you are concerned with scalability you should use this option with caution.</span></span>

### <a name="strong-name-compilationhttpsmsdnmicrosoftcomlibraryms229863aspx"></a>[<span data-ttu-id="e8c77-471">强名称编译</span><span class="sxs-lookup"><span data-stu-id="e8c77-471">Strong-Name Compilation</span></span>](https://msdn.microsoft.com/library/ms229863.aspx##)

<span data-ttu-id="e8c77-472">**-Aptca**， **-delaysign**， **-keycontainer**和**-keyfile**选项提供，以便你可以使用 Aspnet\_compiler.exe 创建强命名程序集而无需使用[强名称工具 (Sn.exe)](https://msdn.microsoft.com/library/k5b5tt23.aspx)单独。</span><span class="sxs-lookup"><span data-stu-id="e8c77-472">The **-aptca**, **-delaysign**, **-keycontainer** and **-keyfile** options are provided so that you can use Aspnet\_compiler.exe to create strongly named assemblies without using the [Strong Name Tool (Sn.exe)](https://msdn.microsoft.com/library/k5b5tt23.aspx) separately.</span></span> <span data-ttu-id="e8c77-473">这些选项，分别对应到**AllowPartiallyTrustedCallersAttribute**， **AssemblyDelaySignAttribute**， **AssemblyKeyNameAttribute**，和**AssemblyKeyFileAttribute**。</span><span class="sxs-lookup"><span data-stu-id="e8c77-473">These options correspond, respectively, to **AllowPartiallyTrustedCallersAttribute**, **AssemblyDelaySignAttribute**, **AssemblyKeyNameAttribute**, and **AssemblyKeyFileAttribute**.</span></span>

<span data-ttu-id="e8c77-474">讨论这些属性是本课程的范围之外。</span><span class="sxs-lookup"><span data-stu-id="e8c77-474">Discussion of these attributes is outside of the scope of this course.</span></span>

## <a name="labs"></a><span data-ttu-id="e8c77-475">实验室</span><span class="sxs-lookup"><span data-stu-id="e8c77-475">Labs</span></span>

<span data-ttu-id="e8c77-476">每个以下的实验室基于以前实验室。</span><span class="sxs-lookup"><span data-stu-id="e8c77-476">Each of the following labs builds on the previous labs.</span></span> <span data-ttu-id="e8c77-477">你将需要按顺序执行这些操作。</span><span class="sxs-lookup"><span data-stu-id="e8c77-477">You will need to do them in order.</span></span>

## <a name="lab-1-using-the-configuration-api"></a><span data-ttu-id="e8c77-478">实验室 1： 使用配置 API</span><span class="sxs-lookup"><span data-stu-id="e8c77-478">Lab 1: Using the Configuration API</span></span>

1. <span data-ttu-id="e8c77-479">创建新的网站名*mod9lab*。</span><span class="sxs-lookup"><span data-stu-id="e8c77-479">Create a new Web site called *mod9lab*.</span></span>
2. <span data-ttu-id="e8c77-480">将新的 Web 配置文件添加到站点。</span><span class="sxs-lookup"><span data-stu-id="e8c77-480">Add a new Web Configuration File to the site.</span></span>
3. <span data-ttu-id="e8c77-481">将以下代码添加到 web.config 文件：</span><span class="sxs-lookup"><span data-stu-id="e8c77-481">Add the following to the web.config file:</span></span>


[!code-xml[Main](configuration-and-instrumentation/samples/sample14.xml)]

<span data-ttu-id="e8c77-482">这将确保您有权将更改保存到 web.config 文件。</span><span class="sxs-lookup"><span data-stu-id="e8c77-482">This will ensure that you have permission to save changes to the web.config file.</span></span>

1. <span data-ttu-id="e8c77-483">将新的标签控件添加到 Default.aspx 并将 ID 更改为**lblDebugStatus**。</span><span class="sxs-lookup"><span data-stu-id="e8c77-483">Add a new Label control to Default.aspx and change the ID to **lblDebugStatus**.</span></span>
2. <span data-ttu-id="e8c77-484">将新的按钮控件添加到 Default.aspx。</span><span class="sxs-lookup"><span data-stu-id="e8c77-484">Add a new Button control to Default.aspx.</span></span>
3. <span data-ttu-id="e8c77-485">按钮控件将 ID 更改为**btnToggleDebug**和到文本**切换调试状态**。</span><span class="sxs-lookup"><span data-stu-id="e8c77-485">Change the Button control's ID to **btnToggleDebug** and the Text to **Toggle Debug Status**.</span></span>
4. <span data-ttu-id="e8c77-486">打开 Default.aspx 的代码隐藏文件的代码视图并添加**使用**语句**System.Web.Configuration** ，如下所示：</span><span class="sxs-lookup"><span data-stu-id="e8c77-486">Open the Code View for the code-behind file of Default.aspx and add a **using** statement for **System.Web.Configuration** as follows:</span></span>


[!code-csharp[Main](configuration-and-instrumentation/samples/sample15.cs)]

1. <span data-ttu-id="e8c77-487">将两个私有变量添加到类，另一个页面\_Init 方法如下所示：</span><span class="sxs-lookup"><span data-stu-id="e8c77-487">Add two private variables to the class and a Page\_Init method as shown below:</span></span>


[!code-csharp[Main](configuration-and-instrumentation/samples/sample16.cs)]

1. <span data-ttu-id="e8c77-488">将以下代码添加到页\_负载：</span><span class="sxs-lookup"><span data-stu-id="e8c77-488">Add the following code to Page\_Load:</span></span>


[!code-csharp[Main](configuration-and-instrumentation/samples/sample17.cs)]

1. <span data-ttu-id="e8c77-489">保存并浏览 default.aspx。</span><span class="sxs-lookup"><span data-stu-id="e8c77-489">Save and browse default.aspx.</span></span> <span data-ttu-id="e8c77-490">请注意标签控件显示的当前的调试状态。</span><span class="sxs-lookup"><span data-stu-id="e8c77-490">Notice that the Label control displays the current debug status.</span></span>
2. <span data-ttu-id="e8c77-491">双击按钮控件设计器中，将以下代码添加到按钮控件的单击事件：</span><span class="sxs-lookup"><span data-stu-id="e8c77-491">Double-click on the Button control in the designer and add the following code to the Click event for the Button control:</span></span>


[!code-csharp[Main](configuration-and-instrumentation/samples/sample18.cs)]

1. <span data-ttu-id="e8c77-492">保存并浏览 default.aspx，然后单击按钮。</span><span class="sxs-lookup"><span data-stu-id="e8c77-492">Save and browse default.aspx and click the button.</span></span>
2. <span data-ttu-id="e8c77-493">打开 web.config 文件之后每个按钮单击，然后观察,**调试**属性中&lt;编译&gt;部分。</span><span class="sxs-lookup"><span data-stu-id="e8c77-493">Open the web.config file after each button click and observe the **debug** attribute in the &lt;compilation&gt; section.</span></span>

## <a name="lab-2-logging-application-restarts"></a><span data-ttu-id="e8c77-494">实验室 2： 日志记录应用程序重新启动</span><span class="sxs-lookup"><span data-stu-id="e8c77-494">Lab 2: Logging Application Restarts</span></span>

<span data-ttu-id="e8c77-495">在本实验中，你将创建将可用于切换日志记录的应用程序关闭、 启动和事件查看器中的重新编译的代码。</span><span class="sxs-lookup"><span data-stu-id="e8c77-495">In this lab, you will create code that will allow you to toggle the logging of application shutdowns, startups, and recompilations in the Event Viewer.</span></span>

1. <span data-ttu-id="e8c77-496">将 DropDownList 添加到 default.aspx，并将 ID 更改为 ddlLogAppEvents。</span><span class="sxs-lookup"><span data-stu-id="e8c77-496">Add a DropDownList to default.aspx and change the ID to ddlLogAppEvents.</span></span>
2. <span data-ttu-id="e8c77-497">设置**有些**属性到 DropDownList **true**。</span><span class="sxs-lookup"><span data-stu-id="e8c77-497">Set the **AutoPostBack** property for the DropDownList to **true**.</span></span>
3. <span data-ttu-id="e8c77-498">将三个项添加到下拉列表的项集合。</span><span class="sxs-lookup"><span data-stu-id="e8c77-498">Add three items to the Items collection for the DropDownList.</span></span> <span data-ttu-id="e8c77-499">请**文本**第一个项*Select Value*和值-1。</span><span class="sxs-lookup"><span data-stu-id="e8c77-499">Make the **Text** for the first item *Select Value* and the value -1.</span></span> <span data-ttu-id="e8c77-500">请**文本**和**值**的第二个项**True**和**文本**和**值**的第三个项**False**。</span><span class="sxs-lookup"><span data-stu-id="e8c77-500">Make the **Text** and **Value** of the second item **True** and the **Text** and **Value** of the third item **False**.</span></span>
4. <span data-ttu-id="e8c77-501">将新的标签添加到 default.aspx。</span><span class="sxs-lookup"><span data-stu-id="e8c77-501">Add a new Label to default.aspx.</span></span> <span data-ttu-id="e8c77-502">将 ID 更改为**lblLogAppEvents**。</span><span class="sxs-lookup"><span data-stu-id="e8c77-502">Change the ID to **lblLogAppEvents**.</span></span>
5. <span data-ttu-id="e8c77-503">打开 default.aspx 的代码隐藏视图并添加新的声明的变量的类型 HealthMonitoringSection，如下所示：</span><span class="sxs-lookup"><span data-stu-id="e8c77-503">Open the code-behind view for default.aspx and add a new declaration for a variable of type HealthMonitoringSection as shown below:</span></span>


[!code-csharp[Main](configuration-and-instrumentation/samples/sample19.cs)]

1. <span data-ttu-id="e8c77-504">将以下代码添加到页中的现有代码\_Init:</span><span class="sxs-lookup"><span data-stu-id="e8c77-504">Add the following code to the existing code in Page\_Init:</span></span>


[!code-csharp[Main](configuration-and-instrumentation/samples/sample20.cs)]

1. <span data-ttu-id="e8c77-505">双击下拉列表，将以下代码添加到 SelectedIndexChanged 事件：</span><span class="sxs-lookup"><span data-stu-id="e8c77-505">Double-click on the DropDownList and add the following code to the SelectedIndexChanged event:</span></span>


[!code-csharp[Main](configuration-and-instrumentation/samples/sample21.cs)]

1. <span data-ttu-id="e8c77-506">浏览 default.aspx。</span><span class="sxs-lookup"><span data-stu-id="e8c77-506">Browse default.aspx.</span></span>
2. <span data-ttu-id="e8c77-507">设置下拉列表中为**False**。</span><span class="sxs-lookup"><span data-stu-id="e8c77-507">Set the dropdown to **False**.</span></span>
3. <span data-ttu-id="e8c77-508">清除事件查看器中的应用程序日志。</span><span class="sxs-lookup"><span data-stu-id="e8c77-508">Clear the Application log in the Event Viewer.</span></span>
4. <span data-ttu-id="e8c77-509">单击按钮以更改应用程序的调试属性。</span><span class="sxs-lookup"><span data-stu-id="e8c77-509">Click the button to change the Debug attribute for the application.</span></span>
5. <span data-ttu-id="e8c77-510">刷新事件查看器中的应用程序日志。</span><span class="sxs-lookup"><span data-stu-id="e8c77-510">Refresh the Application log in the Event Viewer.</span></span> 

    1. <span data-ttu-id="e8c77-511">记录任何事件？</span><span class="sxs-lookup"><span data-stu-id="e8c77-511">Were any events logged?</span></span>
    2. <span data-ttu-id="e8c77-512">为什么或为什么？</span><span class="sxs-lookup"><span data-stu-id="e8c77-512">Why or why not?</span></span>
6. <span data-ttu-id="e8c77-513">设置下拉列表中为**True。**</span><span class="sxs-lookup"><span data-stu-id="e8c77-513">Set the dropdown to **True.**</span></span>
7. <span data-ttu-id="e8c77-514">单击该按钮以切换为应用程序的调试属性。</span><span class="sxs-lookup"><span data-stu-id="e8c77-514">Click the button to toggle the Debug attribute for the application.</span></span>
8. <span data-ttu-id="e8c77-515">刷新应用程序登录事件查看器。</span><span class="sxs-lookup"><span data-stu-id="e8c77-515">Refresh the Application login the Event Viewer.</span></span> 

    1. <span data-ttu-id="e8c77-516">记录任何事件？</span><span class="sxs-lookup"><span data-stu-id="e8c77-516">Were any events logged?</span></span>
    2. <span data-ttu-id="e8c77-517">应用程序关闭的原因是什么？</span><span class="sxs-lookup"><span data-stu-id="e8c77-517">What was the reason for the app shutdown?</span></span>
9. <span data-ttu-id="e8c77-518">试验启用和禁用日志记录，并查看对 web.config 文件所做的更改。</span><span class="sxs-lookup"><span data-stu-id="e8c77-518">Experiment with turning on and off logging and look at the changes made to the web.config file.</span></span>

## <a name="more-information"></a><span data-ttu-id="e8c77-519">详细信息：</span><span class="sxs-lookup"><span data-stu-id="e8c77-519">More Information:</span></span>

<span data-ttu-id="e8c77-520">ASP.NET 2.0 的提供程序模型允许你创建自己的提供程序不仅应用程序检测，但对于许多其他用途也例如成员身份、 配置文件，等等。有关编写自定义提供程序以将应用程序事件记录到文本文件的详细信息，请访问[此链接](https://msdn.microsoft.com/library/default.asp?url=/library/dnaspp/html/ASPNETProvMod_Prt6.asp)。</span><span class="sxs-lookup"><span data-stu-id="e8c77-520">ASP.NET 2.0's Provider model allows you to create your own providers for not only application instrumentation, but for many other uses as well such as Membership, Profiles, etc. For detailed information on writing a custom provider to log application events to a text file, visit [this link](https://msdn.microsoft.com/library/default.asp?url=/library/dnaspp/html/ASPNETProvMod_Prt6.asp).</span></span>
