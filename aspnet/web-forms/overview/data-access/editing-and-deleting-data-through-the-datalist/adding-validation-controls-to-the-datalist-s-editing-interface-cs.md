---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/adding-validation-controls-to-the-datalist-s-editing-interface-cs
title: "将验证控件添加到 DataList 的编辑接口 (C#) |Microsoft 文档"
author: rick-anderson
description: "在本教程中我们会将验证控件添加到 DataList EditItemTemplate，以提供更安全的编辑用户 int。 是多么容易..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/30/2006
ms.topic: article
ms.assetid: 3ecc21c5-da0e-40ab-abb4-fac1e47398ad
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/adding-validation-controls-to-the-datalist-s-editing-interface-cs
msc.type: authoredcontent
ms.openlocfilehash: b80b25933679d5c5b465af24cf6ff5d3b824b401
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/24/2018
---
<a name="adding-validation-controls-to-the-datalists-editing-interface-c"></a><span data-ttu-id="526d6-103">将验证控件添加到 DataList 的编辑界面 (C#)</span><span class="sxs-lookup"><span data-stu-id="526d6-103">Adding Validation Controls to the DataList's Editing Interface (C#)</span></span>
====================
<span data-ttu-id="526d6-104">通过[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="526d6-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="526d6-105">[下载示例应用程序](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_39_CS.exe)或[下载 PDF](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/datatutorial39cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="526d6-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_39_CS.exe) or [Download PDF](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/datatutorial39cs1.pdf)</span></span>

> <span data-ttu-id="526d6-106">在本教程中我们会将验证控件添加到 DataList EditItemTemplate，以提供更安全编辑的用户界面是多么容易。</span><span class="sxs-lookup"><span data-stu-id="526d6-106">In this tutorial we'll see how easy it is to add validation controls to the DataList's EditItemTemplate in order to provide a more foolproof editing user interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="526d6-107">介绍</span><span class="sxs-lookup"><span data-stu-id="526d6-107">Introduction</span></span>

<span data-ttu-id="526d6-108">在编辑教程为止 DataList，编辑接口 DataLists 没有包括任何主动的用户输入的验证，即使用户无效输入如缺少的产品名称或负的价格会引发异常。</span><span class="sxs-lookup"><span data-stu-id="526d6-108">In the DataList editing tutorials thus far, the DataLists editing interfaces have not included any proactive user input validation even though invalid user input such as a missing product name or negative price results in an exception.</span></span> <span data-ttu-id="526d6-109">在[前面教程](handling-bll-and-dal-level-exceptions-cs.md)，我们探讨了如何添加异常处理代码，以便 DataList 的`UpdateCommand`事件处理程序以捕获和正常显示有关已引发任何异常的信息。</span><span class="sxs-lookup"><span data-stu-id="526d6-109">In the [preceding tutorial](handling-bll-and-dal-level-exceptions-cs.md) we examined how to add exception handling code to the DataList s `UpdateCommand` event handler in order to catch and gracefully display information about any exceptions that were raised.</span></span> <span data-ttu-id="526d6-110">但是，理想情况下，编辑界面应包括验证控制，以防止用户在第一个位置中输入此类无效数据。</span><span class="sxs-lookup"><span data-stu-id="526d6-110">Ideally, however, the editing interface would include validation controls to prevent a user from entering such invalid data in the first place.</span></span>

<span data-ttu-id="526d6-111">在本教程中我们将看到将验证控件添加到 DataList s 是多么容易`EditItemTemplate`以便提供更安全编辑的用户界面。</span><span class="sxs-lookup"><span data-stu-id="526d6-111">In this tutorial we'll see how easy it is to add validation controls to the DataList s `EditItemTemplate` in order to provide a more foolproof editing user interface.</span></span> <span data-ttu-id="526d6-112">具体而言，本教程采用在前面的教程创建的示例，并增强了编辑界面以包含相应的验证。</span><span class="sxs-lookup"><span data-stu-id="526d6-112">Specifically, this tutorial takes the example created in the preceding tutorial and augments the editing interface to include appropriate validation.</span></span>

## <a name="step-1-replicating-the-example-fromhandling-bll--and-dal-level-exceptionshandling-bll-and-dal-level-exceptions-csmd"></a><span data-ttu-id="526d6-113">步骤 1： 复制中的示例[处理 BLL 和 DAL 级别异常](handling-bll-and-dal-level-exceptions-cs.md)</span><span class="sxs-lookup"><span data-stu-id="526d6-113">Step 1: Replicating the Example from[Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-cs.md)</span></span>

<span data-ttu-id="526d6-114">在[处理 BLL-和 DAL 级别异常](handling-bll-and-dal-level-exceptions-cs.md)教程中我们创建列出的名称和两列，可编辑 DataList 中的产品的价格的页。</span><span class="sxs-lookup"><span data-stu-id="526d6-114">In the [Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-cs.md) tutorial we created a page that listed the names and prices of the products in a two-column, editable DataList.</span></span> <span data-ttu-id="526d6-115">我们在本教程的目标是增加 DataList s 编辑界面，若要包括验证控件。</span><span class="sxs-lookup"><span data-stu-id="526d6-115">Our goal for this tutorial is to augment the DataList s editing interface to include validation controls.</span></span> <span data-ttu-id="526d6-116">具体而言，我们验证逻辑将：</span><span class="sxs-lookup"><span data-stu-id="526d6-116">In particular, our validation logic will:</span></span>

- <span data-ttu-id="526d6-117">要求提供产品的名称</span><span class="sxs-lookup"><span data-stu-id="526d6-117">Require that the product s name be provided</span></span>
- <span data-ttu-id="526d6-118">确保输入价格的值是一种有效的货币格式</span><span class="sxs-lookup"><span data-stu-id="526d6-118">Ensure that the value entered for the price is a valid currency format</span></span>
- <span data-ttu-id="526d6-119">确保输入的价格是大于或等于零，因为负数的值`UnitPrice`是非法的值</span><span class="sxs-lookup"><span data-stu-id="526d6-119">Ensure that the value entered for the price is greater than or equal to zero, since a negative `UnitPrice` value is illegal</span></span>

<span data-ttu-id="526d6-120">我们可以看看补充前面的示例，以包含验证之前，我们首先需要复制中的示例`ErrorHandling.aspx`页面`EditDeleteDataList`到本教程中的页的文件夹`UIValidation.aspx`。</span><span class="sxs-lookup"><span data-stu-id="526d6-120">Before we can look at augmenting the previous example to include validation, we first need to replicate the example from the `ErrorHandling.aspx` page in the `EditDeleteDataList` folder to the page for this tutorial, `UIValidation.aspx`.</span></span> <span data-ttu-id="526d6-121">若要实现此，我们需要通过同时复制`ErrorHandling.aspx`页面 s 声明性标记和其源代码。</span><span class="sxs-lookup"><span data-stu-id="526d6-121">To achieve this we need to copy over both the `ErrorHandling.aspx` page s declarative markup and its source code.</span></span> <span data-ttu-id="526d6-122">首先通过声明性标记复制通过执行以下步骤：</span><span class="sxs-lookup"><span data-stu-id="526d6-122">First copy over the declarative markup by performing the following steps:</span></span>

1. <span data-ttu-id="526d6-123">打开`ErrorHandling.aspx`Visual Studio 中的页</span><span class="sxs-lookup"><span data-stu-id="526d6-123">Open the `ErrorHandling.aspx` page in Visual Studio</span></span>
2. <span data-ttu-id="526d6-124">请转到页面 s 声明性标记 （单击页面底部的源按钮）</span><span class="sxs-lookup"><span data-stu-id="526d6-124">Go to the page s declarative markup (click on the Source button at the bottom of the page)</span></span>
3. <span data-ttu-id="526d6-125">复制文本在内的`<asp:Content>`和`</asp:Content>`标记 （3 至 32 行），作为图 1 所示。</span><span class="sxs-lookup"><span data-stu-id="526d6-125">Copy the text within the `<asp:Content>` and `</asp:Content>` tags (lines 3 through 32), as shown in Figure 1.</span></span>


<span data-ttu-id="526d6-126">[![复制文本内&lt;asp： 内容&gt;控件](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image2.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="526d6-126">[![Copy the Text Within the &lt;asp:Content&gt; Control](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image2.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image1.png)</span></span>

<span data-ttu-id="526d6-127">**图 1**： 文本中复制`<asp:Content>`控件 ([单击以查看实际尺寸的图像](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="526d6-127">**Figure 1**: Copy the Text Within the `<asp:Content>` Control ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image3.png))</span></span>


1. <span data-ttu-id="526d6-128">打开`UIValidation.aspx`页</span><span class="sxs-lookup"><span data-stu-id="526d6-128">Open the `UIValidation.aspx` page</span></span>
2. <span data-ttu-id="526d6-129">请转到页面 s 声明性标记</span><span class="sxs-lookup"><span data-stu-id="526d6-129">Go to the page s declarative markup</span></span>
3. <span data-ttu-id="526d6-130">将在文本粘贴`<asp:Content>`控件。</span><span class="sxs-lookup"><span data-stu-id="526d6-130">Paste the text within the `<asp:Content>` control.</span></span>

<span data-ttu-id="526d6-131">若要复制的源代码，请打开`ErrorHandling.aspx.vb`页上，并将复制不仅仅是文本*内*`EditDeleteDataList_ErrorHandling`类。</span><span class="sxs-lookup"><span data-stu-id="526d6-131">To copy over the source code, open the `ErrorHandling.aspx.vb` page and copy just the text *within* the `EditDeleteDataList_ErrorHandling` class.</span></span> <span data-ttu-id="526d6-132">将复制三个事件处理程序 (`Products_EditCommand`， `Products_CancelCommand`，和`Products_UpdateCommand`) 连同`DisplayExceptionDetails`方法，但不是**不**复制类声明或`using`语句。</span><span class="sxs-lookup"><span data-stu-id="526d6-132">Copy the three event handlers (`Products_EditCommand`, `Products_CancelCommand`, and `Products_UpdateCommand`) along with the `DisplayExceptionDetails` method, but do **not** copy the class declaration or `using` statements.</span></span> <span data-ttu-id="526d6-133">粘贴复制的文本*内*`EditDeleteDataList_UIValidation`类`UIValidation.aspx.vb`。</span><span class="sxs-lookup"><span data-stu-id="526d6-133">Paste the copied text *within* the `EditDeleteDataList_UIValidation` class in `UIValidation.aspx.vb`.</span></span>

<span data-ttu-id="526d6-134">之后将移动到的内容和从代码上方`ErrorHandling.aspx`到`UIValidation.aspx`，花些时间测试浏览器中的页。</span><span class="sxs-lookup"><span data-stu-id="526d6-134">After moving over the content and code from `ErrorHandling.aspx` to `UIValidation.aspx`, take a moment to test out the pages in a browser.</span></span> <span data-ttu-id="526d6-135">你应看到相同的输出和遇到每个 （请参见图 2） 这些两个页面中相同的功能。</span><span class="sxs-lookup"><span data-stu-id="526d6-135">You should see the same output and experience the same functionality in each of these two pages (see Figure 2).</span></span>


<span data-ttu-id="526d6-136">[![UIValidation.aspx 页模仿 ErrorHandling.aspx 中的功能](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image5.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="526d6-136">[![The UIValidation.aspx Page Mimics the Functionality in ErrorHandling.aspx](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image5.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image4.png)</span></span>

<span data-ttu-id="526d6-137">**图 2**:`UIValidation.aspx`页模仿中的功能`ErrorHandling.aspx`([单击以查看实际尺寸的图像](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="526d6-137">**Figure 2**: The `UIValidation.aspx` Page Mimics the Functionality in `ErrorHandling.aspx` ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image6.png))</span></span>


## <a name="step-2-adding-the-validation-controls-to-the-datalist-s-edititemtemplate"></a><span data-ttu-id="526d6-138">步骤 2： 将验证控件添加到 DataList 的 EditItemTemplate</span><span class="sxs-lookup"><span data-stu-id="526d6-138">Step 2: Adding the Validation Controls to the DataList s EditItemTemplate</span></span>

<span data-ttu-id="526d6-139">构造数据输入窗体时, 很重要，则用户输入所有必填的字段和所有其提供的输入是合法的格式正确的值。</span><span class="sxs-lookup"><span data-stu-id="526d6-139">When constructing data entry forms, it is important that users enter any required fields and that all their provided inputs are legal, properly-formatted values.</span></span> <span data-ttu-id="526d6-140">为了帮助确保用户的输入有效，ASP.NET 提供专门用于验证的单个输入 Web 控件的值的五个内置的验证控件：</span><span class="sxs-lookup"><span data-stu-id="526d6-140">To help ensure that a user s inputs are valid, ASP.NET provides five built-in validation controls that are designed to validate the value of a single input Web control:</span></span>

- <span data-ttu-id="526d6-141">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx)可确保已提供的值</span><span class="sxs-lookup"><span data-stu-id="526d6-141">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx) ensures that a value has been provided</span></span>
- <span data-ttu-id="526d6-142">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx)验证值与另一个 Web 控件值或一个常量值，或确保值的格式是合法的指定的数据类型</span><span class="sxs-lookup"><span data-stu-id="526d6-142">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx) validates a value against another Web control value or a constant value, or ensures that the value s format is legal for a specified data type</span></span>
- <span data-ttu-id="526d6-143">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx)确保值是值的范围之内</span><span class="sxs-lookup"><span data-stu-id="526d6-143">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx) ensures that a value is within a range of values</span></span>
- <span data-ttu-id="526d6-144">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx)验证值与[正则表达式](http://en.wikipedia.org/wiki/Regular_expression)</span><span class="sxs-lookup"><span data-stu-id="526d6-144">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx) validates a value against a [regular expression](http://en.wikipedia.org/wiki/Regular_expression)</span></span>
- <span data-ttu-id="526d6-145">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx)验证值与自定义、 用户定义的方法</span><span class="sxs-lookup"><span data-stu-id="526d6-145">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx) validates a value against a custom, user-defined method</span></span>

<span data-ttu-id="526d6-146">有关详细信息这些五个控件回头参考[将验证控件添加到的编辑和插入接口](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md)教程或签出[验证控件部分](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/validation/default.aspx)的[ASP.NET 快速入门教程](https://quickstarts.asp.net)。</span><span class="sxs-lookup"><span data-stu-id="526d6-146">For more information on these five controls refer back to the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) tutorial or check out the [Validation Controls section](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/validation/default.aspx) of the [ASP.NET Quickstart Tutorials](https://quickstarts.asp.net).</span></span>

<span data-ttu-id="526d6-147">我们的教程，我们将需要使用 RequiredFieldValidator 以确保已提供的产品名称的值和 CompareValidator 以确保输入的价格大于或等于 0 的值而有效的货币格式提供。</span><span class="sxs-lookup"><span data-stu-id="526d6-147">For our tutorial we'll need to use a RequiredFieldValidator to ensure that a value for the product name has been supplied and a CompareValidator to ensure that the entered price has a value greater than or equal to 0 and is presented in a valid currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="526d6-148">尽管 ASP.NET 1.x 具有这些相同的五个验证控件、 ASP.NET 2.0 已添加了大量改进，包括 Internet Explorer 浏览器以及到分区到页面上的验证控件的功能的两个正在客户端脚本支持主验证组。</span><span class="sxs-lookup"><span data-stu-id="526d6-148">While ASP.NET 1.x had these same five validation controls, ASP.NET 2.0 has added a number of improvements, the main two being client-side script support for browsers in addition to Internet Explorer and the ability to partition validation controls on a page into validation groups.</span></span> <span data-ttu-id="526d6-149">有关 2.0 中的新验证控件功能的详细信息，请参阅[将 ASP.NET 2.0 中的验证控件](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)。</span><span class="sxs-lookup"><span data-stu-id="526d6-149">For more information on the new validation control features in 2.0, refer to [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx).</span></span>


<span data-ttu-id="526d6-150">让我们来开始通过将必要的验证控件添加到 DataList 的`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="526d6-150">Let s start by adding the necessary validation controls to the DataList s `EditItemTemplate`.</span></span> <span data-ttu-id="526d6-151">通过设计器通过单击从 DataList s 智能标记，编辑模板链接或通过声明性语法，可以执行此任务。</span><span class="sxs-lookup"><span data-stu-id="526d6-151">This task can be performed through the Designer by clicking on the Edit Templates link from the DataList s smart tag, or through the declarative syntax.</span></span> <span data-ttu-id="526d6-152">允许 s 逐句通过使用设计视图中的编辑模板选项的过程。</span><span class="sxs-lookup"><span data-stu-id="526d6-152">Let s step through the process using the Edit Templates option from the Design view.</span></span> <span data-ttu-id="526d6-153">选择要编辑 DataList s 后`EditItemTemplate`之后, 通过从工具箱拖动到模板编辑界面中，添加 RequiredFieldValidator 放`ProductName`文本框。</span><span class="sxs-lookup"><span data-stu-id="526d6-153">After choosing to edit the DataList s `EditItemTemplate`, add a RequiredFieldValidator by dragging it from the Toolbox into the template editing interface, placing it after the `ProductName` TextBox.</span></span>


<span data-ttu-id="526d6-154">[![产品名称文本框中的后面添加 EditItemTemplate RequiredFieldValidator](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image8.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="526d6-154">[![Add a RequiredFieldValidator to the EditItemTemplate After the ProductName TextBox](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image8.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image7.png)</span></span>

<span data-ttu-id="526d6-155">**图 3**： 添加到 RequiredFieldValidator `EditItemTemplate After` `ProductName`文本框中 ([单击以查看实际尺寸的图像](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="526d6-155">**Figure 3**: Add a RequiredFieldValidator to the `EditItemTemplate After` the `ProductName` TextBox ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image9.png))</span></span>


<span data-ttu-id="526d6-156">所有验证控件验证单个 ASP.NET Web 控件的输入都工作。</span><span class="sxs-lookup"><span data-stu-id="526d6-156">All validation controls work by validating the input of a single ASP.NET Web control.</span></span> <span data-ttu-id="526d6-157">因此，我们需要指示我们刚添加 RequiredFieldValidator 应验证`ProductName`文本框中; 这可通过设置验证控件 s [ `ControlToValidate`属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx)到`ID`的相应的 Web 控件 (`ProductName`，在这种情况)。</span><span class="sxs-lookup"><span data-stu-id="526d6-157">Therefore, we need to indicate that the RequiredFieldValidator we just added should validate against the `ProductName` TextBox; this is done by setting the validation control s [`ControlToValidate` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx) to the `ID` of the appropriate Web control (`ProductName`, in this instance).</span></span> <span data-ttu-id="526d6-158">接下来，设置[`ErrorMessage`属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx)必须到提供的产品的名称和[`Text`属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx)到\*。</span><span class="sxs-lookup"><span data-stu-id="526d6-158">Next, set the [`ErrorMessage` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx) to You must provide the product s name and the [`Text` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx) to \*.</span></span> <span data-ttu-id="526d6-159">`Text`属性值，如果提供，则如果验证失败，通过该验证控件显示的文本。</span><span class="sxs-lookup"><span data-stu-id="526d6-159">The `Text` property value, if provided, is the text that is displayed by the validation control if the validation fails.</span></span> <span data-ttu-id="526d6-160">`ErrorMessage`属性值，该值是必需的由 ValidationSummary 控件; 如果`Text`省略属性值，`ErrorMessage`上输入无效的验证控件的显示属性值。</span><span class="sxs-lookup"><span data-stu-id="526d6-160">The `ErrorMessage` property value, which is required, is used by the ValidationSummary control; if the `Text` property value is omitted, the `ErrorMessage` property value is displayed by the validation control on invalid input.</span></span>

<span data-ttu-id="526d6-161">在设置后 RequiredFieldValidator 这三个属性，你的屏幕应类似于图 4。</span><span class="sxs-lookup"><span data-stu-id="526d6-161">After setting these three properties of the RequiredFieldValidator, your screen should look similar to Figure 4.</span></span>


<span data-ttu-id="526d6-162">[![设置 RequiredFieldValidator 的 ControlToValidate、 ErrorMessage 和文本属性](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image11.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="526d6-162">[![Set the RequiredFieldValidator s ControlToValidate, ErrorMessage, and Text Properties](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image11.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image10.png)</span></span>

<span data-ttu-id="526d6-163">**图 4**： 设置 RequiredFieldValidator s `ControlToValidate`， `ErrorMessage`，和`Text`属性 ([单击以查看实际尺寸的图像](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="526d6-163">**Figure 4**: Set the RequiredFieldValidator s `ControlToValidate`, `ErrorMessage`, and `Text` Properties ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image12.png))</span></span>


<span data-ttu-id="526d6-164">使用添加到 RequiredFieldValidator `EditItemTemplate`，所有保持是添加产品的价格文本框中的必要验证。</span><span class="sxs-lookup"><span data-stu-id="526d6-164">With the RequiredFieldValidator added to the `EditItemTemplate`, all that remains is to add the necessary validation for the product s price TextBox.</span></span> <span data-ttu-id="526d6-165">由于`UnitPrice`是可选时编辑记录，我们不需要添加 RequiredFieldValidator。</span><span class="sxs-lookup"><span data-stu-id="526d6-165">Since the `UnitPrice` is optional when editing a record, we don t need to add a RequiredFieldValidator.</span></span> <span data-ttu-id="526d6-166">我们执行此操作，但是，需要添加 CompareValidator 以确保`UnitPrice`，如果提供，作为一种货币格式正确，大于或等于 0。</span><span class="sxs-lookup"><span data-stu-id="526d6-166">We do, however, need to add a CompareValidator to ensure that the `UnitPrice`, if supplied, is properly formatted as a currency and is greater than or equal to 0.</span></span>

<span data-ttu-id="526d6-167">添加到 CompareValidator`EditItemTemplate`并设置其`ControlToValidate`属性`UnitPrice`，将其`ErrorMessage`价格属性必须大于或等于零，并且不能包括货币符号，并将其`Text`属性\*.</span><span class="sxs-lookup"><span data-stu-id="526d6-167">Add the CompareValidator into the `EditItemTemplate` and set its `ControlToValidate` property to `UnitPrice`, its `ErrorMessage` property to The price must be greater than or equal to zero and cannot include the currency symbol, and its `Text` property to \*.</span></span> <span data-ttu-id="526d6-168">若要指示`UnitPrice`值必须是大于或等于 0，设置 CompareValidator s [ `Operator`属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx)到`GreaterThanEqual`，将其[`ValueToCompare`属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx)为 0，并其[`Type`属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx)到`Currency`。</span><span class="sxs-lookup"><span data-stu-id="526d6-168">To indicate that the `UnitPrice` value must be greater than or equal to 0, set the CompareValidator s [`Operator` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx) to `GreaterThanEqual`, its [`ValueToCompare` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx) to 0, and its [`Type` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx) to `Currency`.</span></span>

<span data-ttu-id="526d6-169">添加这些两个验证控件，DataList s 后`EditItemTemplate`s 声明性语法外观应与以下类似：</span><span class="sxs-lookup"><span data-stu-id="526d6-169">After adding these two validation controls, the DataList s `EditItemTemplate` s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](adding-validation-controls-to-the-datalist-s-editing-interface-cs/samples/sample1.aspx)]

<span data-ttu-id="526d6-170">进行这些更改后，在浏览器中打开页面。</span><span class="sxs-lookup"><span data-stu-id="526d6-170">After making these changes, open the page in a browser.</span></span> <span data-ttu-id="526d6-171">如果你尝试省略名称或输入无效的价格值编辑产品时，文本框旁边将出现一个星号。</span><span class="sxs-lookup"><span data-stu-id="526d6-171">If you attempt to omit the name or enter an invalid price value when editing a product, an asterisk appears next to the textbox.</span></span> <span data-ttu-id="526d6-172">如图 5 所示，包含如 19.95 美元的货币符号的价格值将被视为无效。</span><span class="sxs-lookup"><span data-stu-id="526d6-172">As Figure 5 shows, a price value that includes the currency symbol such as $19.95 is considered invalid.</span></span> <span data-ttu-id="526d6-173">CompareValidator s `Currency` `Type` （如逗号或句号，具体取决于的区域性设置） 的数字分隔符的前导加号或减号，允许而不是*不*允许货币符号。</span><span class="sxs-lookup"><span data-stu-id="526d6-173">The CompareValidator s `Currency` `Type` allows for digit separators (such as commas or periods, depending on the culture settings) and a leading plus or minus sign, but does *not* permit a currency symbol.</span></span> <span data-ttu-id="526d6-174">此行为可能 perplex 用户，如编辑接口当前呈现`UnitPrice`使用货币格式。</span><span class="sxs-lookup"><span data-stu-id="526d6-174">This behavior may perplex users as the editing interface currently renders the `UnitPrice` using the currency format.</span></span>


<span data-ttu-id="526d6-175">[![无效的输入的文本框旁边显示了星号](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image14.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="526d6-175">[![An Asterisk Appears Next to the Textboxes with Invalid Input](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image14.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image13.png)</span></span>

<span data-ttu-id="526d6-176">**图 5**: 星号显示下一步到无效的输入的文本框 ([单击以查看实际尺寸的图像](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="526d6-176">**Figure 5**: An Asterisk Appears Next to the Textboxes with Invalid Input ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image15.png))</span></span>


<span data-ttu-id="526d6-177">尽管验证可充当的是，用户必须手动编辑一个记录，不是可接受时删除的货币符号。</span><span class="sxs-lookup"><span data-stu-id="526d6-177">While the validation works as-is, the user has to manually remove the currency symbol when editing a record, which is not acceptable.</span></span> <span data-ttu-id="526d6-178">此外，如果有无效输入中编辑接口既不更新，也不取消按钮，当单击时，将调用回发。</span><span class="sxs-lookup"><span data-stu-id="526d6-178">Moreover, if there are invalid inputs in the editing interface neither the Update nor Cancel buttons, when clicked, will invoke a postback.</span></span> <span data-ttu-id="526d6-179">理想情况下，取消按钮将返回 DataList 为预先编辑状态，而不考虑用户的输入的有效性。</span><span class="sxs-lookup"><span data-stu-id="526d6-179">Ideally, the Cancel button would return the DataList to its pre-editing state regardless of the validity of the user s inputs.</span></span> <span data-ttu-id="526d6-180">此外，我们需要确保更新 DataList s 中的产品信息之前是否有效，s 的页面数据`UpdateCommand`事件处理程序，其浏览器不支持 JavaScript 或具有的用户可以跳过客户端逻辑的验证控件禁用其支持。</span><span class="sxs-lookup"><span data-stu-id="526d6-180">Also, we need to ensure that the page s data is valid before updating the product information in the DataList s `UpdateCommand` event handler, as the validation controls client-side logic can be bypassed by users whose browsers either don t support JavaScript or have its support disabled.</span></span>

## <a name="removing-the-currency-symbol-from-the-edititemtemplate-s-unitprice-textbox"></a><span data-ttu-id="526d6-181">从 EditItemTemplate s 单价文本框中删除的货币符号</span><span class="sxs-lookup"><span data-stu-id="526d6-181">Removing the Currency Symbol from the EditItemTemplate s UnitPrice TextBox</span></span>

<span data-ttu-id="526d6-182">当使用 CompareValidator 的`Currency``Type`，正被验证的输入不能包含任何货币符号。</span><span class="sxs-lookup"><span data-stu-id="526d6-182">When using the CompareValidator s `Currency``Type`, the input being validated must not include any currency symbols.</span></span> <span data-ttu-id="526d6-183">此类符号存在导致 CompareValidator 将标记为无效的输入。</span><span class="sxs-lookup"><span data-stu-id="526d6-183">The presence of such symbols causes the CompareValidator to mark the input as invalid.</span></span> <span data-ttu-id="526d6-184">但是，我们的编辑界面当前包括中的货币符号`UnitPrice`文本框中，这意味着用户必须在保存其更改之前显式删除的货币符号。</span><span class="sxs-lookup"><span data-stu-id="526d6-184">However, our editing interface currently includes a currency symbol in the `UnitPrice` TextBox, meaning the user must explicitly remove the currency symbol before saving their changes.</span></span> <span data-ttu-id="526d6-185">要解决此问题，我们有三个选项：</span><span class="sxs-lookup"><span data-stu-id="526d6-185">To remedy this we have three options:</span></span>

1. <span data-ttu-id="526d6-186">配置`EditItemTemplate`以便`UnitPrice`文本框值未设置为货币的格式。</span><span class="sxs-lookup"><span data-stu-id="526d6-186">Configure the `EditItemTemplate` so that the `UnitPrice` TextBox value is not formatted as a currency.</span></span>
2. <span data-ttu-id="526d6-187">允许用户通过删除 CompareValidator 并将它替换为格式正确的货币值检查 RegularExpressionValidator 输入货币符号。</span><span class="sxs-lookup"><span data-stu-id="526d6-187">Allow the user to enter a currency symbol by removing the CompareValidator and replacing it with a RegularExpressionValidator that checks for a properly formatted currency value.</span></span> <span data-ttu-id="526d6-188">这里的挑战是要验证货币值的正则表达式不是像 CompareValidator 一样简单，并且如果我们想要合并的区域性设置需要编写代码。</span><span class="sxs-lookup"><span data-stu-id="526d6-188">The challenge here is that the regular expression to validate a currency value is not as straightforward as the CompareValidator and would require writing code if we wanted to incorporate culture settings.</span></span>
3. <span data-ttu-id="526d6-189">完全删除验证控件和依赖于 GridView s 中的自定义服务器端验证逻辑`RowUpdating`事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="526d6-189">Remove the validation control altogether and rely on custom server-side validation logic in the GridView s `RowUpdating` event handler.</span></span>

<span data-ttu-id="526d6-190">让我们来使用本教程中的选项 1。</span><span class="sxs-lookup"><span data-stu-id="526d6-190">Let s go with option 1 for this tutorial.</span></span> <span data-ttu-id="526d6-191">当前`UnitPrice`格式化为货币值中文本框中的数据绑定表达式由于`EditItemTemplate`: `<%# Eval("UnitPrice", "{0:c}") %>`。</span><span class="sxs-lookup"><span data-stu-id="526d6-191">Currently the `UnitPrice` is formatted as a currency value due to the databinding expression for the TextBox in the `EditItemTemplate`: `<%# Eval("UnitPrice", "{0:c}") %>`.</span></span> <span data-ttu-id="526d6-192">更改`Eval`语句`Eval("UnitPrice", "{0:n2}")`，其中将结果格式化为大量具有两位数的精度。</span><span class="sxs-lookup"><span data-stu-id="526d6-192">Change the `Eval` statement to `Eval("UnitPrice", "{0:n2}")`, which formats the result as a number with two digits of precision.</span></span> <span data-ttu-id="526d6-193">这可以通过声明性语法直接或通过单击从编辑数据绑定链接`UnitPrice`DataList s 中的文本框中`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="526d6-193">This can be done directly through the declarative syntax or by clicking on the Edit DataBindings link from the `UnitPrice` TextBox in the DataList s `EditItemTemplate`.</span></span>

<span data-ttu-id="526d6-194">进行此更改后，编辑界面中的格式化的价格包括作为组分隔符的逗号和句点作为小数分隔符，但保留关闭的货币符号。</span><span class="sxs-lookup"><span data-stu-id="526d6-194">With this change, the formatted price in the editing interface includes commas as the group separator and a period as the decimal separator, but leaves off the currency symbol.</span></span>

> [!NOTE]
> <span data-ttu-id="526d6-195">可编辑的接口在从删除货币格式时, 找到它有助于将作为外部文本框中的文本放在货币符号。</span><span class="sxs-lookup"><span data-stu-id="526d6-195">When removing the currency format from the editable interface, I find it helpful to put the currency symbol as text outside the TextBox.</span></span> <span data-ttu-id="526d6-196">作为对它们不需要提供的货币符号的用户的提示，此选项。</span><span class="sxs-lookup"><span data-stu-id="526d6-196">This serves as a hint to the user that they do not need to provide the currency symbol.</span></span>


## <a name="fixing-the-cancel-button"></a><span data-ttu-id="526d6-197">修复取消按钮</span><span class="sxs-lookup"><span data-stu-id="526d6-197">Fixing the Cancel Button</span></span>

<span data-ttu-id="526d6-198">默认情况下，验证 Web 控件发出 JavaScript 客户端上执行验证。</span><span class="sxs-lookup"><span data-stu-id="526d6-198">By default, the validation Web controls emit JavaScript to perform validation on the client-side.</span></span> <span data-ttu-id="526d6-199">单击按钮、 LinkButton 或 ImageButton 时，回发发生之前针对客户端检查页上的验证控件。</span><span class="sxs-lookup"><span data-stu-id="526d6-199">When a Button, LinkButton, or ImageButton is clicked, the validation controls on the page are checked on the client-side before the postback occurs.</span></span> <span data-ttu-id="526d6-200">如果没有任何无效的数据，将被取消回发。</span><span class="sxs-lookup"><span data-stu-id="526d6-200">If there is any invalid data, the postback is cancelled.</span></span> <span data-ttu-id="526d6-201">对于某些按钮，不过，数据的有效性可能重要;在这种情况下，无回发由于无效的数据已被取消是一种干扰。</span><span class="sxs-lookup"><span data-stu-id="526d6-201">For certain Buttons, though, the validity of the data might be immaterial; in such a case, having the postback cancelled due to invalid data is a nuisance.</span></span>

<span data-ttu-id="526d6-202">取消按钮是此类示例。</span><span class="sxs-lookup"><span data-stu-id="526d6-202">The Cancel button is such an example.</span></span> <span data-ttu-id="526d6-203">假设用户输入无效数据，如省略产品的名称，，然后决定她没有 t 想要在所有保存产品并触发取消按钮。</span><span class="sxs-lookup"><span data-stu-id="526d6-203">Imagine that a user enters invalid data, such as omitting the product s name, and then decides she doesn t want to save the product after all and hits the Cancel button.</span></span> <span data-ttu-id="526d6-204">目前，取消按钮将触发验证控件在页上，该报告的产品名称缺失，防止回发。</span><span class="sxs-lookup"><span data-stu-id="526d6-204">Currently, the Cancel button triggers the validation controls on the page, which report that the product name is missing and prevent the postback.</span></span> <span data-ttu-id="526d6-205">我们的用户必须键入一些文本到`ProductName`文本框中，只是为了取消退出编辑过程。</span><span class="sxs-lookup"><span data-stu-id="526d6-205">Our user has to type some text into the `ProductName` TextBox just to cancel out of the editing process.</span></span>

<span data-ttu-id="526d6-206">幸运的是，按钮、 LinkButton 和 ImageButton 具有[`CausesValidation`属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.causesvalidation.aspx)可以指示是否单击按钮应启动的验证逻辑 (默认为`True`)。</span><span class="sxs-lookup"><span data-stu-id="526d6-206">Fortunately, the Button, LinkButton, and ImageButton have a [`CausesValidation` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.causesvalidation.aspx) that can indicate whether or not clicking the Button should initiate the validation logic (defaults to `True`).</span></span> <span data-ttu-id="526d6-207">设置取消按钮 s`CausesValidation`属性`False`。</span><span class="sxs-lookup"><span data-stu-id="526d6-207">Set the Cancel Button s `CausesValidation` property to `False`.</span></span>

## <a name="ensuring-the-inputs-are-valid-in-the-updatecommand-event-handler"></a><span data-ttu-id="526d6-208">确保输入是限于 UpdateCommand 事件处理程序中的有效</span><span class="sxs-lookup"><span data-stu-id="526d6-208">Ensuring the Inputs are Valid in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="526d6-209">由于发出的验证控件中，客户端脚本如果用户输入无效的输入验证控件取消按钮，LinkButton，由启动任何回发 ImageButton 控件或其`CausesValidation`属性`True`(默认值）。</span><span class="sxs-lookup"><span data-stu-id="526d6-209">Due to the client-side script emitted by the validation controls, if a user enters invalid input the validation controls cancel any postbacks initiated by Button, LinkButton, or ImageButton controls whose `CausesValidation` properties are `True` (the default).</span></span> <span data-ttu-id="526d6-210">但是，如果用户访问过时的浏览器或其中一个已禁用其 JavaScript 支持中，将不会执行客户端验证检查。</span><span class="sxs-lookup"><span data-stu-id="526d6-210">However, if a user is visiting with an antiquated browser or one whose JavaScript support has been disabled, the client-side validation checks will not execute.</span></span>

<span data-ttu-id="526d6-211">ASP.NET 验证控件的所有重复回发时将立即对其验证逻辑并报告通过页的输入的总体有效性[`Page.IsValid`属性](https://msdn.microsoft.com/library/system.web.ui.page.isvalid.aspx)。</span><span class="sxs-lookup"><span data-stu-id="526d6-211">All of the ASP.NET validation controls repeat their validation logic immediately upon postback and report the overall validity of the page s inputs via the [`Page.IsValid` property](https://msdn.microsoft.com/library/system.web.ui.page.isvalid.aspx).</span></span> <span data-ttu-id="526d6-212">但是，页面流未中断或停止任何方式基于的值中`Page.IsValid`。</span><span class="sxs-lookup"><span data-stu-id="526d6-212">However, the page flow is not interrupted or stopped in any way based on the value of `Page.IsValid`.</span></span> <span data-ttu-id="526d6-213">作为开发人员而言，是，我们有责任确保`Page.IsValid`属性具有的值`True`假定有效的代码继续输入数据之前。</span><span class="sxs-lookup"><span data-stu-id="526d6-213">As developers, it is our responsibility to ensure that the `Page.IsValid` property has a value of `True` before proceeding with code that assumes valid input data.</span></span>

<span data-ttu-id="526d6-214">如果用户具有禁用的 JavaScript，访问我们的页面、 编辑产品、 进入太价格值占用大量资源，并单击更新按钮，将绕过客户端验证和回发将随之发生。</span><span class="sxs-lookup"><span data-stu-id="526d6-214">If a user has JavaScript disabled, visits our page, edits a product, enters a price value of Too expensive, and clicks the Update button, the client-side validation will be bypassed and a postback will ensue.</span></span> <span data-ttu-id="526d6-215">在回发时，ASP.NET 页 s`UpdateCommand`事件处理程序执行，并在尝试分析太时引发异常的成本较低`Decimal`。</span><span class="sxs-lookup"><span data-stu-id="526d6-215">On postback, the ASP.NET page s `UpdateCommand` event handler executes and an exception is raised when attempting to parse Too expensive to a `Decimal`.</span></span> <span data-ttu-id="526d6-216">由于我们有异常处理，将处理此类异常正常，但我们可以通过第一个位置通过仅继续执行操作滑动阻止无效的数据`UpdateCommand`事件处理程序如果`Page.IsValid`的值为`True`。</span><span class="sxs-lookup"><span data-stu-id="526d6-216">Since we have exception handling, such an exception will be handled gracefully, but we could prevent the invalid data from slipping through in the first place by only proceeding with the `UpdateCommand` event handler if `Page.IsValid` has a value of `True`.</span></span>

<span data-ttu-id="526d6-217">将以下代码添加到开始`UpdateCommand`事件处理程序中，紧靠之前`Try`块：</span><span class="sxs-lookup"><span data-stu-id="526d6-217">Add the following code to the start of the `UpdateCommand` event handler, immediately before the `Try` block:</span></span>


[!code-csharp[Main](adding-validation-controls-to-the-datalist-s-editing-interface-cs/samples/sample2.cs)]

<span data-ttu-id="526d6-218">添加此元素后，产品将尝试更新仅当已提交的数据有效。</span><span class="sxs-lookup"><span data-stu-id="526d6-218">With this addition, the product will attempt to be updated only if the submitted data is valid.</span></span> <span data-ttu-id="526d6-219">获胜 t 的大多数用户能够回发无效数据由于验证控件客户端脚本，但用户的浏览器不支持 JavaScript 或具有支持的 JavaScript 禁用，可以绕过客户端检查和提交的数据无效。</span><span class="sxs-lookup"><span data-stu-id="526d6-219">Most users won t be able to postback invalid data due to the validation controls client-side scripts, but users whose browsers don t support JavaScript or that have JavaScript support disabled, can bypass the client-side checks and submit invalid data.</span></span>

> [!NOTE]
> <span data-ttu-id="526d6-220">敏锐读取器使用 GridView，更新数据时将记住，我们没有 t 需要显式检查`Page.IsValid`我们页面的代码隐藏类中的属性。</span><span class="sxs-lookup"><span data-stu-id="526d6-220">The astute reader will recall that when updating data with the GridView, we didn t need to explicitly check the `Page.IsValid` property in our page s code-behind class.</span></span> <span data-ttu-id="526d6-221">这是因为 GridView 咨询`Page.IsValid`属性对于我们和仅与更新仅当它返回的值时，才会继续进行`True`。</span><span class="sxs-lookup"><span data-stu-id="526d6-221">This is because the GridView consults the `Page.IsValid` property for us and only proceeds with the update only if it returns a value of `True`.</span></span>


## <a name="step-3-summarizing-data-entry-problems"></a><span data-ttu-id="526d6-222">步骤 3： 汇总数据条目问题</span><span class="sxs-lookup"><span data-stu-id="526d6-222">Step 3: Summarizing Data Entry Problems</span></span>

<span data-ttu-id="526d6-223">除了五个验证控件中，包括 ASP.NET [ValidationSummary 控件](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx)，其中显示`ErrorMessage`s 检测到无效的数据的那些验证控件。</span><span class="sxs-lookup"><span data-stu-id="526d6-223">In addition to the five validation controls, ASP.NET includes the [ValidationSummary control](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx), which displays the `ErrorMessage` s of those validation controls that detected invalid data.</span></span> <span data-ttu-id="526d6-224">此摘要数据可以显示为文本在网页上或通过模式，客户端的消息框。</span><span class="sxs-lookup"><span data-stu-id="526d6-224">This summary data can be displayed as text on the web page or through a modal, client-side messagebox.</span></span> <span data-ttu-id="526d6-225">让我们来增强此教程，以包括客户端的消息框汇总任何验证问题。</span><span class="sxs-lookup"><span data-stu-id="526d6-225">Let s enhance this tutorial to include a client-side messagebox summarizing any validation problems.</span></span>

<span data-ttu-id="526d6-226">若要完成此操作，请从工具箱中拖动到设计器拖动 ValidationSummary 控件。</span><span class="sxs-lookup"><span data-stu-id="526d6-226">To accomplish this, drag a ValidationSummary control from the Toolbox onto the Designer.</span></span> <span data-ttu-id="526d6-227">位置 ValidationSummary 控件不真正有意义，因为我们重新要将其配置为仅显示摘要作为消息框。</span><span class="sxs-lookup"><span data-stu-id="526d6-227">The location of the ValidationSummary control doesn t really matter, since we re going to configure it to only display the summary as a messagebox.</span></span> <span data-ttu-id="526d6-228">在添加控件后, 设置其[`ShowSummary`属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx)到`False`及其[`ShowMessageBox`属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx)到`True`。</span><span class="sxs-lookup"><span data-stu-id="526d6-228">After adding the control, set its [`ShowSummary` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx) to `False` and its [`ShowMessageBox` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx) to `True`.</span></span> <span data-ttu-id="526d6-229">添加此元素后，任何验证错误汇总中一个客户端的 messagebox （请参阅图 6）。</span><span class="sxs-lookup"><span data-stu-id="526d6-229">With this addition, any validation errors are summarized in a client-side messagebox (see Figure 6).</span></span>


<span data-ttu-id="526d6-230">[![客户端 Messagebox 中总结了验证错误](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image17.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="526d6-230">[![The Validation Errors are Summarized in a Client-Side Messagebox](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image17.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image16.png)</span></span>

<span data-ttu-id="526d6-231">**图 6**： 一个客户端的 Messagebox 中总结了验证错误 ([单击以查看实际尺寸的图像](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="526d6-231">**Figure 6**: The Validation Errors are Summarized in a Client-Side Messagebox ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image18.png))</span></span>


## <a name="summary"></a><span data-ttu-id="526d6-232">摘要</span><span class="sxs-lookup"><span data-stu-id="526d6-232">Summary</span></span>

<span data-ttu-id="526d6-233">在本教程中我们已了解如何通过使用验证控件主动确保我们的用户输入有效在之前尝试更新工作流中使用它们减少引发异常的可能性。</span><span class="sxs-lookup"><span data-stu-id="526d6-233">In this tutorial we saw how to reduce the likelihood of exceptions by using validation controls to proactively ensure that our users inputs are valid before attempting to use them in the updating workflow.</span></span> <span data-ttu-id="526d6-234">ASP.NET 提供五个验证 Web 控件，旨在检查特定 Web 控制 s 输入和报告回输入的 s 有效性。</span><span class="sxs-lookup"><span data-stu-id="526d6-234">ASP.NET provides five validation Web controls that are designed to inspect a particular Web control s input and report back on the input s validity.</span></span> <span data-ttu-id="526d6-235">在本教程中我们使用这些五个控件的两个 RequiredFieldValidator 和 CompareValidator 以确保提供了产品的名称和价格，必须使用大于或等于零的值以货币格式。</span><span class="sxs-lookup"><span data-stu-id="526d6-235">In this tutorial we used two of those five controls the RequiredFieldValidator and the CompareValidator to ensure that the product s name was supplied and that the price had a currency format with a value greater than or equal to zero.</span></span>

<span data-ttu-id="526d6-236">将验证控件添加到编辑接口 DataList s 非常简单，拖动到`EditItemTemplate`从工具箱和设置少量的属性。</span><span class="sxs-lookup"><span data-stu-id="526d6-236">Adding validation controls to the DataList s editing interface is as simple as dragging them onto the `EditItemTemplate` from the Toolbox and setting a handful of properties.</span></span> <span data-ttu-id="526d6-237">默认情况下，验证控件自动发出客户端验证脚本;它们还提供服务器端验证回发时，存储中的累积结果`Page.IsValid`属性。</span><span class="sxs-lookup"><span data-stu-id="526d6-237">By default, the validation controls automatically emit client-side validation script; they also provide server-side validation on postback, storing the cumulative result in the `Page.IsValid` property.</span></span> <span data-ttu-id="526d6-238">若要在单击按钮、 LinkButton 或 ImageButton 时绕过客户端验证，请设置按钮 s`CausesValidation`属性`False`。</span><span class="sxs-lookup"><span data-stu-id="526d6-238">To bypass the client-side validation when a Button, LinkButton, or ImageButton is clicked, set the button s `CausesValidation` property to `False`.</span></span> <span data-ttu-id="526d6-239">此外，使用在回发时提交的数据执行任何任务之前, 确保`Page.IsValid`属性返回`True`。</span><span class="sxs-lookup"><span data-stu-id="526d6-239">Also, before performing any tasks with the data submitted on postback, ensure that the `Page.IsValid` property returns `True`.</span></span>

<span data-ttu-id="526d6-240">所有编辑教程 DataList 我们的产品 s 名称文本框中，另一个用于价格中检查到目前为止已获得了非常简单的编辑界面。</span><span class="sxs-lookup"><span data-stu-id="526d6-240">All of the DataList editing tutorials we ve examined so far have had very simple editing interfaces a TextBox for the product s name and another for the price.</span></span> <span data-ttu-id="526d6-241">编辑接口，但是，可以包含多种不同的 Web 控件，如 DropDownLists、 日历、 单选按钮、 复选框，依次类推。</span><span class="sxs-lookup"><span data-stu-id="526d6-241">The editing interface, however, can contain a mix of different Web controls, such as DropDownLists, Calendars, RadioButtons, CheckBoxes, and so on.</span></span> <span data-ttu-id="526d6-242">在我们的下一步教程中我们将查看生成一个接口，使用各种 Web 控件。</span><span class="sxs-lookup"><span data-stu-id="526d6-242">In our next tutorial we'll look at building an interface that uses a variety of Web controls.</span></span>

<span data-ttu-id="526d6-243">尽情享受编程 ！</span><span class="sxs-lookup"><span data-stu-id="526d6-243">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="526d6-244">关于作者</span><span class="sxs-lookup"><span data-stu-id="526d6-244">About the Author</span></span>

<span data-ttu-id="526d6-245">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七个 ASP/ASP.NET 书籍和的创始人[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年使用与 Microsoft Web 技术。</span><span class="sxs-lookup"><span data-stu-id="526d6-245">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="526d6-246">Scott 的作用是作为独立的顾问、 培训师和编写器。</span><span class="sxs-lookup"><span data-stu-id="526d6-246">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="526d6-247">最新书籍是[ *Sam 教授自己 ASP.NET 2.0 24 小时内*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="526d6-247">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="526d6-248">他可以达到在[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)或通过他的博客，其中可以找到在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="526d6-248">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="526d6-249">特别感谢</span><span class="sxs-lookup"><span data-stu-id="526d6-249">Special Thanks To</span></span>

<span data-ttu-id="526d6-250">本教程系列已由许多有用的审阅者评审。</span><span class="sxs-lookup"><span data-stu-id="526d6-250">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="526d6-251">本教程中的前导审阅者已 Dennis Patterson、 Ken Pespisa 和沈 Shulok。</span><span class="sxs-lookup"><span data-stu-id="526d6-251">Lead reviewers for this tutorial were Dennis Patterson, Ken Pespisa, and Liz Shulok.</span></span> <span data-ttu-id="526d6-252">对感兴趣查看我即将到来的 MSDN 文章？</span><span class="sxs-lookup"><span data-stu-id="526d6-252">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="526d6-253">如果是这样，删除我一行[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="526d6-253">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="526d6-254">[上一页](handling-bll-and-dal-level-exceptions-cs.md)
[下一页](customizing-the-datalist-s-editing-interface-cs.md)</span><span class="sxs-lookup"><span data-stu-id="526d6-254">[Previous](handling-bll-and-dal-level-exceptions-cs.md)
[Next](customizing-the-datalist-s-editing-interface-cs.md)</span></span>
