---
uid: web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-cs
title: "设置 DataList 和转发器的格式取决于数据 (C#) |Microsoft 文档"
author: rick-anderson
description: "在本教程中我们将逐步了解我们如何格式化 DataList 和转发器控件，通过使用格式设置的函数的外观的示例..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 09/13/2006
ms.topic: article
ms.assetid: 83e3d759-82b8-41e6-8d62-f0f4b3edec41
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-cs
msc.type: authoredcontent
ms.openlocfilehash: 6e5bc0d9ac26801f48560cf07d4a0ab3854d5f74
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/10/2017
---
<a name="formatting-the-datalist-and-repeater-based-upon-data-c"></a><span data-ttu-id="66a45-103">格式设置的 DataList 和转发器取决于数据 (C#)</span><span class="sxs-lookup"><span data-stu-id="66a45-103">Formatting the DataList and Repeater Based Upon Data (C#)</span></span>
====================
<span data-ttu-id="66a45-104">通过[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="66a45-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="66a45-105">[下载示例应用程序](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_CS.exe)或[下载 PDF](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/datatutorial30cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="66a45-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_CS.exe) or [Download PDF](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/datatutorial30cs1.pdf)</span></span>

> <span data-ttu-id="66a45-106">在本教程中我们将逐步了解我们如何格式化 DataList 和转发器控件，通过使用在模板中的格式设置函数或通过处理数据绑定事件的外观的示例。</span><span class="sxs-lookup"><span data-stu-id="66a45-106">In this tutorial we'll step through examples of how we format the appearance of the DataList and Repeater controls, either by using formatting functions within templates or by handling the DataBound event.</span></span>


## <a name="introduction"></a><span data-ttu-id="66a45-107">介绍</span><span class="sxs-lookup"><span data-stu-id="66a45-107">Introduction</span></span>

<span data-ttu-id="66a45-108">正如我们看到在前面的教程，DataList 提供多个与样式有关的属性影响它的外观。</span><span class="sxs-lookup"><span data-stu-id="66a45-108">As we saw in the preceding tutorial, the DataList offers a number of style-related properties that affect its appearance.</span></span> <span data-ttu-id="66a45-109">具体而言，我们已了解如何将默认 CSS 类分配给 DataList s `HeaderStyle`， `ItemStyle`， `AlternatingItemStyle`，和`SelectedItemStyle`属性。</span><span class="sxs-lookup"><span data-stu-id="66a45-109">In particular, we saw how to assign default CSS classes to the DataList s `HeaderStyle`, `ItemStyle`, `AlternatingItemStyle`, and `SelectedItemStyle` properties.</span></span> <span data-ttu-id="66a45-110">除了这些四个属性，DataList 包括大量的其他样式相关的属性，如`Font`， `ForeColor`， `BackColor`，和`BorderWidth`，仅举几例。</span><span class="sxs-lookup"><span data-stu-id="66a45-110">In addition to these four properties, the DataList includes a number of other style-related properties, such as `Font`, `ForeColor`, `BackColor`, and `BorderWidth`, to name a few.</span></span> <span data-ttu-id="66a45-111">转发器控件不包含任何与样式有关的属性。</span><span class="sxs-lookup"><span data-stu-id="66a45-111">The Repeater control does not contain any style-related properties.</span></span> <span data-ttu-id="66a45-112">必须直接在转发器的模板中的标记内进行任何此类样式设置。</span><span class="sxs-lookup"><span data-stu-id="66a45-112">Any such style settings must be made directly within the markup in the Repeater s templates.</span></span>

<span data-ttu-id="66a45-113">通常情况下，不过，应如何格式化数据取决于数据本身。</span><span class="sxs-lookup"><span data-stu-id="66a45-113">Often, though, how data should be formatted depends on the data itself.</span></span> <span data-ttu-id="66a45-114">例如，列出产品时我们可能想要在浅灰色字体颜色中显示的产品信息，如果它已停止使用，或者我们可能想要突出显示`UnitsInStock`时为零的值。</span><span class="sxs-lookup"><span data-stu-id="66a45-114">For example, when listing products we might want to display the product information in a light gray font color if it is discontinued, or we may want to highlight the `UnitsInStock` value if it is zero.</span></span> <span data-ttu-id="66a45-115">我们在前面的教程中看到，说明如何，GridView，FormView 则提供两种不同的方式来设置格式基于其数据的外观的顾客：</span><span class="sxs-lookup"><span data-stu-id="66a45-115">As we saw in previous tutorials, the GridView, DetailsView, and FormView offer two distinct ways to format their appearance based on their data:</span></span>

- <span data-ttu-id="66a45-116">**`DataBound`事件**创建的事件处理程序的相应`DataBound`触发数据已绑定到每个项之后的事件 (它是 gridview`RowDataBound`事件; 对于 DataList 和转发器中，它将是`ItemDataBound`事件)。</span><span class="sxs-lookup"><span data-stu-id="66a45-116">**The `DataBound` event** create an event handler for the appropriate `DataBound` event, which fires after the data has been bound to each item (for the GridView it was the `RowDataBound` event; for the DataList and Repeater it is the `ItemDataBound` event).</span></span> <span data-ttu-id="66a45-117">这种情况下处理程序中，绑定数据就可以进行检查和格式设置决策产生。</span><span class="sxs-lookup"><span data-stu-id="66a45-117">In that event handler, the data just bound can be examined and formatting decisions made.</span></span> <span data-ttu-id="66a45-118">此方法中的，我们探讨[自定义格式设置基于时数据](../custom-formatting/custom-formatting-based-upon-data-cs.md)教程。</span><span class="sxs-lookup"><span data-stu-id="66a45-118">We examined this technique in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-cs.md) tutorial.</span></span>
- <span data-ttu-id="66a45-119">**格式设置在模板中的函数**时的说明或 GridView 控件或 FormView 控件中的模板中使用 TemplateFields，我们可以将格式设置的函数添加到 ASP.NET 页的代码隐藏类、 业务逻辑层，或任何可从 web 应用程序访问其他类库。</span><span class="sxs-lookup"><span data-stu-id="66a45-119">**Formatting Functions in Templates** when using TemplateFields in the DetailsView or GridView controls, or a template in the FormView control, we can add a formatting function to the ASP.NET page s code-behind class, the Business Logic Layer, or any other class library that is accessible from the web application.</span></span> <span data-ttu-id="66a45-120">此格式设置的函数可以接受任意数目的输入参数，但必须返回模板中呈现的 HTML。</span><span class="sxs-lookup"><span data-stu-id="66a45-120">This formatting function can accept an arbitrary number of input parameters, but must return the HTML to render in the template.</span></span> <span data-ttu-id="66a45-121">格式设置的函数已在第一次检查[GridView 控件中使用 TemplateFields](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md)教程。</span><span class="sxs-lookup"><span data-stu-id="66a45-121">Formatting functions were first examined in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) tutorial.</span></span>

<span data-ttu-id="66a45-122">这两种格式设置的技巧是适用于 DataList 和转发器控件。</span><span class="sxs-lookup"><span data-stu-id="66a45-122">Both of these formatting techniques are available with the DataList and Repeater controls.</span></span> <span data-ttu-id="66a45-123">在本教程中我们将逐步了解两个控件使用这两种技术的示例。</span><span class="sxs-lookup"><span data-stu-id="66a45-123">In this tutorial we'll step through examples using both techniques for both controls.</span></span>

## <a name="using-theitemdataboundevent-handler"></a><span data-ttu-id="66a45-124">使用`ItemDataBound`事件处理程序</span><span class="sxs-lookup"><span data-stu-id="66a45-124">Using the`ItemDataBound`Event Handler</span></span>

<span data-ttu-id="66a45-125">当数据绑定到 DataList，从数据源控件或通过以编程方式将数据分配给控件 s`DataSource`属性和调用其`DataBind()`方法，DataList 的`DataBinding`事件触发时，枚举，数据源并且每个数据记录绑定到 DataList。</span><span class="sxs-lookup"><span data-stu-id="66a45-125">When data is bound to a DataList, either from a data source control or through programmatically assigning data to the control s `DataSource` property and calling its `DataBind()` method, the DataList s `DataBinding` event fires, the data source enumerated, and each data record is bound to the DataList.</span></span> <span data-ttu-id="66a45-126">为数据源中的每个记录，DataList 创建[ `DataListItem` ](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalistitem.aspx)对象，该对象，然后绑定到当前记录。</span><span class="sxs-lookup"><span data-stu-id="66a45-126">For each record in the data source, the DataList creates a [`DataListItem`](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalistitem.aspx) object that is then bound to the current record.</span></span> <span data-ttu-id="66a45-127">在此过程中，DataList 引发两个事件：</span><span class="sxs-lookup"><span data-stu-id="66a45-127">During this process, the DataList raises two events:</span></span>

- <span data-ttu-id="66a45-128">**`ItemCreated`**之后，将引发`DataListItem`已创建</span><span class="sxs-lookup"><span data-stu-id="66a45-128">**`ItemCreated`** fires after the `DataListItem` has been created</span></span>
- <span data-ttu-id="66a45-129">**`ItemDataBound`**当前记录已绑定到之后激发`DataListItem`</span><span class="sxs-lookup"><span data-stu-id="66a45-129">**`ItemDataBound`** fires after the current record has been bound to the `DataListItem`</span></span>

<span data-ttu-id="66a45-130">以下步骤概述 DataList 控件的数据绑定过程。</span><span class="sxs-lookup"><span data-stu-id="66a45-130">The following steps outline the data binding process for the DataList control.</span></span>

1. <span data-ttu-id="66a45-131">DataList s [ `DataBinding`事件](https://msdn.microsoft.com/en-us/library/system.web.ui.control.databinding.aspx)激发</span><span class="sxs-lookup"><span data-stu-id="66a45-131">The DataList s [`DataBinding` event](https://msdn.microsoft.com/en-us/library/system.web.ui.control.databinding.aspx) fires</span></span>
2. <span data-ttu-id="66a45-132">将数据绑定到 DataList</span><span class="sxs-lookup"><span data-stu-id="66a45-132">The data is bound to the DataList</span></span>  
  
 <span data-ttu-id="66a45-133">为数据源中的每个记录</span><span class="sxs-lookup"><span data-stu-id="66a45-133">For each record in the data source</span></span> 

    1. <span data-ttu-id="66a45-134">创建`DataListItem`对象</span><span class="sxs-lookup"><span data-stu-id="66a45-134">Create a `DataListItem` object</span></span>
    2. <span data-ttu-id="66a45-135">激发[`ItemCreated`事件](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.itemcreated.aspx)</span><span class="sxs-lookup"><span data-stu-id="66a45-135">Fire the [`ItemCreated` event](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.itemcreated.aspx)</span></span>
    3. <span data-ttu-id="66a45-136">将绑定到记录`DataListItem`</span><span class="sxs-lookup"><span data-stu-id="66a45-136">Bind the record to the `DataListItem`</span></span>
    4. <span data-ttu-id="66a45-137">激发[`ItemDataBound`事件](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)</span><span class="sxs-lookup"><span data-stu-id="66a45-137">Fire the [`ItemDataBound` event](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)</span></span>
    5. <span data-ttu-id="66a45-138">添加`DataListItem`到`Items`集合</span><span class="sxs-lookup"><span data-stu-id="66a45-138">Add the `DataListItem` to the `Items` collection</span></span>

<span data-ttu-id="66a45-139">将数据绑定到转发器控件，当执行过程通过完全相同的步骤序列。</span><span class="sxs-lookup"><span data-stu-id="66a45-139">When binding data to the Repeater control, it progresses through the exact same sequence of steps.</span></span> <span data-ttu-id="66a45-140">唯一的区别是而不是`DataListItem`正在创建的实例，中继器使用[ `RepeaterItem` ](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s。</span><span class="sxs-lookup"><span data-stu-id="66a45-140">The only difference is that instead of `DataListItem` instances being created, the Repeater uses [`RepeaterItem`](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s.</span></span>

> [!NOTE]
> <span data-ttu-id="66a45-141">敏锐读取器可能已注意到之间的经过 DataList 和转发器绑定到数据而不是当 GridView 绑定到数据时的步骤顺序略异常。</span><span class="sxs-lookup"><span data-stu-id="66a45-141">The astute reader may have noticed a slight anomaly between the sequence of steps that transpire when the DataList and Repeater are bound to data versus when the GridView is bound to data.</span></span> <span data-ttu-id="66a45-142">在数据绑定过程的结尾结束时，引发 GridView`DataBound`事件; 但是，无论是 DataList 还是转发器控件具有此类事件。</span><span class="sxs-lookup"><span data-stu-id="66a45-142">At the tail end of the data binding process, the GridView raises the `DataBound` event; however, neither the DataList nor Repeater control have such an event.</span></span> <span data-ttu-id="66a45-143">这是因为在复制前和后级别事件处理程序模式已成为公共之前 DataList 和转发器控件已回到中 ASP.NET 1.x 的时间范围内，创建。</span><span class="sxs-lookup"><span data-stu-id="66a45-143">This is because the DataList and Repeater controls were created back in the ASP.NET 1.x timeframe, before the pre- and post-level event handler pattern had become common.</span></span>


<span data-ttu-id="66a45-144">格式设置在基于的数据的一个选项是创建的事件处理程序与 GridView，像`ItemDataBound`事件。</span><span class="sxs-lookup"><span data-stu-id="66a45-144">Like with the GridView, one option for formatting based on the data is to create an event handler for the `ItemDataBound` event.</span></span> <span data-ttu-id="66a45-145">此事件处理程序将检查仅具有已绑定到的数据`DataListItem`或`RepeaterItem`而且影响格式化控件，根据需要。</span><span class="sxs-lookup"><span data-stu-id="66a45-145">This event handler would inspect the data that had just been bound to the `DataListItem` or `RepeaterItem` and affect the formatting of the control as needed.</span></span>

<span data-ttu-id="66a45-146">DataList 控件设置格式的更改可以使用实现整个项`DataListItem`s 与样式有关的属性，其中包括标准`Font`， `ForeColor`， `BackColor`， `CssClass`，依次类推。</span><span class="sxs-lookup"><span data-stu-id="66a45-146">For the DataList control, formatting changes for the entire item can be implemented using the `DataListItem` s style-related properties, which include the standard `Font`, `ForeColor`, `BackColor`, `CssClass`, and so on.</span></span> <span data-ttu-id="66a45-147">若要影响 DataList 的模板中的特定 Web 控件的格式设置，我们需要以编程方式访问和修改这些 Web 控件的样式。</span><span class="sxs-lookup"><span data-stu-id="66a45-147">To affect the formatting of particular Web controls within the DataList s template, we need to programmatically access and modify the style of those Web controls.</span></span> <span data-ttu-id="66a45-148">我们已了解如何完成此后在*自定义格式设置基于时数据*教程。</span><span class="sxs-lookup"><span data-stu-id="66a45-148">We saw how to accomplish this back in the *Custom Formatting Based Upon Data* tutorial.</span></span> <span data-ttu-id="66a45-149">与转发器控件中，相似`RepeaterItem`类具有不与样式有关的属性; 因此，所有与样式有关的更改`RepeaterItem`中`ItemDataBound`事件处理程序必须通过以编程方式访问和更新中的 Web 控件模板。</span><span class="sxs-lookup"><span data-stu-id="66a45-149">Like the Repeater control, the `RepeaterItem` class has no style-related properties; therefore, all style-related changes made to a `RepeaterItem` in the `ItemDataBound` event handler must be done by programmatically accessing and updating Web controls within the template.</span></span>

<span data-ttu-id="66a45-150">由于`ItemDataBound`DataList 和转发器的几乎相同，我们的示例将着重介绍如何使用 DataList 格式设置方法。</span><span class="sxs-lookup"><span data-stu-id="66a45-150">Since the `ItemDataBound` formatting technique for the DataList and Repeater are virtually identical, our example will focus on using the DataList.</span></span>

## <a name="step-1-displaying-product-information-in-the-datalist"></a><span data-ttu-id="66a45-151">步骤 1： 在 DataList 中显示产品信息</span><span class="sxs-lookup"><span data-stu-id="66a45-151">Step 1: Displaying Product Information in the DataList</span></span>

<span data-ttu-id="66a45-152">我们担心的格式设置之前，让 s 将首先创建 DataList 用于显示产品信息的页。</span><span class="sxs-lookup"><span data-stu-id="66a45-152">Before we worry about the formatting, let s first create a page that uses a DataList to display product information.</span></span> <span data-ttu-id="66a45-153">在[以前一教程](displaying-data-with-the-datalist-and-repeater-controls-cs.md)我们创建 DataList 其`ItemTemplate`显示每个产品的名称、 类别、 供应商，每个单元和价格数量。</span><span class="sxs-lookup"><span data-stu-id="66a45-153">In the [previous tutorial](displaying-data-with-the-datalist-and-repeater-controls-cs.md) we created a DataList whose `ItemTemplate` displayed each product s name, category, supplier, quantity per unit, and price.</span></span> <span data-ttu-id="66a45-154">允许在本教程中重复此功能下面的 s。</span><span class="sxs-lookup"><span data-stu-id="66a45-154">Let s repeat this functionality here in this tutorial.</span></span> <span data-ttu-id="66a45-155">若要实现此目的，你也可以重新创建 DataList 和从零开始，其 ObjectDataSource 或你可以通过这些控件从前面的教程中创建的页复制 (`Basics.aspx`) 和出于本教程将它们粘贴到页 (`Formatting.aspx`)。</span><span class="sxs-lookup"><span data-stu-id="66a45-155">To accomplish this, you can either recreate the DataList and its ObjectDataSource from scratch, or you can copy over those controls from the page created in the previous tutorial (`Basics.aspx`) and paste them into the page for this tutorial (`Formatting.aspx`).</span></span>

<span data-ttu-id="66a45-156">一旦你已复制的 DataList 功能和 ObjectDataSource 功能从`Basics.aspx`到`Formatting.aspx`，花些时间更改 DataList s`ID`属性从`DataList1`到更具描述性`ItemDataBoundFormattingExample`。</span><span class="sxs-lookup"><span data-stu-id="66a45-156">Once you have replicated the DataList and ObjectDataSource functionality from `Basics.aspx` into `Formatting.aspx`, take a moment to change the DataList s `ID` property from `DataList1` to a more descriptive `ItemDataBoundFormattingExample`.</span></span> <span data-ttu-id="66a45-157">接下来，在浏览器中查看 DataList。</span><span class="sxs-lookup"><span data-stu-id="66a45-157">Next, view the DataList in a browser.</span></span> <span data-ttu-id="66a45-158">如图 1 所示，每个产品之间的唯一格式设置区别是，交替的背景色。</span><span class="sxs-lookup"><span data-stu-id="66a45-158">As Figure 1 shows, the only formatting difference between each product is that the background color alternates.</span></span>


<span data-ttu-id="66a45-159">[![DataList 控件中列出的产品](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image2.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="66a45-159">[![The Products are Listed in the DataList Control](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image2.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image1.png)</span></span>

<span data-ttu-id="66a45-160">**图 1**: DataList 控件中列出的产品 ([单击以查看实际尺寸的图像](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="66a45-160">**Figure 1**: The Products are Listed in the DataList Control ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image3.png))</span></span>


<span data-ttu-id="66a45-161">对于本教程，让我们来格式化 DataList 这样小于 $20.00 价格的任何产品将具有两个其名称，并且单元价格黄色突出显示。</span><span class="sxs-lookup"><span data-stu-id="66a45-161">For this tutorial, let s format the DataList such that any products with a price less than $20.00 will have both its name and unit price highlighted yellow.</span></span>

## <a name="step-2-programmatically-determining-the-value-of-the-data-in-the-itemdatabound-event-handler"></a><span data-ttu-id="66a45-162">步骤 2： 以编程方式确定 ItemDataBound 事件处理程序中的数据的值</span><span class="sxs-lookup"><span data-stu-id="66a45-162">Step 2: Programmatically Determining the Value of the Data in the ItemDataBound Event Handler</span></span>

<span data-ttu-id="66a45-163">由于仅在 $20.00 将价格与这些产品具有应用的自定义格式，因此我们必须能够确定每个产品的价格。</span><span class="sxs-lookup"><span data-stu-id="66a45-163">Since only those products with a price under $20.00 will have the custom formatting applied, we must be able to determine each product s price.</span></span> <span data-ttu-id="66a45-164">当将数据绑定到 DataList，DataList 枚举其数据源中的记录，并对于每个记录，请创建`DataListItem`实例，绑定到数据源记录`DataListItem`。</span><span class="sxs-lookup"><span data-stu-id="66a45-164">When binding data to a DataList, the DataList enumerates the records in its data source and, for each record, creates a `DataListItem` instance, binding the data source record to the `DataListItem`.</span></span> <span data-ttu-id="66a45-165">特定记录 s 数据已绑定到当前`DataListItem`对象，DataList 的`ItemDataBound`激发事件。</span><span class="sxs-lookup"><span data-stu-id="66a45-165">After the particular record s data has been bound to the current `DataListItem` object, the DataList s `ItemDataBound` event is fired.</span></span> <span data-ttu-id="66a45-166">我们可以创建的事件处理程序此事件来检查当前的数据值`DataListItem`和基于这些值，进行必要的任何格式设置的更改。</span><span class="sxs-lookup"><span data-stu-id="66a45-166">We can create an event handler for this event to inspect the data values for the current `DataListItem` and, based upon those values, make any formatting changes necessary.</span></span>

<span data-ttu-id="66a45-167">创建`ItemDataBound`DataList 事件并添加以下代码：</span><span class="sxs-lookup"><span data-stu-id="66a45-167">Create an `ItemDataBound` event for the DataList and add the following code:</span></span>


[!code-csharp[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample1.cs)]

<span data-ttu-id="66a45-168">尽管的概念和语义后面 DataList s`ItemDataBound`事件处理程序都与使用的 GridView s 相同`RowDataBound`中的事件处理程序*自定义格式设置基于时数据*教程中，语法不同稍有。</span><span class="sxs-lookup"><span data-stu-id="66a45-168">While the concept and semantics behind the DataList s `ItemDataBound` event handler are the same as those used by the GridView s `RowDataBound` event handler in the *Custom Formatting Based Upon Data* tutorial, the syntax differs slightly.</span></span> <span data-ttu-id="66a45-169">当`ItemDataBound`事件激发`DataListItem`只绑定到数据传递到相应事件处理程序通过`e.Item`(而不是`e.Row`，如同处理 GridView 的`RowDataBound`事件处理程序)。</span><span class="sxs-lookup"><span data-stu-id="66a45-169">When the `ItemDataBound` event fires, the `DataListItem` just bound to data is passed into corresponding event handler via `e.Item` (instead of `e.Row`, as with the GridView s `RowDataBound` event handler).</span></span> <span data-ttu-id="66a45-170">DataList s`ItemDataBound`个事件处理程序都会激发*每个*添加到 DataList，包括标题行、 页脚行和分隔符行的行。</span><span class="sxs-lookup"><span data-stu-id="66a45-170">The DataList s `ItemDataBound` event handler fires for *each* row added to the DataList, including header rows, footer rows, and separator rows.</span></span> <span data-ttu-id="66a45-171">但是，产品信息仅绑定到的数据行中。</span><span class="sxs-lookup"><span data-stu-id="66a45-171">However, the product information is only bound to the data rows.</span></span> <span data-ttu-id="66a45-172">因此，当使用`ItemDataBound`事件来检查的数据绑定到 DataList，我们需要首先确保我们重新使用的数据项。</span><span class="sxs-lookup"><span data-stu-id="66a45-172">Therefore, when using the `ItemDataBound` event to inspect the data bound to the DataList, we need to first ensure that we re working with a data item.</span></span> <span data-ttu-id="66a45-173">这可以通过检查来实现`DataListItem`s [ `ItemType`属性](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx)，它可以具有之一[以下八个值](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listitemtype.aspx):</span><span class="sxs-lookup"><span data-stu-id="66a45-173">This can be accomplished by checking the `DataListItem` s [`ItemType` property](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx), which can have one of [the following eight values](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listitemtype.aspx):</span></span>

- `AlternatingItem`
- `EditItem`
- `Footer`
- `Header`
- `Item`
- `Pager`
- `SelectedItem`
- `Separator`

<span data-ttu-id="66a45-174">同时`Item`和`AlternatingItem``DataListItem`的构成 DataList 的数据项。</span><span class="sxs-lookup"><span data-stu-id="66a45-174">Both `Item` and `AlternatingItem``DataListItem` s makeup the DataList s data items.</span></span> <span data-ttu-id="66a45-175">假设我们重新使用`Item`或`AlternatingItem`，我们访问实际`ProductsRow`已绑定到当前的实例`DataListItem`。</span><span class="sxs-lookup"><span data-stu-id="66a45-175">Assuming we re working with an `Item` or `AlternatingItem`, we access the actual `ProductsRow` instance that was bound to the current `DataListItem`.</span></span> <span data-ttu-id="66a45-176">`DataListItem` S [ `DataItem`属性](https://msdn.microsoft.com/en-us/system.web.ui.webcontrols.datalistitem.dataitem.aspx)包含对引用`DataRowView`对象，其`Row`属性提供对实际的引用`ProductsRow`对象。</span><span class="sxs-lookup"><span data-stu-id="66a45-176">The `DataListItem` s [`DataItem` property](https://msdn.microsoft.com/en-us/system.web.ui.webcontrols.datalistitem.dataitem.aspx) contains a reference to the `DataRowView` object, whose `Row` property provides a reference to the actual `ProductsRow` object.</span></span>

<span data-ttu-id="66a45-177">接下来，我们检查`ProductsRow`实例的`UnitPrice`属性。</span><span class="sxs-lookup"><span data-stu-id="66a45-177">Next, we check the `ProductsRow` instance s `UnitPrice` property.</span></span> <span data-ttu-id="66a45-178">由于产品表 s`UnitPrice`字段允许`NULL`值，然后再尝试访问`UnitPrice`属性我们应首先检查以查看它是否具有`NULL`值使用`IsUnitPriceNull()`方法。</span><span class="sxs-lookup"><span data-stu-id="66a45-178">Since the Products table s `UnitPrice` field allows `NULL` values, before attempting to access the `UnitPrice` property we should first check to see if it has a `NULL` value using the `IsUnitPriceNull()` method.</span></span> <span data-ttu-id="66a45-179">如果`UnitPrice`值不是`NULL`，我们然后，检查以查看是否它小于 $20.00 s。</span><span class="sxs-lookup"><span data-stu-id="66a45-179">If the `UnitPrice` value is not `NULL`, we then check to see if it s less than $20.00.</span></span> <span data-ttu-id="66a45-180">如果它确实下为 $20.00，我们则需要应用自定义格式设置。</span><span class="sxs-lookup"><span data-stu-id="66a45-180">If it is indeed under $20.00, we then need to apply the custom formatting.</span></span>

## <a name="step-3-highlighting-the-product-s-name-and-price"></a><span data-ttu-id="66a45-181">步骤 3： 突出显示的产品的名称和价格</span><span class="sxs-lookup"><span data-stu-id="66a45-181">Step 3: Highlighting the Product s Name and Price</span></span>

<span data-ttu-id="66a45-182">一旦我们知道产品的价格为小于 $20.00，所有就是突出显示其名称和价格。</span><span class="sxs-lookup"><span data-stu-id="66a45-182">Once we know that a product s price is less than $20.00, all that remains is to highlight its name and price.</span></span> <span data-ttu-id="66a45-183">若要实现此目的，我们必须先以编程方式引用中的标签控件`ItemTemplate`，显示的产品的名称和价格。</span><span class="sxs-lookup"><span data-stu-id="66a45-183">To accomplish this, we must first programmatically reference the Label controls in the `ItemTemplate` that display the product s name and price.</span></span> <span data-ttu-id="66a45-184">接下来，我们需要将其显示黄色背景。</span><span class="sxs-lookup"><span data-stu-id="66a45-184">Next, we need to have them display a yellow background.</span></span> <span data-ttu-id="66a45-185">可以通过直接修改标签应用此格式设置信息`BackColor`属性 (`LabelID.BackColor = Color.Yellow`); 理想情况下，不过，应通过级联样式表中表示所有显示相关的问题。</span><span class="sxs-lookup"><span data-stu-id="66a45-185">This formatting information can be applied by directly modifying the Labels `BackColor` properties (`LabelID.BackColor = Color.Yellow`); ideally, though, all display-related matters should be expressed through cascading stylesheets.</span></span> <span data-ttu-id="66a45-186">实际上，我们已经有提供所需的格式中定义的样式表`Styles.css`  -  `AffordablePriceEmphasis`，其创建和中所述*自定义格式设置基于时数据*教程。</span><span class="sxs-lookup"><span data-stu-id="66a45-186">In fact, we already have a stylesheet that provides the desired formatting defined in `Styles.css` - `AffordablePriceEmphasis`, which was created and discussed in the *Custom Formatting Based Upon Data* tutorial.</span></span>

<span data-ttu-id="66a45-187">若要应用该格式，只需设置两个标签 Web 控件`CssClass`属性设置为`AffordablePriceEmphasis`，如下面的代码中所示：</span><span class="sxs-lookup"><span data-stu-id="66a45-187">To apply the formatting, simply set the two Label Web controls `CssClass` properties to `AffordablePriceEmphasis`, as shown in the following code:</span></span>


[!code-csharp[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample2.cs)]

<span data-ttu-id="66a45-188">与`ItemDataBound`事件处理程序完成后，重新访问`Formatting.aspx`在浏览器中的页。</span><span class="sxs-lookup"><span data-stu-id="66a45-188">With the `ItemDataBound` event handler completed, revisit the `Formatting.aspx` page in a browser.</span></span> <span data-ttu-id="66a45-189">如图 2 所示，且在 $20.00 价格这些产品将具有其名称和突出显示的价格。</span><span class="sxs-lookup"><span data-stu-id="66a45-189">As Figure 2 illustrates, those products with a price under $20.00 have both their name and price highlighted.</span></span>


<span data-ttu-id="66a45-190">[![这些产品小于 $20.00 突出显示](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image5.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="66a45-190">[![Those Products Less than $20.00 are Highlighted](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image5.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image4.png)</span></span>

<span data-ttu-id="66a45-191">**图 2**： 那些产品小于 $20.00 突出显示 ([单击以查看实际尺寸的图像](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="66a45-191">**Figure 2**: Those Products Less than $20.00 are Highlighted ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image6.png))</span></span>


> [!NOTE]
> <span data-ttu-id="66a45-192">由于 DataList 呈现为 HTML `<table>`，将其`DataListItem`实例具有与样式有关的属性，可设置为特定样式应用到整个项。</span><span class="sxs-lookup"><span data-stu-id="66a45-192">Since the DataList is rendered as an HTML `<table>`, its `DataListItem` instances have style-related properties that can be set to apply a specific style to the entire item.</span></span> <span data-ttu-id="66a45-193">例如，如果我们想要突出显示*整个*项在其价格不小于 $20.00 黄色，我们无法具有替代引用标签的代码并设置其`CssClass`具有以下代码行的属性： `e.Item.CssClass = "AffordablePriceEmphasis"`（请参见图 3）。</span><span class="sxs-lookup"><span data-stu-id="66a45-193">For example, if we wanted to highlight the *entire* item yellow when its price was less than $20.00, we could have replaced the code that referenced the Labels and set their `CssClass` properties with the following line of code: `e.Item.CssClass = "AffordablePriceEmphasis"` (see Figure 3).</span></span>


<span data-ttu-id="66a45-194">`RepeaterItem`构成转发器控件，但是，don t s 提供此类样式级别属性。</span><span class="sxs-lookup"><span data-stu-id="66a45-194">The `RepeaterItem` s that make up the Repeater control, however, don t offer such style-level properties.</span></span> <span data-ttu-id="66a45-195">因此，应用自定义格式设置为转发器需要在转发器的模板中的 Web 控件的样式属性的应用程序就像我们未在图 2 中一样。</span><span class="sxs-lookup"><span data-stu-id="66a45-195">Therefore, applying custom formatting to the Repeater requires the application of style properties to the Web controls within the Repeater s templates, just like we did in Figure 2.</span></span>


<span data-ttu-id="66a45-196">[![有关产品在 $20.00 突出显示整个产品项](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image8.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="66a45-196">[![The Entire Product Item is Highlighted for Products Under $20.00](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image8.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image7.png)</span></span>

<span data-ttu-id="66a45-197">**图 3**: 整个产品项被标记为产品下 $20.00 ([单击以查看实际尺寸的图像](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="66a45-197">**Figure 3**: The Entire Product Item is Highlighted for Products Under $20.00 ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image9.png))</span></span>


## <a name="using-formatting-functions-from-within-the-template"></a><span data-ttu-id="66a45-198">使用从模板中的格式设置函数</span><span class="sxs-lookup"><span data-stu-id="66a45-198">Using Formatting Functions from Within the Template</span></span>

<span data-ttu-id="66a45-199">在*GridView 控件中使用 TemplateFields*教程，我们已了解如何使用格式设置在函数内 GridView TemplateField 应用自定义格式取决于的数据绑定到 GridView 的行。</span><span class="sxs-lookup"><span data-stu-id="66a45-199">In the *Using TemplateFields in the GridView Control* tutorial we saw how to use a formatting function within a GridView TemplateField to apply custom formatting based upon the data bound to the GridView s rows.</span></span> <span data-ttu-id="66a45-200">格式设置的函数是可以从模板调用并返回 HTML 中以在其位置中发出的方法。</span><span class="sxs-lookup"><span data-stu-id="66a45-200">A formatting function is a method that can be invoked from a template and returns the HTML to be emitted in its place.</span></span> <span data-ttu-id="66a45-201">格式设置的函数可以驻留在 ASP.NET 页的代码隐藏类或到中的类文件可以集中式`App_Code`文件夹或在单独的类库项目。</span><span class="sxs-lookup"><span data-stu-id="66a45-201">Formatting functions can reside in the ASP.NET page s code-behind class or can be centralized into class files in the `App_Code` folder or in a separate Class Library project.</span></span> <span data-ttu-id="66a45-202">移动从 ASP.NET 页的代码隐藏类格式设置的函数是理想的如果你打算在其他 ASP.NET web 应用程序或多个 ASP.NET 页中使用相同的格式设置功能。</span><span class="sxs-lookup"><span data-stu-id="66a45-202">Moving the formatting function out of the ASP.NET page s code-behind class is ideal if you plan on using the same formatting function in multiple ASP.NET pages or in other ASP.NET web applications.</span></span>

<span data-ttu-id="66a45-203">为了演示格式设置函数，让 s 的产品的名称旁边包含文本 [已中断]，如果产品信息它停止使用的 s。</span><span class="sxs-lookup"><span data-stu-id="66a45-203">To demonstrate formatting functions, let s have the product information include the text [DISCONTINUED] next to the product s name if it s discontinued.</span></span> <span data-ttu-id="66a45-204">此外，让 s 具有价格突出显示黄色如果它 s 小于 $20.00 (正如我们做`ItemDataBound`事件处理程序示例); 如果价格为 $20.00 或更高版本，但仍使 s 不显示实际的价格，但文本，请改为调用价格引用。</span><span class="sxs-lookup"><span data-stu-id="66a45-204">Also, let s have the price highlighted yellow if it s less than $20.00 (as we did in the `ItemDataBound` event handler example); if the price is $20.00 or higher, let s not display the actual price, but instead the text, Please call for a price quote.</span></span> <span data-ttu-id="66a45-205">图 4 显示列出这些应用的格式设置规则的产品的屏幕截图。</span><span class="sxs-lookup"><span data-stu-id="66a45-205">Figure 4 shows a screen shot of the products listing with these formatting rules applied.</span></span>


<span data-ttu-id="66a45-206">[![对于昂贵的产品，价格替换的文本，请调用价格引用](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image11.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="66a45-206">[![For Expensive Products, the Price is Replaced with the Text, Please call for a price quote](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image11.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image10.png)</span></span>

<span data-ttu-id="66a45-207">**图 4**： 对于昂贵的产品，价格替换的文本，请调用针对一个价格的报价 ([单击以查看实际尺寸的图像](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="66a45-207">**Figure 4**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image12.png))</span></span>


## <a name="step-1-create-the-formatting-functions"></a><span data-ttu-id="66a45-208">步骤 1： 创建格式设置的函数</span><span class="sxs-lookup"><span data-stu-id="66a45-208">Step 1: Create the Formatting Functions</span></span>

<span data-ttu-id="66a45-209">有关格式设置的两个函数、 一个显示产品名称以及文本 [已中断]，如果需要而另一个，我们需要此示例，显示突出显示的价格，如果它 s 小于 $20.00，还是的文本，否则为报价的请调用。</span><span class="sxs-lookup"><span data-stu-id="66a45-209">For this example we need two formatting functions, one that displays the product name along with the text [DISCONTINUED], if needed, and another that displays either a highlighted price if it s less than $20.00, or the text, Please call for a price quote otherwise.</span></span> <span data-ttu-id="66a45-210">让我们来创建这些函数在 ASP.NET 页的代码隐藏类并将它们命名`DisplayProductNameAndDiscontinuedStatus`和`DisplayPrice`。</span><span class="sxs-lookup"><span data-stu-id="66a45-210">Let s create these functions in the ASP.NET page s code-behind class and name them `DisplayProductNameAndDiscontinuedStatus` and `DisplayPrice`.</span></span> <span data-ttu-id="66a45-211">这两种方法需要返回 HTML 中以将呈现为一个字符串，同时需要标记`Protected`(或`Public`) 才能从 ASP.NET 页 s 声明性语法部分中进行调用。</span><span class="sxs-lookup"><span data-stu-id="66a45-211">Both methods need to return the HTML to render as a string and both need to be marked `Protected` (or `Public`) in order to be invoked from the ASP.NET page s declarative syntax portion.</span></span> <span data-ttu-id="66a45-212">这两种方法的代码如下所示：</span><span class="sxs-lookup"><span data-stu-id="66a45-212">The code for these two methods follows:</span></span>


[!code-csharp[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample3.cs)]

<span data-ttu-id="66a45-213">请注意，`DisplayProductNameAndDiscontinuedStatus`方法接受的值`productName`和`discontinued`而将数据字段为标量值、`DisplayPrice`方法接受`ProductsRow`实例 (而不是`unitPrice`标量值)。</span><span class="sxs-lookup"><span data-stu-id="66a45-213">Note that the `DisplayProductNameAndDiscontinuedStatus` method accepts the values of the `productName` and `discontinued` data fields as scalar values, whereas the `DisplayPrice` method accepts a `ProductsRow` instance (rather than a `unitPrice` scalar value).</span></span> <span data-ttu-id="66a45-214">将使用这两种方法; 如果但是，如果将格式设置的函数使用可以包含数据库的标量值`NULL`值 (如`UnitPrice`; 既不`ProductName`也不`Discontinued`允许`NULL`值)，格外小心，必须在处理这些标量输入。</span><span class="sxs-lookup"><span data-stu-id="66a45-214">Either approach will work; however, if the formatting function is working with scalar values that can contain database `NULL` values (such as `UnitPrice`; neither `ProductName` nor `Discontinued` allow `NULL` values), special care must be taken in handling these scalar inputs.</span></span>

<span data-ttu-id="66a45-215">具体而言，输入的参数必须为类型`Object`因为传入的值可能`DBNull`而不是预期的数据类型的实例。</span><span class="sxs-lookup"><span data-stu-id="66a45-215">In particular, the input parameter must be of type `Object` since the incoming value might be a `DBNull` instance instead of the expected data type.</span></span> <span data-ttu-id="66a45-216">此外，必须进行检查以确定传入的值是否为数据库`NULL`值。</span><span class="sxs-lookup"><span data-stu-id="66a45-216">Additionally, a check must be made to determine whether or not the incoming value is a database `NULL` value.</span></span> <span data-ttu-id="66a45-217">也就是说，如果我们想`DisplayPrice`方法，以接受价格为标量值，d 我们必须使用下面的代码：</span><span class="sxs-lookup"><span data-stu-id="66a45-217">That is, if we wanted the `DisplayPrice` method to accept the price as a scalar value, we d have to use the following code:</span></span>


[!code-csharp[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample4.cs)]

<span data-ttu-id="66a45-218">请注意，`unitPrice`输入的参数属于类型`Object`且条件语句进行了修改，以确定如果`unitPrice`是`DBNull`与否。</span><span class="sxs-lookup"><span data-stu-id="66a45-218">Note that the `unitPrice` input parameter is of type `Object` and that the conditional statement has been modified to ascertain if `unitPrice` is `DBNull` or not.</span></span> <span data-ttu-id="66a45-219">此外，由于`unitPrice`作为输入的参数传递中`Object`，必须强制转换为十进制值。</span><span class="sxs-lookup"><span data-stu-id="66a45-219">Furthermore, since the `unitPrice` input parameter is passed in as an `Object`, it must be cast to a decimal value.</span></span>

## <a name="step-2-calling-the-formatting-function-from-the-datalist-s-itemtemplate"></a><span data-ttu-id="66a45-220">步骤 2： 从 DataList 的 ItemTemplate 调用格式设置的函数</span><span class="sxs-lookup"><span data-stu-id="66a45-220">Step 2: Calling the Formatting Function from the DataList s ItemTemplate</span></span>

<span data-ttu-id="66a45-221">使用格式设置的函数添加到 ASP.NET 页的代码隐藏类，剩下的就是调用这些格式函数从 DataList 的`ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="66a45-221">With the formatting functions added to our ASP.NET page s code-behind class, all that remains is to invoke these formatting functions from the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="66a45-222">若要从模板调用的格式设置函数，将数据绑定语法中的函数调用：</span><span class="sxs-lookup"><span data-stu-id="66a45-222">To call a formatting function from a template, place the function call within the databinding syntax:</span></span>


[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample5.aspx)]

<span data-ttu-id="66a45-223">在 DataList s `ItemTemplate` `ProductNameLabel`标签 Web 控件当前显示的产品的名称通过分配其`Text`属性结果的`<%# Eval("ProductName") %>`。</span><span class="sxs-lookup"><span data-stu-id="66a45-223">In the DataList s `ItemTemplate` the `ProductNameLabel` Label Web control currently displays the product s name by assigning its `Text` property the result of `<%# Eval("ProductName") %>`.</span></span> <span data-ttu-id="66a45-224">为了让其显示名称和文本 [已中断]，如果需要更新的声明性语法，以便它改为将分配`Text`属性值的`DisplayProductNameAndDiscontinuedStatus`方法。</span><span class="sxs-lookup"><span data-stu-id="66a45-224">In order to have it display the name plus the text [DISCONTINUED], if needed, update the declarative syntax so that it instead assigns the `Text` property the value of the `DisplayProductNameAndDiscontinuedStatus` method.</span></span> <span data-ttu-id="66a45-225">时这样做，我们必须传递中的产品的名称和不再使用的值使用`Eval("columnName")`语法。</span><span class="sxs-lookup"><span data-stu-id="66a45-225">When doing so, we must pass in the product s name and discontinued values using the `Eval("columnName")` syntax.</span></span> <span data-ttu-id="66a45-226">`Eval`返回类型的值`Object`，但`DisplayProductNameAndDiscontinuedStatus`方法需要输入的参数的类型`String`和`Boolean`; 因此，我们必须强制转换返回的值`Eval`到预期的输入的参数类型，方法如下所示：</span><span class="sxs-lookup"><span data-stu-id="66a45-226">`Eval` returns a value of type `Object`, but the `DisplayProductNameAndDiscontinuedStatus` method expects input parameters of type `String` and `Boolean`; therefore, we must cast the values returned by the `Eval` method to the expected input parameter types, like so:</span></span>


[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample6.aspx)]

<span data-ttu-id="66a45-227">若要显示的价格，我们只需可以设置`UnitPriceLabel`标签 s`Text`属性返回的值`DisplayPrice`方法，就像我们未用于显示产品的名称和 [停用] 文本。</span><span class="sxs-lookup"><span data-stu-id="66a45-227">To display the price, we can simply set the `UnitPriceLabel` Label s `Text` property to the value returned by the `DisplayPrice` method, just like we did for displaying the product s name and [DISCONTINUED] text.</span></span> <span data-ttu-id="66a45-228">但是，而不是传入`UnitPrice`作为标量的输入参数，我们改为传入整个`ProductsRow`实例：</span><span class="sxs-lookup"><span data-stu-id="66a45-228">However, instead of passing in the `UnitPrice` as a scalar input parameter, we instead pass in the entire `ProductsRow` instance:</span></span>


[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample7.aspx)]

<span data-ttu-id="66a45-229">与对就地格式设置的函数调用中，需要花费一段时间来在浏览器中查看我们的进度。</span><span class="sxs-lookup"><span data-stu-id="66a45-229">With the calls to the formatting functions in place, take a moment to view our progress in a browser.</span></span> <span data-ttu-id="66a45-230">你的屏幕应类似于图 5： 使用停产的产品包括文本 [已中断]，多个 $20.00 具有其价格的成本计算这些产品替换文本请价格引号的调用。</span><span class="sxs-lookup"><span data-stu-id="66a45-230">Your screen should look similar to Figure 5, with the discontinued products including the text [DISCONTINUED] and those products costing more than $20.00 having their price replaced with the text Please call for a price quote .</span></span>


<span data-ttu-id="66a45-231">[![对于昂贵的产品，价格替换的文本，请调用价格引用](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image14.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="66a45-231">[![For Expensive Products, the Price is Replaced with the Text, Please call for a price quote](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image14.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image13.png)</span></span>

<span data-ttu-id="66a45-232">**图 5**： 对于昂贵的产品，价格替换的文本，请调用针对一个价格的报价 ([单击以查看实际尺寸的图像](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="66a45-232">**Figure 5**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image15.png))</span></span>


## <a name="summary"></a><span data-ttu-id="66a45-233">摘要</span><span class="sxs-lookup"><span data-stu-id="66a45-233">Summary</span></span>

<span data-ttu-id="66a45-234">可以使用两项技术实现格式设置取决于数据 DataList 或转发器控件的内容。</span><span class="sxs-lookup"><span data-stu-id="66a45-234">Formatting the contents of a DataList or Repeater control based upon the data can be accomplished using two techniques.</span></span> <span data-ttu-id="66a45-235">第一种方法是创建的事件处理程序`ItemDataBound`触发的事件，如数据源中的每个记录绑定到一个新`DataListItem`或`RepeaterItem`。</span><span class="sxs-lookup"><span data-stu-id="66a45-235">The first technique is to create an event handler for the `ItemDataBound` event, which fires as each record in the data source is bound to a new `DataListItem` or `RepeaterItem`.</span></span> <span data-ttu-id="66a45-236">在`ItemDataBound`事件处理程序，可以检查当前的 s 项数据，然后格式设置可应用于的内容的模板，或者，对于`DataListItem`s，到整个项本身。</span><span class="sxs-lookup"><span data-stu-id="66a45-236">In the `ItemDataBound` event handler, the current item s data can be examined and then formatting can be applied to the contents of the template or, for `DataListItem` s, to the entire item itself.</span></span>

<span data-ttu-id="66a45-237">或者，完成格式化函数实现自定义格式设置。</span><span class="sxs-lookup"><span data-stu-id="66a45-237">Alternatively, custom formatting can be realized through formatting functions.</span></span> <span data-ttu-id="66a45-238">格式设置函数是可以从 DataList 调用的方法或转发器的模板返回 HTML 中以在其位置中发出。</span><span class="sxs-lookup"><span data-stu-id="66a45-238">A formatting function is a method that can be invoked from the DataList or Repeater s templates that returns the HTML to emit in its place.</span></span> <span data-ttu-id="66a45-239">通常情况下，由绑定到当前项的值确定格式设置的函数返回的 HTML。</span><span class="sxs-lookup"><span data-stu-id="66a45-239">Often, the HTML returned by a formatting function is determined by the values being bound to the current item.</span></span> <span data-ttu-id="66a45-240">这些值可以传递到格式设置的函数、，用作的标量值或通过传入绑定到项的整个对象 (如`ProductsRow`实例)。</span><span class="sxs-lookup"><span data-stu-id="66a45-240">These values can be passed into the formatting function, either as scalar values or by passing in the entire object being bound to the item (such as the `ProductsRow` instance).</span></span>

<span data-ttu-id="66a45-241">尽情享受编程 ！</span><span class="sxs-lookup"><span data-stu-id="66a45-241">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="66a45-242">关于作者</span><span class="sxs-lookup"><span data-stu-id="66a45-242">About the Author</span></span>

<span data-ttu-id="66a45-243">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七个 ASP/ASP.NET 书籍和的创始人[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年使用与 Microsoft Web 技术。</span><span class="sxs-lookup"><span data-stu-id="66a45-243">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="66a45-244">Scott 的作用是作为独立的顾问、 培训师和编写器。</span><span class="sxs-lookup"><span data-stu-id="66a45-244">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="66a45-245">最新书籍是[ *Sam 教授自己 ASP.NET 2.0 24 小时内*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="66a45-245">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="66a45-246">他可以达到在[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)或通过他的博客，其中可以找到在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="66a45-246">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="66a45-247">特别感谢</span><span class="sxs-lookup"><span data-stu-id="66a45-247">Special Thanks To</span></span>

<span data-ttu-id="66a45-248">本教程系列已由许多有用的审阅者评审。</span><span class="sxs-lookup"><span data-stu-id="66a45-248">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="66a45-249">本教程中的前导审阅者已 Yaakov Ellis、 徐 Schmidt 和沈 Shulok。</span><span class="sxs-lookup"><span data-stu-id="66a45-249">Lead reviewers for this tutorial were Yaakov Ellis, Randy Schmidt, and Liz Shulok.</span></span> <span data-ttu-id="66a45-250">对感兴趣查看我即将到来的 MSDN 文章？</span><span class="sxs-lookup"><span data-stu-id="66a45-250">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="66a45-251">如果是这样，删除我一行[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="66a45-251">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="66a45-252">[上一页](displaying-data-with-the-datalist-and-repeater-controls-cs.md)
[下一页](showing-multiple-records-per-row-with-the-datalist-control-cs.md)</span><span class="sxs-lookup"><span data-stu-id="66a45-252">[Previous](displaying-data-with-the-datalist-and-repeater-controls-cs.md)
[Next](showing-multiple-records-per-row-with-the-datalist-control-cs.md)</span></span>
