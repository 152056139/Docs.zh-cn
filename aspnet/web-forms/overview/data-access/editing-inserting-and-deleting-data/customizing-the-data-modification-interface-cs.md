---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs
title: 自定义的数据修改界面 (C#) |Microsoft 文档
author: rick-anderson
description: 在本教程中我们将查看如何通过替换标准的文本框中自定义的可编辑的 GridView，接口和复选框控件 alternati...
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/17/2006
ms.topic: article
ms.assetid: 22e99600-8d18-4a94-a20e-a3a62bb63798
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs
msc.type: authoredcontent
ms.openlocfilehash: f25b265c50870d59721a94c01d78f589a5d5f1c3
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/06/2018
---
<a name="customizing-the-data-modification-interface-c"></a><span data-ttu-id="e63f7-103">自定义的数据修改界面 (C#)</span><span class="sxs-lookup"><span data-stu-id="e63f7-103">Customizing the Data Modification Interface (C#)</span></span>
====================
<span data-ttu-id="e63f7-104">通过[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e63f7-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e63f7-105">[下载示例应用程序](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_20_CS.exe)或[下载 PDF](customizing-the-data-modification-interface-cs/_static/datatutorial20cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="e63f7-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_20_CS.exe) or [Download PDF](customizing-the-data-modification-interface-cs/_static/datatutorial20cs1.pdf)</span></span>

> <span data-ttu-id="e63f7-106">在本教程中我们将查看如何通过替换标准的文本框中自定义的可编辑的 GridView，接口和复选框控件与备用输入的 Web 控件。</span><span class="sxs-lookup"><span data-stu-id="e63f7-106">In this tutorial we'll look at how to customize the interface of an editable GridView, by replacing the standard TextBox and CheckBox controls with alternative input Web controls.</span></span>


## <a name="introduction"></a><span data-ttu-id="e63f7-107">介绍</span><span class="sxs-lookup"><span data-stu-id="e63f7-107">Introduction</span></span>

<span data-ttu-id="e63f7-108">BoundFields 和 CheckBoxFields GridView 和说明如何控件所使用的简化修改由于其能够呈现只读的、 可编辑，以及可插入接口的数据的过程。</span><span class="sxs-lookup"><span data-stu-id="e63f7-108">The BoundFields and CheckBoxFields used by the GridView and DetailsView controls simplify the process of modifying data due to their ability to render read-only, editable, and insertable interfaces.</span></span> <span data-ttu-id="e63f7-109">无需添加任何附加的声明性标记或代码，可以呈现这些接口。</span><span class="sxs-lookup"><span data-stu-id="e63f7-109">These interfaces can be rendered without the need for adding any additional declarative markup or code.</span></span> <span data-ttu-id="e63f7-110">但是，BoundField 和 CheckBoxField 的接口缺少通常需要在实际方案中可定制性。</span><span class="sxs-lookup"><span data-stu-id="e63f7-110">However, the BoundField and CheckBoxField's interfaces lack the customizability often needed in real-world scenarios.</span></span> <span data-ttu-id="e63f7-111">为了自定义可编辑或可插入界面 GridView 或说明中的，我们需要改用 TemplateField。</span><span class="sxs-lookup"><span data-stu-id="e63f7-111">In order to customize the editable or insertable interface in a GridView or DetailsView we need to instead use a TemplateField.</span></span>

<span data-ttu-id="e63f7-112">在[前面教程](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md)我们已了解如何通过添加验证 Web 控件自定义的数据修改接口。</span><span class="sxs-lookup"><span data-stu-id="e63f7-112">In the [preceding tutorial](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) we saw how to customize the data modification interfaces by adding validation Web controls.</span></span> <span data-ttu-id="e63f7-113">在本教程中我们将查看如何自定义的实际数据集合 Web 控件，替换 BoundField 和 CheckBoxField 的标准文本框和复选框控件与备用输入的 Web 控件。</span><span class="sxs-lookup"><span data-stu-id="e63f7-113">In this tutorial we'll look at how to customize the actual data collection Web controls, replacing the BoundField and CheckBoxField's standard TextBox and CheckBox controls with alternative input Web controls.</span></span> <span data-ttu-id="e63f7-114">具体而言，我们生成了允许的产品名称、 类别、 供应商和不再使用的状态要更新的可编辑 GridView。</span><span class="sxs-lookup"><span data-stu-id="e63f7-114">In particular, we'll build an editable GridView that allows a product's name, category, supplier, and discontinued status to be updated.</span></span> <span data-ttu-id="e63f7-115">在编辑的特定行时，类别和供应商字段将呈现为 DropDownLists 中,，包含的一套可用类别和供应商可供选择。</span><span class="sxs-lookup"><span data-stu-id="e63f7-115">When editing a particular row, the category and supplier fields will render as DropDownLists, containing the set of available categories and suppliers to choose from.</span></span> <span data-ttu-id="e63f7-116">此外，我们会将提供两个选项的说明如何控件替换的 CheckBoxField 的默认复选框:"活动"和"停止"。</span><span class="sxs-lookup"><span data-stu-id="e63f7-116">Furthermore, we'll replace the CheckBoxField's default CheckBox with a RadioButtonList control that offers two options: "Active" and "Discontinued".</span></span>


<span data-ttu-id="e63f7-117">[![GridView 的编辑界面包括 DropDownLists 和单选按钮](customizing-the-data-modification-interface-cs/_static/image2.png)](customizing-the-data-modification-interface-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e63f7-117">[![The GridView's Editing Interface Includes DropDownLists and RadioButtons](customizing-the-data-modification-interface-cs/_static/image2.png)](customizing-the-data-modification-interface-cs/_static/image1.png)</span></span>

<span data-ttu-id="e63f7-118">**图 1**: GridView 编辑接口包括 DropDownLists 和单选按钮 ([单击以查看实际尺寸的图像](customizing-the-data-modification-interface-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="e63f7-118">**Figure 1**: The GridView's Editing Interface Includes DropDownLists and RadioButtons ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image3.png))</span></span>


## <a name="step-1-creating-the-appropriateupdateproductoverload"></a><span data-ttu-id="e63f7-119">步骤 1： 创建相应`UpdateProduct`重载</span><span class="sxs-lookup"><span data-stu-id="e63f7-119">Step 1: Creating the Appropriate`UpdateProduct`Overload</span></span>

<span data-ttu-id="e63f7-120">在本教程中我们将生成可编辑的 GridView，允许编辑的产品的名称、 类别、 供应商，并停止使用状态。</span><span class="sxs-lookup"><span data-stu-id="e63f7-120">In this tutorial we will build an editable GridView that permits editing of a product's name, category, supplier, and discontinued status.</span></span> <span data-ttu-id="e63f7-121">因此，我们需要`UpdateProduct`接受这些四个产品值由五个输入参数的重载加上`ProductID`。</span><span class="sxs-lookup"><span data-stu-id="e63f7-121">Therefore, we need an `UpdateProduct` overload that accepts five input parameters these four product values plus the `ProductID`.</span></span> <span data-ttu-id="e63f7-122">我们前面的重载，这样一个中的类似内容：</span><span class="sxs-lookup"><span data-stu-id="e63f7-122">Like in our previous overloads, this one will:</span></span>

1. <span data-ttu-id="e63f7-123">从指定的数据库中检索产品信息`ProductID`，</span><span class="sxs-lookup"><span data-stu-id="e63f7-123">Retrieve the product information from the database for the specified `ProductID`,</span></span>
2. <span data-ttu-id="e63f7-124">更新`ProductName`， `CategoryID`， `SupplierID`，和`Discontinued`字段，并</span><span class="sxs-lookup"><span data-stu-id="e63f7-124">Update the `ProductName`, `CategoryID`, `SupplierID`, and `Discontinued` fields, and</span></span>
3. <span data-ttu-id="e63f7-125">将更新请求发送到通过 TableAdapter 的 DAL`Update()`方法。</span><span class="sxs-lookup"><span data-stu-id="e63f7-125">Send the update request to the DAL through the TableAdapter's `Update()` method.</span></span>

<span data-ttu-id="e63f7-126">为简洁起见，此特定重载我已省略业务规则检查，以确保被标记为停止使用的产品不由其供应商提供的唯一产品。</span><span class="sxs-lookup"><span data-stu-id="e63f7-126">For brevity, for this particular overload I've omitted the business rule check that ensures a product being marked as discontinued isn't the only product offered by its supplier.</span></span> <span data-ttu-id="e63f7-127">随意添加中，如果你愿意，或者，理想情况下，出到单独的方法的逻辑的重构。</span><span class="sxs-lookup"><span data-stu-id="e63f7-127">Feel free to add it in if you prefer, or, ideally, refactor out the logic to a separate method.</span></span>

<span data-ttu-id="e63f7-128">下面的代码演示新`UpdateProduct`重载中`ProductsBLL`类：</span><span class="sxs-lookup"><span data-stu-id="e63f7-128">The following code shows the new `UpdateProduct` overload in the `ProductsBLL` class:</span></span>


[!code-csharp[Main](customizing-the-data-modification-interface-cs/samples/sample1.cs)]

## <a name="step-2-crafting-the-editable-gridview"></a><span data-ttu-id="e63f7-129">步骤 2： 编写可编辑的 GridView</span><span class="sxs-lookup"><span data-stu-id="e63f7-129">Step 2: Crafting the Editable GridView</span></span>

<span data-ttu-id="e63f7-130">与`UpdateProduct`重载添加，我们已准备好创建我们可编辑的 GridView。</span><span class="sxs-lookup"><span data-stu-id="e63f7-130">With the `UpdateProduct` overload added, we're ready to create our editable GridView.</span></span> <span data-ttu-id="e63f7-131">打开`CustomizedUI.aspx`页面`EditInsertDelete`文件夹并将 GridView 控件添加到设计器。</span><span class="sxs-lookup"><span data-stu-id="e63f7-131">Open the `CustomizedUI.aspx` page in the `EditInsertDelete` folder and add a GridView control to the Designer.</span></span> <span data-ttu-id="e63f7-132">从 GridView 的智能标记，接下来，创建新对象数据源。</span><span class="sxs-lookup"><span data-stu-id="e63f7-132">Next, create a new ObjectDataSource from the GridView's smart tag.</span></span> <span data-ttu-id="e63f7-133">配置对象数据源以检索产品信息通过`ProductBLL`类的`GetProducts()`方法，并更新产品数据使用`UpdateProduct`我们刚刚创建的重载。</span><span class="sxs-lookup"><span data-stu-id="e63f7-133">Configure the ObjectDataSource to retrieve product information via the `ProductBLL` class's `GetProducts()` method and to update product data using the `UpdateProduct` overload we just created.</span></span> <span data-ttu-id="e63f7-134">从的插入和删除选项卡，从下拉列表中选择 （无）。</span><span class="sxs-lookup"><span data-stu-id="e63f7-134">From the INSERT and DELETE tabs, select (None) from the drop-down lists.</span></span>


<span data-ttu-id="e63f7-135">[![配置对象数据源以使用刚刚创建的 UpdateProduct 重载](customizing-the-data-modification-interface-cs/_static/image5.png)](customizing-the-data-modification-interface-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="e63f7-135">[![Configure the ObjectDataSource to Use the UpdateProduct Overload Just Created](customizing-the-data-modification-interface-cs/_static/image5.png)](customizing-the-data-modification-interface-cs/_static/image4.png)</span></span>

<span data-ttu-id="e63f7-136">**图 2**： 配置使用 ObjectDataSource`UpdateProduct`重载刚刚创建 ([单击以查看实际尺寸的图像](customizing-the-data-modification-interface-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="e63f7-136">**Figure 2**: Configure the ObjectDataSource to Use the `UpdateProduct` Overload Just Created ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image6.png))</span></span>


<span data-ttu-id="e63f7-137">如我们所见整个数据修改教程，Visual Studio 创建 ObjectDataSource 的声明性语法将分配`OldValuesParameterFormatString`属性`original_{0}`。</span><span class="sxs-lookup"><span data-stu-id="e63f7-137">As we've seen throughout the data modification tutorials, the declarative syntax for the ObjectDataSource created by Visual Studio assigns the `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="e63f7-138">此操作，请当然，不会使用我们的业务逻辑层由于我们方法不需要原始`ProductID`要在中传递的值。</span><span class="sxs-lookup"><span data-stu-id="e63f7-138">This, of course, won't work with our Business Logic Layer since our methods don't expect the original `ProductID` value to be passed in.</span></span> <span data-ttu-id="e63f7-139">因此，随着我们在前面的教程中，需花费一段时间来删除此属性分配的声明性语法，或相反，将此属性的值设置为`{0}`。</span><span class="sxs-lookup"><span data-stu-id="e63f7-139">Therefore, as we've done in previous tutorials, take a moment to remove this property assignment from the declarative syntax or, instead, set this property's value to `{0}`.</span></span>

<span data-ttu-id="e63f7-140">此更改之后 ObjectDataSource 的声明性标记应如下所示：</span><span class="sxs-lookup"><span data-stu-id="e63f7-140">After this change, the ObjectDataSource's declarative markup should look like the following:</span></span>


[!code-aspx[Main](customizing-the-data-modification-interface-cs/samples/sample2.aspx)]

<span data-ttu-id="e63f7-141">请注意，`OldValuesParameterFormatString`属性已删除，以及是否有`Parameter`中`UpdateParameters`为每个所需的输入参数的集合我们`UpdateProduct`重载。</span><span class="sxs-lookup"><span data-stu-id="e63f7-141">Note that the `OldValuesParameterFormatString` property has been removed and that there is a `Parameter` in the `UpdateParameters` collection for each of the input parameters expected by our `UpdateProduct` overload.</span></span>

<span data-ttu-id="e63f7-142">尽管对象数据源配置为更新产品值的一个子集，当前显示 GridView*所有*的产品字段。</span><span class="sxs-lookup"><span data-stu-id="e63f7-142">While the ObjectDataSource is configured to update only a subset of product values, the GridView currently shows *all* of the product fields.</span></span> <span data-ttu-id="e63f7-143">花些时间编辑 GridView，以便：</span><span class="sxs-lookup"><span data-stu-id="e63f7-143">Take a moment to edit the GridView so that:</span></span>

- <span data-ttu-id="e63f7-144">它只包括`ProductName`， `SupplierName`， `CategoryName` BoundFields 和`Discontinued`CheckBoxField</span><span class="sxs-lookup"><span data-stu-id="e63f7-144">It only includes the `ProductName`, `SupplierName`, `CategoryName` BoundFields and the `Discontinued` CheckBoxField</span></span>
- <span data-ttu-id="e63f7-145">`CategoryName`和`SupplierName`字段 （左侧） 之前出现`Discontinued`CheckBoxField</span><span class="sxs-lookup"><span data-stu-id="e63f7-145">The `CategoryName` and `SupplierName` fields to appear before (to the left of) the `Discontinued` CheckBoxField</span></span>
- <span data-ttu-id="e63f7-146">`CategoryName`和`SupplierName`BoundFields 的`HeaderText`属性分别设置为"类别"和"供应商"</span><span class="sxs-lookup"><span data-stu-id="e63f7-146">The `CategoryName` and `SupplierName` BoundFields' `HeaderText` property is set to "Category" and "Supplier", respectively</span></span>
- <span data-ttu-id="e63f7-147">启用编辑支持 （请检查 GridView 的智能标记中的启用编辑复选框）</span><span class="sxs-lookup"><span data-stu-id="e63f7-147">Editing support is enabled (check the Enable Editing checkbox in the GridView's smart tag)</span></span>

<span data-ttu-id="e63f7-148">这些更改后设计器将查找类似于图 3： 具有如下所示的 GridView 的声明性语法。</span><span class="sxs-lookup"><span data-stu-id="e63f7-148">After these changes, the Designer will look similar to Figure 3, with the GridView's declarative syntax shown below.</span></span>


<span data-ttu-id="e63f7-149">[![从 GridView 中删除不需要的字段](customizing-the-data-modification-interface-cs/_static/image8.png)](customizing-the-data-modification-interface-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="e63f7-149">[![Remove the Unneeded Fields from the GridView](customizing-the-data-modification-interface-cs/_static/image8.png)](customizing-the-data-modification-interface-cs/_static/image7.png)</span></span>

<span data-ttu-id="e63f7-150">**图 3**： 从 GridView 中删除不需要的字段 ([单击以查看实际尺寸的图像](customizing-the-data-modification-interface-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="e63f7-150">**Figure 3**: Remove the Unneeded Fields from the GridView ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image9.png))</span></span>


[!code-aspx[Main](customizing-the-data-modification-interface-cs/samples/sample3.aspx)]

<span data-ttu-id="e63f7-151">此时 GridView 的只读的行为已完成。</span><span class="sxs-lookup"><span data-stu-id="e63f7-151">At this point the GridView's read-only behavior is complete.</span></span> <span data-ttu-id="e63f7-152">查看数据时，每个产品呈现为 GridView，显示产品的名称、 类别、 供应商中的行，并停止使用状态。</span><span class="sxs-lookup"><span data-stu-id="e63f7-152">When viewing the data, each product is rendered as a row in the GridView, showing the product's name, category, supplier, and discontinued status.</span></span>


<span data-ttu-id="e63f7-153">[![GridView 的只读接口已完成](customizing-the-data-modification-interface-cs/_static/image11.png)](customizing-the-data-modification-interface-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="e63f7-153">[![The GridView's Read-Only Interface is Complete](customizing-the-data-modification-interface-cs/_static/image11.png)](customizing-the-data-modification-interface-cs/_static/image10.png)</span></span>

<span data-ttu-id="e63f7-154">**图 4**: GridView 只读接口是否已完成 ([单击以查看实际尺寸的图像](customizing-the-data-modification-interface-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="e63f7-154">**Figure 4**: The GridView's Read-Only Interface is Complete ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image12.png))</span></span>


> [!NOTE]
> <span data-ttu-id="e63f7-155">中所述[概述的插入、 更新和删除数据教程](an-overview-of-inserting-updating-and-deleting-data-cs.md)，它是非常重要的 GridView 的视图状态是启用 （默认行为）。</span><span class="sxs-lookup"><span data-stu-id="e63f7-155">As discussed in [An Overview of Inserting, Updating, and Deleting Data tutorial](an-overview-of-inserting-updating-and-deleting-data-cs.md), it is vitally important that the GridView s view state be enabled (the default behavior).</span></span> <span data-ttu-id="e63f7-156">如果设置 GridView s`EnableViewState`属性`false`，运行出现无意中删除或编辑记录的并发用户的风险。</span><span class="sxs-lookup"><span data-stu-id="e63f7-156">If you set the GridView s `EnableViewState` property to `false`, you run the risk of having concurrent users unintentionally deleting or editing records.</span></span> <span data-ttu-id="e63f7-157">请参阅[警告： 禁用并发问题与 ASP.NET 2.0 GridViews/说明/FormViews 该支持编辑和/或删除和其视图状态](http://scottonwriting.net/sowblog/posts/10054.aspx)有关详细信息。</span><span class="sxs-lookup"><span data-stu-id="e63f7-157">See [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx) for more information.</span></span>


## <a name="step-3-using-a-dropdownlist-for-the-category-and-supplier-editing-interfaces"></a><span data-ttu-id="e63f7-158">步骤 3： 使用 DropDownList 类别和供应商编辑接口</span><span class="sxs-lookup"><span data-stu-id="e63f7-158">Step 3: Using a DropDownList for the Category and Supplier Editing Interfaces</span></span>

<span data-ttu-id="e63f7-159">回想一下，`ProductsRow`对象包含`CategoryID`， `CategoryName`， `SupplierID`，和`SupplierName`属性，它们提供中的实际外键 ID 值`Products`数据库表和相应`Name`中的值`Categories`和`Suppliers`表。</span><span class="sxs-lookup"><span data-stu-id="e63f7-159">Recall that the `ProductsRow` object contains `CategoryID`, `CategoryName`, `SupplierID`, and `SupplierName` properties, which provide the actual foreign-key ID values in the `Products` database table and the corresponding `Name` values in the `Categories` and `Suppliers` tables.</span></span> <span data-ttu-id="e63f7-160">`ProductRow`的`CategoryID`和`SupplierID`可以同时进行读取和写入，而`CategoryName`和`SupplierName`属性标记为只读。</span><span class="sxs-lookup"><span data-stu-id="e63f7-160">The `ProductRow`'s `CategoryID` and `SupplierID` can both be read from and written to, while the `CategoryName` and `SupplierName` properties are marked read-only.</span></span>

<span data-ttu-id="e63f7-161">由于的只读状态`CategoryName`和`SupplierName`相应 BoundFields 中获得了属性，其`ReadOnly`属性设置为`true`，防止这些值编辑行时被修改。</span><span class="sxs-lookup"><span data-stu-id="e63f7-161">Due to the read-only status of the `CategoryName` and `SupplierName` properties, the corresponding BoundFields have had their `ReadOnly` property set to `true`, preventing these values from being modified when a row is edited.</span></span> <span data-ttu-id="e63f7-162">尽管我们可以设置`ReadOnly`属性`false`、 呈现`CategoryName`和`SupplierName`BoundFields 作为在编辑的文本框中，这种方法将导致异常时用户尝试将产品的更新，因为没有任何`UpdateProduct`中采用重载`CategoryName`和`SupplierName`输入。</span><span class="sxs-lookup"><span data-stu-id="e63f7-162">While we can set the `ReadOnly` property to `false`, rendering the `CategoryName` and `SupplierName` BoundFields as TextBoxes during editing, such an approach will result in an exception when the user attempts to update the product since there is no `UpdateProduct` overload that takes in `CategoryName` and `SupplierName` inputs.</span></span> <span data-ttu-id="e63f7-163">事实上，我们不想创建此类重载有两个原因：</span><span class="sxs-lookup"><span data-stu-id="e63f7-163">In fact, we don't want to create such an overload for two reasons:</span></span>

- <span data-ttu-id="e63f7-164">`Products`表没有`SupplierName`或`CategoryName`字段，但`SupplierID`和`CategoryID`。</span><span class="sxs-lookup"><span data-stu-id="e63f7-164">The `Products` table doesn't have `SupplierName` or `CategoryName` fields, but `SupplierID` and `CategoryID`.</span></span> <span data-ttu-id="e63f7-165">因此，我们希望我们方法传递这些特定的 ID 值，不是其查找表的值。</span><span class="sxs-lookup"><span data-stu-id="e63f7-165">Therefore, we want our method to be passed these particular ID values, not their lookup tables' values.</span></span>
- <span data-ttu-id="e63f7-166">需要用户键入的供应商或类别的名称是小于理想，因为它要求用户了解可用的类别和供应商和其正确的拼写。</span><span class="sxs-lookup"><span data-stu-id="e63f7-166">Requiring the user to type in the name of the supplier or category is less than ideal, as it requires the user to know the available categories and suppliers and their correct spellings.</span></span>

<span data-ttu-id="e63f7-167">供应商和类别字段应显示该类别和在只读模式下的供应商的名称 （方式与其现在） 和适用的选项时正在编辑的下拉列表。</span><span class="sxs-lookup"><span data-stu-id="e63f7-167">The supplier and category fields should display the category and suppliers' names when in read-only mode (as it does now) and a drop-down list of applicable options when being edited.</span></span> <span data-ttu-id="e63f7-168">使用下拉列表，最终用户可以快速查看哪些类别和供应商有之间进行选择，并且多个可以轻松地使它们的选择。</span><span class="sxs-lookup"><span data-stu-id="e63f7-168">Using a drop-down list, the end user can quickly see what categories and suppliers are available to choose among and can more easily make their selection.</span></span>

<span data-ttu-id="e63f7-169">若要提供此行为，我们需要将转换`SupplierName`和`CategoryName`到 TemplateFields BoundFields 其`ItemTemplate`发出`SupplierName`和`CategoryName`值并且其`EditItemTemplate`使用到列表的 DropDownList 控件可用类别和供应商。</span><span class="sxs-lookup"><span data-stu-id="e63f7-169">To provide this behavior, we need to convert the `SupplierName` and `CategoryName` BoundFields into TemplateFields whose `ItemTemplate` emits the `SupplierName` and `CategoryName` values and whose `EditItemTemplate` uses a DropDownList control to list the available categories and suppliers.</span></span>

## <a name="adding-thecategoriesandsuppliersdropdownlists"></a><span data-ttu-id="e63f7-170">添加`Categories`和`Suppliers`DropDownLists</span><span class="sxs-lookup"><span data-stu-id="e63f7-170">Adding the`Categories`and`Suppliers`DropDownLists</span></span>

<span data-ttu-id="e63f7-171">首先转换`SupplierName`和`CategoryName`到通过 TemplateFields BoundFields： 单击从 GridView 的智能标记的编辑列链接; 从列表中的左下; 选择 BoundField 并单击"将此字段转换TemplateField"链接。</span><span class="sxs-lookup"><span data-stu-id="e63f7-171">Start by converting the `SupplierName` and `CategoryName` BoundFields into TemplateFields by: clicking on the Edit Columns link from the GridView's smart tag; selecting the BoundField from the list in the lower left; and clicking the "Convert this field into a TemplateField" link.</span></span> <span data-ttu-id="e63f7-172">转换过程将创建具有同时为 TemplateField`ItemTemplate`和`EditItemTemplate`，如以下声明性语法中所示：</span><span class="sxs-lookup"><span data-stu-id="e63f7-172">The conversion process will create a TemplateField with both an `ItemTemplate` and an `EditItemTemplate`, as shown in the declarative syntax below:</span></span>


[!code-aspx[Main](customizing-the-data-modification-interface-cs/samples/sample4.aspx)]

<span data-ttu-id="e63f7-173">因为 BoundField 已标记为只读，同时`ItemTemplate`和`EditItemTemplate`包含标签 Web 控件`Text`属性绑定到相应的数据字段 (`CategoryName`，在上面的语法)。</span><span class="sxs-lookup"><span data-stu-id="e63f7-173">Since the BoundField was marked as read-only, both the `ItemTemplate` and `EditItemTemplate` contain a Label Web control whose `Text` property is bound to the applicable data field (`CategoryName`, in the syntax above).</span></span> <span data-ttu-id="e63f7-174">我们需要修改`EditItemTemplate`，标签 Web 控件替换的 DropDownList 控件。</span><span class="sxs-lookup"><span data-stu-id="e63f7-174">We need to modify the `EditItemTemplate`, replacing the Label Web control with a DropDownList control.</span></span>

<span data-ttu-id="e63f7-175">如我们所见前面的教程中，可以编辑该模板通过设计器或直接从声明性语法。</span><span class="sxs-lookup"><span data-stu-id="e63f7-175">As we've seen in previous tutorials, the template can be edited through the Designer or directly from the declarative syntax.</span></span> <span data-ttu-id="e63f7-176">若要对其进行编辑通过设计器，单击从 GridView 的智能标记的编辑模板链接，然后选择可以使用类别字段`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="e63f7-176">To edit it through the Designer, click on the Edit Templates link from the GridView's smart tag and choose to work with the Category field's `EditItemTemplate`.</span></span> <span data-ttu-id="e63f7-177">删除标签 Web 控件并将其与 DropDownList 控件，将下拉列表的 ID 属性设置为`Categories`。</span><span class="sxs-lookup"><span data-stu-id="e63f7-177">Remove the Label Web control and replace it with a DropDownList control, setting the DropDownList's ID property to `Categories`.</span></span>


<span data-ttu-id="e63f7-178">[![删除文本框中并向 EditItemTemplate 添加 DropDownList](customizing-the-data-modification-interface-cs/_static/image14.png)](customizing-the-data-modification-interface-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="e63f7-178">[![Remove the TexBox and Add a DropDownList to the EditItemTemplate](customizing-the-data-modification-interface-cs/_static/image14.png)](customizing-the-data-modification-interface-cs/_static/image13.png)</span></span>

<span data-ttu-id="e63f7-179">**图 5**： 删除文本框中，并添加到 DropDownList `EditItemTemplate` ([单击以查看实际尺寸的图像](customizing-the-data-modification-interface-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="e63f7-179">**Figure 5**: Remove the TexBox and Add a DropDownList to the `EditItemTemplate` ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image15.png))</span></span>


<span data-ttu-id="e63f7-180">接下来，我们必须填充可用类别下拉列表。</span><span class="sxs-lookup"><span data-stu-id="e63f7-180">We next need to populate the DropDownList with the available categories.</span></span> <span data-ttu-id="e63f7-181">单击下拉列表的智能标记中的选择数据源链接，然后选择创建名为新 ObjectDataSource `CategoriesDataSource`。</span><span class="sxs-lookup"><span data-stu-id="e63f7-181">Click on the Choose Data Source link from the DropDownList's smart tag and opt to create a new ObjectDataSource named `CategoriesDataSource`.</span></span>


<span data-ttu-id="e63f7-182">[![创建一个名为 CategoriesDataSource 的新 ObjectDataSource 控件](customizing-the-data-modification-interface-cs/_static/image17.png)](customizing-the-data-modification-interface-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="e63f7-182">[![Create a New ObjectDataSource Control Named CategoriesDataSource](customizing-the-data-modification-interface-cs/_static/image17.png)](customizing-the-data-modification-interface-cs/_static/image16.png)</span></span>

<span data-ttu-id="e63f7-183">**图 6**： 创建新的 ObjectDataSource 控件命名`CategoriesDataSource`([单击以查看实际尺寸的图像](customizing-the-data-modification-interface-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="e63f7-183">**Figure 6**: Create a New ObjectDataSource Control Named `CategoriesDataSource` ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image18.png))</span></span>


<span data-ttu-id="e63f7-184">若要使此对象返回的所有类别的数据源，将其绑定到`CategoriesBLL`类的`GetCategories()`方法。</span><span class="sxs-lookup"><span data-stu-id="e63f7-184">To have this ObjectDataSource return all of the categories, bind it to the `CategoriesBLL` class's `GetCategories()` method.</span></span>


<span data-ttu-id="e63f7-185">[![将对象数据源绑定到 CategoriesBLL GetCategories() 方法](customizing-the-data-modification-interface-cs/_static/image20.png)](customizing-the-data-modification-interface-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="e63f7-185">[![Bind the ObjectDataSource to the CategoriesBLL's GetCategories() Method](customizing-the-data-modification-interface-cs/_static/image20.png)](customizing-the-data-modification-interface-cs/_static/image19.png)</span></span>

<span data-ttu-id="e63f7-186">**图 7**： 绑定到 ObjectDataSource`CategoriesBLL`的`GetCategories()`方法 ([单击以查看实际尺寸的图像](customizing-the-data-modification-interface-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="e63f7-186">**Figure 7**: Bind the ObjectDataSource to the `CategoriesBLL`'s `GetCategories()` Method ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image21.png))</span></span>


<span data-ttu-id="e63f7-187">最后，配置的 DropDownList 设置以便`CategoryName`字段显示在每个 DropDownList`ListItem`与`CategoryID`用作值的字段。</span><span class="sxs-lookup"><span data-stu-id="e63f7-187">Finally, configure the DropDownList's settings such that the `CategoryName` field is displayed in each DropDownList `ListItem` with the `CategoryID` field used as the value.</span></span>


<span data-ttu-id="e63f7-188">[![具有类别名称字段显示和 CategoryID 用作的值](customizing-the-data-modification-interface-cs/_static/image23.png)](customizing-the-data-modification-interface-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="e63f7-188">[![Have the CategoryName Field Displayed and the CategoryID Used as the Value](customizing-the-data-modification-interface-cs/_static/image23.png)](customizing-the-data-modification-interface-cs/_static/image22.png)</span></span>

<span data-ttu-id="e63f7-189">**图 8**： 具有`CategoryName`显示字段和`CategoryID`用作的值 ([单击以查看实际尺寸的图像](customizing-the-data-modification-interface-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="e63f7-189">**Figure 8**: Have the `CategoryName` Field Displayed and the `CategoryID` Used as the Value ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image24.png))</span></span>


<span data-ttu-id="e63f7-190">进行这些更改的声明性标记后`EditItemTemplate`中`CategoryName`TemplateField 中将包括 DropDownList 和对象数据源：</span><span class="sxs-lookup"><span data-stu-id="e63f7-190">After making these changes the declarative markup for the `EditItemTemplate` in the `CategoryName` TemplateField will include both a DropDownList and an ObjectDataSource:</span></span>


[!code-aspx[Main](customizing-the-data-modification-interface-cs/samples/sample5.aspx)]

> [!NOTE]
> <span data-ttu-id="e63f7-191">在 DropDownList`EditItemTemplate`必须启用其视图状态。</span><span class="sxs-lookup"><span data-stu-id="e63f7-191">The DropDownList in the `EditItemTemplate` must have its view state enabled.</span></span> <span data-ttu-id="e63f7-192">我们很快会向数据绑定语法添加到下拉列表的声明性语法和数据绑定命令，如`Eval()`和`Bind()`只能出现在启用了其视图状态的控件。</span><span class="sxs-lookup"><span data-stu-id="e63f7-192">We will soon add databinding syntax to the DropDownList's declarative syntax and databinding commands like `Eval()` and `Bind()` can only appear in controls whose view state is enabled.</span></span>


<span data-ttu-id="e63f7-193">重复上述步骤以添加名为 DropDownList`Suppliers`到`SupplierName`TemplateField 的`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="e63f7-193">Repeat these steps to add a DropDownList named `Suppliers` to the `SupplierName` TemplateField's `EditItemTemplate`.</span></span> <span data-ttu-id="e63f7-194">这将涉及添加到 DropDownList`EditItemTemplate`和创建另一个对象数据源。</span><span class="sxs-lookup"><span data-stu-id="e63f7-194">This will involve adding a DropDownList to the `EditItemTemplate` and creating another ObjectDataSource.</span></span> <span data-ttu-id="e63f7-195">`Suppliers` DropDownList 的对象数据源，但是，应配置为调用`SuppliersBLL`类的`GetSuppliers()`方法。</span><span class="sxs-lookup"><span data-stu-id="e63f7-195">The `Suppliers` DropDownList's ObjectDataSource, however, should be configured to invoke the `SuppliersBLL` class's `GetSuppliers()` method.</span></span> <span data-ttu-id="e63f7-196">此外，配置`Suppliers`DropDownList 以显示`CompanyName`字段并使用`SupplierID`字段的值作为其`ListItem`s。</span><span class="sxs-lookup"><span data-stu-id="e63f7-196">Additionally, configure the `Suppliers` DropDownList to display the `CompanyName` field and use the `SupplierID` field as the value for its `ListItem` s.</span></span>

<span data-ttu-id="e63f7-197">添加到两个 DropDownLists 后`EditItemTemplate`s，加载浏览器中，然后单击编辑按钮 Chef Anton Cajun Seasoning 产品。</span><span class="sxs-lookup"><span data-stu-id="e63f7-197">After adding the DropDownLists to the two `EditItemTemplate` s, load the page in a browser and click the Edit button for the Chef Anton's Cajun Seasoning product.</span></span> <span data-ttu-id="e63f7-198">如图 9 所示，该产品的类别和供应商列呈现为包含可用类别和供应商可供选择的下拉列表。</span><span class="sxs-lookup"><span data-stu-id="e63f7-198">As Figure 9 shows, the product's category and supplier columns are rendered as drop-down lists containing the available categories and suppliers to choose from.</span></span> <span data-ttu-id="e63f7-199">但请注意，*第一个*这两个下拉列表中的项目默认选择 (Beverages 类别) 和尖端液体作为供应商，即使 Chef Anton Cajun Seasoning 是提供的新奥尔良 Cajun Condiment带来快乐。</span><span class="sxs-lookup"><span data-stu-id="e63f7-199">However, note that the *first* items in both drop-down lists are selected by default (Beverages for the category and Exotic Liquids as the supplier), even though Chef Anton's Cajun Seasoning is a Condiment supplied by New Orleans Cajun Delights.</span></span>


<span data-ttu-id="e63f7-200">[![默认为选中状态的下拉列表中的第一个项](customizing-the-data-modification-interface-cs/_static/image26.png)](customizing-the-data-modification-interface-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="e63f7-200">[![The First Item in the Drop-Down Lists is Selected by Default](customizing-the-data-modification-interface-cs/_static/image26.png)](customizing-the-data-modification-interface-cs/_static/image25.png)</span></span>

<span data-ttu-id="e63f7-201">**图 9**： 默认情况下选择下拉列表中的第一个项 ([单击以查看实际尺寸的图像](customizing-the-data-modification-interface-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="e63f7-201">**Figure 9**: The First Item in the Drop-Down Lists is Selected by Default ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image27.png))</span></span>


<span data-ttu-id="e63f7-202">此外，如果单击更新时，你将找到的产品的`CategoryID`和`SupplierID`值设置为`NULL`。</span><span class="sxs-lookup"><span data-stu-id="e63f7-202">Furthermore, if you click Update, you'll find that the product's `CategoryID` and `SupplierID` values are set to `NULL`.</span></span> <span data-ttu-id="e63f7-203">这两种意外的行为由引起的因为在 DropDownLists `EditItemTemplate` s 从基础的产品数据未绑定到任何数据字段。</span><span class="sxs-lookup"><span data-stu-id="e63f7-203">Both of these undesired behaviors are caused because the DropDownLists in the `EditItemTemplate` s are not bound to any data fields from the underlying product data.</span></span>

## <a name="binding-the-dropdownlists-to-thecategoryidandsupplieriddata-fields"></a><span data-ttu-id="e63f7-204">绑定到 DropDownLists`CategoryID`和`SupplierID`数据字段</span><span class="sxs-lookup"><span data-stu-id="e63f7-204">Binding the DropDownLists to the`CategoryID`and`SupplierID`Data Fields</span></span>

<span data-ttu-id="e63f7-205">为了具有编辑的产品类别和供应商下拉列表设置为适当的值，并具有发送回 BLL 的这些值`UpdateProduct`单击更新后的方法，我们需要将绑定 DropDownLists 的`SelectedValue`属性设置为`CategoryID`和`SupplierID`使用双向数据绑定的数据字段。</span><span class="sxs-lookup"><span data-stu-id="e63f7-205">In order to have the edited product's category and supplier drop-down lists set to the appropriate values and to have these values sent back to the BLL's `UpdateProduct` method upon clicking Update, we need to bind the DropDownLists' `SelectedValue` properties to the `CategoryID` and `SupplierID` data fields using two-way databinding.</span></span> <span data-ttu-id="e63f7-206">若要完成此操作与`Categories`DropDownList，你可以添加`SelectedValue='<%# Bind("CategoryID") %>'`直接到声明性语法。</span><span class="sxs-lookup"><span data-stu-id="e63f7-206">To accomplish this with the `Categories` DropDownList, you can add `SelectedValue='<%# Bind("CategoryID") %>'` directly to the declarative syntax.</span></span>

<span data-ttu-id="e63f7-207">或者，你可以通过编辑该模板通过设计器并单击从下拉列表的智能标记编辑数据绑定链接来设置数据绑定的 DropDownList。</span><span class="sxs-lookup"><span data-stu-id="e63f7-207">Alternatively, you can set the DropDownList's databindings by editing the template through the Designer and clicking the Edit DataBindings link from the DropDownList's smart tag.</span></span> <span data-ttu-id="e63f7-208">接下来，指示`SelectedValue`属性应绑定到`CategoryID`字段使用双向数据绑定 （请参阅图 10）。</span><span class="sxs-lookup"><span data-stu-id="e63f7-208">Next, indicate that the `SelectedValue` property should be bound to the `CategoryID` field using two-way databinding (see Figure 10).</span></span> <span data-ttu-id="e63f7-209">重复任一个声明性或设计器进程将绑定`SupplierID`数据字段`Suppliers`DropDownList。</span><span class="sxs-lookup"><span data-stu-id="e63f7-209">Repeat either the declarative or Designer process to bind the `SupplierID` data field to the `Suppliers` DropDownList.</span></span>


<span data-ttu-id="e63f7-210">[![将 CategoryID 绑定到使用双向数据绑定的 DropDownList SelectedValue 属性](customizing-the-data-modification-interface-cs/_static/image29.png)](customizing-the-data-modification-interface-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="e63f7-210">[![Bind the CategoryID to the DropDownList's SelectedValue Property Using Two-Way Databinding](customizing-the-data-modification-interface-cs/_static/image29.png)](customizing-the-data-modification-interface-cs/_static/image28.png)</span></span>

<span data-ttu-id="e63f7-211">**图 10**： 绑定`CategoryID`到 DropDownList`SelectedValue`属性使用双向数据绑定 ([单击以查看实际尺寸的图像](customizing-the-data-modification-interface-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="e63f7-211">**Figure 10**: Bind the `CategoryID` to the DropDownList's `SelectedValue` Property Using Two-Way Databinding ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image30.png))</span></span>


<span data-ttu-id="e63f7-212">一旦绑定已应用于`SelectedValue`的两个 DropDownLists 属性中，编辑的产品类别和供应商列将默认为当前产品的值。</span><span class="sxs-lookup"><span data-stu-id="e63f7-212">Once the bindings have been applied to the `SelectedValue` properties of the two DropDownLists, the edited product's category and supplier columns will default to the current product's values.</span></span> <span data-ttu-id="e63f7-213">如果单击更新，`CategoryID`和`SupplierID`选择的下拉列表项的值将传递到`UpdateProduct`方法。</span><span class="sxs-lookup"><span data-stu-id="e63f7-213">Upon clicking Update, the `CategoryID` and `SupplierID` values of the selected drop-down list item will be passed to the `UpdateProduct` method.</span></span> <span data-ttu-id="e63f7-214">图 11 显示本教程后已添加的数据绑定语句;请注意如何 Chef Anton Cajun Seasoning 的所选的下拉列表项将正确 Condiment 和新奥尔良 Cajun 带来快乐。</span><span class="sxs-lookup"><span data-stu-id="e63f7-214">Figure 11 shows the tutorial after the databinding statements have been added; note how the selected drop-down list items for Chef Anton's Cajun Seasoning are correctly Condiment and New Orleans Cajun Delights.</span></span>


<span data-ttu-id="e63f7-215">[![默认情况下选择编辑产品的当前类别和供应商值](customizing-the-data-modification-interface-cs/_static/image32.png)](customizing-the-data-modification-interface-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="e63f7-215">[![The Edited Product's Current Category and Supplier Values are Selected by Default](customizing-the-data-modification-interface-cs/_static/image32.png)](customizing-the-data-modification-interface-cs/_static/image31.png)</span></span>

<span data-ttu-id="e63f7-216">**图 11**： 默认情况下选择编辑产品当前类别和供应商值 ([单击以查看实际尺寸的图像](customizing-the-data-modification-interface-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="e63f7-216">**Figure 11**: The Edited Product's Current Category and Supplier Values are Selected by Default ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image33.png))</span></span>


## <a name="handlingnullvalues"></a><span data-ttu-id="e63f7-217">处理`NULL`值</span><span class="sxs-lookup"><span data-stu-id="e63f7-217">Handling`NULL`Values</span></span>

<span data-ttu-id="e63f7-218">`CategoryID`和`SupplierID`中的列`Products`表可以是`NULL`，但在 DropDownLists `EditItemTemplate` s 不包含要表示的列表项`NULL`值。</span><span class="sxs-lookup"><span data-stu-id="e63f7-218">The `CategoryID` and `SupplierID` columns in the `Products` table can be `NULL`, yet the DropDownLists in the `EditItemTemplate` s don't include a list item to represent a `NULL` value.</span></span> <span data-ttu-id="e63f7-219">这样做有以下两种结果：</span><span class="sxs-lookup"><span data-stu-id="e63f7-219">This has two consequences:</span></span>

- <span data-ttu-id="e63f7-220">用户不能使用我们的接口以从非更改为产品类别或供应商`NULL`值赋给`NULL`一个</span><span class="sxs-lookup"><span data-stu-id="e63f7-220">User cannot use our interface to change a product's category or supplier from a non-`NULL` value to a `NULL` one</span></span>
- <span data-ttu-id="e63f7-221">如果产品具有`NULL``CategoryID`或`SupplierID`，单击编辑按钮将导致异常。</span><span class="sxs-lookup"><span data-stu-id="e63f7-221">If a product has a `NULL` `CategoryID` or `SupplierID`, clicking the Edit button will result in an exception.</span></span> <span data-ttu-id="e63f7-222">这是因为`NULL`返回值`CategoryID`(或`SupplierID`) 中`Bind()`语句未映射到下拉列表中的值 (DropDownList 引发异常时其`SelectedValue`属性设置为值*不*列表项其集合中)。</span><span class="sxs-lookup"><span data-stu-id="e63f7-222">This is because the `NULL` value returned by `CategoryID` (or `SupplierID`) in the `Bind()` statement does not map to a value in the DropDownList (the DropDownList throws an exception when its `SelectedValue` property is set to a value *not* in its collection of list items).</span></span>

<span data-ttu-id="e63f7-223">为了支持`NULL``CategoryID`和`SupplierID`我们需要添加另一个值，`ListItem`到来表示每个 DropDownList`NULL`值。</span><span class="sxs-lookup"><span data-stu-id="e63f7-223">In order to support `NULL` `CategoryID` and `SupplierID` values, we need to add another `ListItem` to each DropDownList to represent the `NULL` value.</span></span> <span data-ttu-id="e63f7-224">在[主/详细信息筛选与 DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md)教程，我们已了解如何添加其他`ListItem`到数据绑定的 DropDownList，这涉及设置的 DropDownList`AppendDataBoundItems`属性`true`和手动添加其他`ListItem`。</span><span class="sxs-lookup"><span data-stu-id="e63f7-224">In the [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) tutorial, we saw how to add an additional `ListItem` to a databound DropDownList, which involved setting the DropDownList's `AppendDataBoundItems` property to `true` and manually adding the additional `ListItem`.</span></span> <span data-ttu-id="e63f7-225">在该前面的教程，但是，我们添加了`ListItem`与`Value`的`-1`。</span><span class="sxs-lookup"><span data-stu-id="e63f7-225">In that previous tutorial, however, we added a `ListItem` with a `Value` of `-1`.</span></span> <span data-ttu-id="e63f7-226">数据绑定中的逻辑在 ASP.NET 中，但是，将自动转换到的空白字符串`NULL`值和相反的操作。</span><span class="sxs-lookup"><span data-stu-id="e63f7-226">The databinding logic in ASP.NET, however, will automatically convert a blank string to a `NULL` value and vice-a-versa.</span></span> <span data-ttu-id="e63f7-227">因此，本教程中我们想`ListItem`的`Value`为空字符串。</span><span class="sxs-lookup"><span data-stu-id="e63f7-227">Therefore, for this tutorial we want the `ListItem`'s `Value` to be an empty string.</span></span>

<span data-ttu-id="e63f7-228">通过设置这两个 DropDownLists 的开始`AppendDataBoundItems`属性`true`。</span><span class="sxs-lookup"><span data-stu-id="e63f7-228">Start by setting both DropDownLists' `AppendDataBoundItems` property to `true`.</span></span> <span data-ttu-id="e63f7-229">接下来，添加`NULL``ListItem`通过添加以下`<asp:ListItem>`到每个 DropDownList 元素这样的声明性标记看起来就像：</span><span class="sxs-lookup"><span data-stu-id="e63f7-229">Next, add the `NULL` `ListItem` by adding the following `<asp:ListItem>` element to each DropDownList so that the declarative markup looks like:</span></span>


[!code-aspx[Main](customizing-the-data-modification-interface-cs/samples/sample6.aspx)]

<span data-ttu-id="e63f7-230">我已选择使用"（无）"的文本值作为此`ListItem`，但可以将其以也是空白字符串，如果你想要进行更改。</span><span class="sxs-lookup"><span data-stu-id="e63f7-230">I've chosen to use "(None)" as the Text value for this `ListItem`, but you can change it to also be a blank string if you'd like.</span></span>

> [!NOTE]
> <span data-ttu-id="e63f7-231">正如我们看到在*主/详细信息筛选与 DropDownList*教程中， `ListItem` s 可以通过单击的 DropDownList 添加到通过设计器 DropDownList`Items`属性窗口中的属性 (将显示`ListItem`集合编辑器)。</span><span class="sxs-lookup"><span data-stu-id="e63f7-231">As we saw in the *Master/Detail Filtering With a DropDownList* tutorial, `ListItem` s can be added to a DropDownList through the Designer by clicking on the DropDownList's `Items` property in the Properties window (which will display the `ListItem` Collection Editor).</span></span> <span data-ttu-id="e63f7-232">但是，请务必添加`NULL``ListItem`本教程中通过声明性语法。</span><span class="sxs-lookup"><span data-stu-id="e63f7-232">However, be sure to add the `NULL` `ListItem` for this tutorial through the declarative syntax.</span></span> <span data-ttu-id="e63f7-233">如果你使用`ListItem`集合编辑器中，生成的声明性语法将省略`Value`完全设置时分配的空白字符串，创建类似的声明性标记： `<asp:ListItem>(None)</asp:ListItem>`。</span><span class="sxs-lookup"><span data-stu-id="e63f7-233">If you use the `ListItem` Collection Editor, the generated declarative syntax will omit the `Value` setting altogether when assigned a blank string, creating declarative markup like: `<asp:ListItem>(None)</asp:ListItem>`.</span></span> <span data-ttu-id="e63f7-234">尽管这可能看起来无害，缺失值会导致 DropDownList 使用`Text`在其位置的属性值。</span><span class="sxs-lookup"><span data-stu-id="e63f7-234">While this may look harmless, the missing Value causes the DropDownList to use the `Text` property value in its place.</span></span> <span data-ttu-id="e63f7-235">这意味着，如果这`NULL``ListItem`是选择，"（无）"的值会尝试分配给`CategoryID`，这将导致异常。</span><span class="sxs-lookup"><span data-stu-id="e63f7-235">That means that if this `NULL` `ListItem` is selected, the value "(None)" will be attempted to be assigned to the `CategoryID`, which will result in an exception.</span></span> <span data-ttu-id="e63f7-236">通过将显式设置`Value=""`、`NULL`值将赋给`CategoryID`时`NULL``ListItem`选择。</span><span class="sxs-lookup"><span data-stu-id="e63f7-236">By explicitly setting `Value=""`, a `NULL` value will be assigned to `CategoryID` when the `NULL` `ListItem` is selected.</span></span>


<span data-ttu-id="e63f7-237">对供应商 DropDownList 重复这些步骤。</span><span class="sxs-lookup"><span data-stu-id="e63f7-237">Repeat these steps for the Suppliers DropDownList.</span></span>

<span data-ttu-id="e63f7-238">与此其他`ListItem`，现在可以分配的编辑界面`NULL`值与产品的`CategoryID`和`SupplierID`字段，如图 12 中所示。</span><span class="sxs-lookup"><span data-stu-id="e63f7-238">With this additional `ListItem`, the editing interface can now assign `NULL` values to a Product's `CategoryID` and `SupplierID` fields, as shown in Figure 12.</span></span>


<span data-ttu-id="e63f7-239">[![选择 （无） 的产品类别或供应商分配 NULL 值](customizing-the-data-modification-interface-cs/_static/image35.png)](customizing-the-data-modification-interface-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="e63f7-239">[![Choose (None) to Assign a NULL Value for a Product's Category or Supplier](customizing-the-data-modification-interface-cs/_static/image35.png)](customizing-the-data-modification-interface-cs/_static/image34.png)</span></span>

<span data-ttu-id="e63f7-240">**图 12**： 选择 （无） 分配到`NULL`为产品类别或供应商的值 ([单击以查看实际尺寸的图像](customizing-the-data-modification-interface-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="e63f7-240">**Figure 12**: Choose (None) to Assign a `NULL` Value for a Product's Category or Supplier ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image36.png))</span></span>


## <a name="step-4-using-radiobuttons-for-the-discontinued-status"></a><span data-ttu-id="e63f7-241">步骤 4： 使用单选按钮为不再使用的状态</span><span class="sxs-lookup"><span data-stu-id="e63f7-241">Step 4: Using RadioButtons for the Discontinued Status</span></span>

<span data-ttu-id="e63f7-242">当前产品的`Discontinued`使用 CheckBoxField，呈现一个用于只读的行的已禁用的复选框和正在编辑的行启用复选框表示数据字段。</span><span class="sxs-lookup"><span data-stu-id="e63f7-242">Currently the products' `Discontinued` data field is expressed using a CheckBoxField, which renders a disabled checkbox for the read-only rows and an enabled checkbox for the row being edited.</span></span> <span data-ttu-id="e63f7-243">通常适用此用户界面时，我们可以根据需要使用为 TemplateField 定制它。</span><span class="sxs-lookup"><span data-stu-id="e63f7-243">While this user interface is often suitable, we can customize it if needed using a TemplateField.</span></span> <span data-ttu-id="e63f7-244">对于本教程中，让我们更改 CheckBoxField 转换的两个选项"活动"和"停止使用"使用说明如何控制用户可以从中指定产品的为 TemplateField`Discontinued`值。</span><span class="sxs-lookup"><span data-stu-id="e63f7-244">For this tutorial, let's change the CheckBoxField into a TemplateField that uses a RadioButtonList control with two options "Active" and "Discontinued" from which the user can specify the product's `Discontinued` value.</span></span>

<span data-ttu-id="e63f7-245">通过将转换启动`Discontinued`转换为 TemplateField，将创建与 TemplateField CheckBoxField`ItemTemplate`和`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="e63f7-245">Start by converting the `Discontinued` CheckBoxField into a TemplateField, which will create a TemplateField with an `ItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="e63f7-246">两个模板都包含一个具有复选框其`Checked`属性绑定到`Discontinued`数据字段，唯一的区别是，这两者之间`ItemTemplate`的复选框的`Enabled`属性设置为`false`。</span><span class="sxs-lookup"><span data-stu-id="e63f7-246">Both templates include a CheckBox with its `Checked` property bound to the `Discontinued` data field, the only difference between the two being that the `ItemTemplate`'s CheckBox's `Enabled` property is set to `false`.</span></span>

<span data-ttu-id="e63f7-247">替换中的复选框`ItemTemplate`和`EditItemTemplate`有一个说明如何控件设置这两个 RadioButtonLists 的`ID`属性设置为`DiscontinuedChoice`。</span><span class="sxs-lookup"><span data-stu-id="e63f7-247">Replace the CheckBox in both the `ItemTemplate` and `EditItemTemplate` with a RadioButtonList control, setting both RadioButtonLists' `ID` properties to `DiscontinuedChoice`.</span></span> <span data-ttu-id="e63f7-248">接下来，指示 RadioButtonLists 应每个包含两个单选按钮，一个标记为"活动"值为"False"，标记为"停用"的一个值为"True"。</span><span class="sxs-lookup"><span data-stu-id="e63f7-248">Next, indicate that the RadioButtonLists should each contain two radio buttons, one labeled "Active" with a value of "False" and one labeled "Discontinued" with a value of "True".</span></span> <span data-ttu-id="e63f7-249">若要完成此您可以输入`<asp:ListItem>`直接通过声明性语法或使用中的元素`ListItem`从设计器的集合编辑器。</span><span class="sxs-lookup"><span data-stu-id="e63f7-249">To accomplish this you can either enter the `<asp:ListItem>` elements in directly through the declarative syntax or use the `ListItem` Collection Editor from the Designer.</span></span> <span data-ttu-id="e63f7-250">图 13 显示`ListItem`集合编辑器后两个单选按钮选项已指定。</span><span class="sxs-lookup"><span data-stu-id="e63f7-250">Figure 13 shows the `ListItem` Collection Editor after the two radio button options have been specified.</span></span>


<span data-ttu-id="e63f7-251">[![Add](customizing-the-data-modification-interface-cs/_static/image38.png)](customizing-the-data-modification-interface-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="e63f7-251">[![Add](customizing-the-data-modification-interface-cs/_static/image38.png)](customizing-the-data-modification-interface-cs/_static/image37.png)</span></span>

<span data-ttu-id="e63f7-252">**图 13**: 说明如何向中添加"活动"和"已中断"选项 ([单击以查看实际尺寸的图像](customizing-the-data-modification-interface-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="e63f7-252">**Figure 13**: Add "Active" and "Discontinued" Options to the RadioButtonList ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image39.png))</span></span>


<span data-ttu-id="e63f7-253">说明如何在自`ItemTemplate`不应可编辑，设置其`Enabled`属性`false`、 保留`Enabled`属性`true`（默认值） 中说明如何为`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="e63f7-253">Since the RadioButtonList in the `ItemTemplate` shouldn't be editable, set its `Enabled` property to `false`, leaving the `Enabled` property to `true` (the default) for the RadioButtonList in the `EditItemTemplate`.</span></span> <span data-ttu-id="e63f7-254">这将使单选按钮以只读方式，非编辑行中，但将允许用户更改编辑过的行的单选按钮值。</span><span class="sxs-lookup"><span data-stu-id="e63f7-254">This will make the radio buttons in the non-edited row as read-only, but will allow the user to change the RadioButton values for the edited row.</span></span>

<span data-ttu-id="e63f7-255">我们仍需要分配的说明如何控件的`SelectedValue`属性，以便相应的单选按钮处于选中状态取决于产品的`Discontinued`数据字段。</span><span class="sxs-lookup"><span data-stu-id="e63f7-255">We still need to assign the RadioButtonList controls' `SelectedValue` properties so that the appropriate radio button is selected based upon the product's `Discontinued` data field.</span></span> <span data-ttu-id="e63f7-256">直接在声明性的标记或 RadioButtonLists 的智能标记中的编辑数据绑定链接，也可以与本教程中前面检查 DropDownLists，添加此数据绑定语法。</span><span class="sxs-lookup"><span data-stu-id="e63f7-256">As with the DropDownLists examined earlier in this tutorial, this databinding syntax can either be added directly into the declarative markup or through the Edit DataBindings link in the RadioButtonLists' smart tags.</span></span>

<span data-ttu-id="e63f7-257">在添加两个 RadioButtonLists 和配置它们后, `Discontinued` TemplateField 的声明性标记应如下所示：</span><span class="sxs-lookup"><span data-stu-id="e63f7-257">After adding the two RadioButtonLists and configuring them, the `Discontinued` TemplateField's declarative markup should look like:</span></span>


[!code-aspx[Main](customizing-the-data-modification-interface-cs/samples/sample7.aspx)]

<span data-ttu-id="e63f7-258">进行这些更改后，`Discontinued`列的安全提供程序已从的复选框列表转换为单选按钮对 （请参阅图 14） 的列表。</span><span class="sxs-lookup"><span data-stu-id="e63f7-258">With these changes, the `Discontinued` column has been transformed from a list of checkboxes to a list of radio button pairs (see Figure 14).</span></span> <span data-ttu-id="e63f7-259">在编辑产品时，相应的单选按钮处于选中状态，并可以通过选择其他单选按钮并单击更新更新产品的停用的状态。</span><span class="sxs-lookup"><span data-stu-id="e63f7-259">When editing a product, the appropriate radio button is selected and the product's discontinued status can be updated by selecting the other radio button and clicking Update.</span></span>


<span data-ttu-id="e63f7-260">[![单选按钮对已替换为已停止使用复选框](customizing-the-data-modification-interface-cs/_static/image41.png)](customizing-the-data-modification-interface-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="e63f7-260">[![The Discontinued CheckBoxes Have Been Replaced by Radio Button Pairs](customizing-the-data-modification-interface-cs/_static/image41.png)](customizing-the-data-modification-interface-cs/_static/image40.png)</span></span>

<span data-ttu-id="e63f7-261">**图 14**: 停止使用复选框已替换为单选按钮对 ([单击以查看实际尺寸的图像](customizing-the-data-modification-interface-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="e63f7-261">**Figure 14**: The Discontinued CheckBoxes Have Been Replaced by Radio Button Pairs ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image42.png))</span></span>


> [!NOTE]
> <span data-ttu-id="e63f7-262">由于`Discontinued`中的列`Products`数据库不能具有`NULL`值，我们不需要担心捕获`NULL`界面中的信息。</span><span class="sxs-lookup"><span data-stu-id="e63f7-262">Since the `Discontinued` column in the `Products` database cannot have `NULL` values, we do not need to worry about capturing `NULL` information in the interface.</span></span> <span data-ttu-id="e63f7-263">如果是，但是，`Discontinued`列无法包含`NULL`值我们想要添加第三个单选按钮与向列表其`Value`设置为空字符串 (`Value=""`)，就像使用的类别和供应商 DropDownLists。</span><span class="sxs-lookup"><span data-stu-id="e63f7-263">If, however, `Discontinued` column could contain `NULL` values we'd want to add a third radio button to the list with its `Value` set to an empty string (`Value=""`), just like with the category and supplier DropDownLists.</span></span>


## <a name="summary"></a><span data-ttu-id="e63f7-264">总结</span><span class="sxs-lookup"><span data-stu-id="e63f7-264">Summary</span></span>

<span data-ttu-id="e63f7-265">虽然 BoundField 和 CheckBoxField 自动呈现只读的编辑，并且他们插入接口，缺少自定义项的能力。</span><span class="sxs-lookup"><span data-stu-id="e63f7-265">While the BoundField and CheckBoxField automatically render read-only, editing, and inserting interfaces, they lack the ability for customization.</span></span> <span data-ttu-id="e63f7-266">通常情况下，不过，我们将需要自定义编辑或将其插入接口，可能添加验证控件 （如在前面的教程，我们已了解） 或通过自定义数据收集用户界面 （如我们在本教程中看到）。</span><span class="sxs-lookup"><span data-stu-id="e63f7-266">Often, though, we'll need to customize the editing or inserting interface, perhaps adding validation controls (as we saw in the preceding tutorial) or by customizing the data collection user interface (as we saw in this tutorial).</span></span> <span data-ttu-id="e63f7-267">自定义与为 TemplateField 界面可以是计算总和中的以下步骤：</span><span class="sxs-lookup"><span data-stu-id="e63f7-267">Customizing the interface with a TemplateField can be summed up in the following steps:</span></span>

1. <span data-ttu-id="e63f7-268">添加为 TemplateField 或将现有 BoundField 或 CheckBoxField 转换转换为 TemplateField</span><span class="sxs-lookup"><span data-stu-id="e63f7-268">Add a TemplateField or convert an existing BoundField or CheckBoxField into a TemplateField</span></span>
2. <span data-ttu-id="e63f7-269">根据需要增加接口</span><span class="sxs-lookup"><span data-stu-id="e63f7-269">Augment the interface as needed</span></span>
3. <span data-ttu-id="e63f7-270">将适当的数据字段绑定到新添加的 Web 控件使用双向数据绑定</span><span class="sxs-lookup"><span data-stu-id="e63f7-270">Bind the appropriate data fields to the newly added Web controls using two-way databinding</span></span>

<span data-ttu-id="e63f7-271">除了使用内置的 ASP.NET Web 控件，你还可以自定义为 TemplateField 与自定义的、 已编译的服务器控件和用户控件的模板。</span><span class="sxs-lookup"><span data-stu-id="e63f7-271">In addition to using the built-in ASP.NET Web controls, you can also customize the templates of a TemplateField with custom, compiled server controls and User Controls.</span></span>

<span data-ttu-id="e63f7-272">尽情享受编程 ！</span><span class="sxs-lookup"><span data-stu-id="e63f7-272">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="e63f7-273">关于作者</span><span class="sxs-lookup"><span data-stu-id="e63f7-273">About the Author</span></span>

<span data-ttu-id="e63f7-274">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七个 ASP/ASP.NET 书籍和的创始人[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年使用与 Microsoft Web 技术。</span><span class="sxs-lookup"><span data-stu-id="e63f7-274">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="e63f7-275">Scott 的作用是作为独立的顾问、 培训师和编写器。</span><span class="sxs-lookup"><span data-stu-id="e63f7-275">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="e63f7-276">最新书籍是[ *Sam 教授自己 ASP.NET 2.0 24 小时内*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="e63f7-276">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="e63f7-277">他可以达到在[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)或通过他的博客，其中可以找到在[ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="e63f7-277">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e63f7-278">[上一页](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md)
> [下一页](implementing-optimistic-concurrency-cs.md)</span><span class="sxs-lookup"><span data-stu-id="e63f7-278">[Previous](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md)
[Next](implementing-optimistic-concurrency-cs.md)</span></span>
