---
uid: web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
title: 将新记录插入从 GridView 的页脚 (VB) |Microsoft 文档
author: rick-anderson
description: 虽然 GridView 控件不提供内置支持用于插入的数据的新记录，本教程演示如何增加 GridView 包括...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/06/2007
ms.topic: article
ms.assetid: 528acc48-f20c-4b4e-aa16-4cc02f068ebb
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
msc.type: authoredcontent
ms.openlocfilehash: 32f3cb23805813135bf463720e7479f5f819deb7
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/06/2018
ms.locfileid: "30888365"
---
<a name="inserting-a-new-record-from-the-gridviews-footer-vb"></a><span data-ttu-id="2a1c7-103">将新记录插入从 GridView 的页脚 (VB)</span><span class="sxs-lookup"><span data-stu-id="2a1c7-103">Inserting a New Record from the GridView's Footer (VB)</span></span>
====================
<span data-ttu-id="2a1c7-104">通过[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2a1c7-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2a1c7-105">[下载示例应用程序](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe)或[下载 PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="2a1c7-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) or [Download PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span></span>

> <span data-ttu-id="2a1c7-106">虽然 GridView 控件不提供内置支持用于插入的数据的新记录，本教程将演示如何增加 GridView 以包括插入的接口。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-106">While the GridView control does not provide built-in support for inserting a new record of data, this tutorial shows how to augment the GridView to include an inserting interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="2a1c7-107">介绍</span><span class="sxs-lookup"><span data-stu-id="2a1c7-107">Introduction</span></span>

<span data-ttu-id="2a1c7-108">中所述[概述的插入、 更新和删除数据](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md)教程，GridView，说明如何和 FormView Web 控制每个包括内置的数据修改功能。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-108">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, the GridView, DetailsView, and FormView Web controls each include built-in data modification capabilities.</span></span> <span data-ttu-id="2a1c7-109">如果使用声明性数据源控件，这三个 Web 控件可以快速轻松地配置来修改数据的和无需编写一行代码的方案中。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-109">When used with declarative data source controls, these three Web controls can be quickly and easily configured to modify data - and in scenarios without needing to write a single line of code.</span></span> <span data-ttu-id="2a1c7-110">遗憾的是，仅说明和 FormView 控件提供内置的插入、 编辑和删除功能。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-110">Unfortunately, only the DetailsView and FormView controls provide built-in inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="2a1c7-111">GridView 只提供编辑和删除的支持。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-111">The GridView only offers editing and deleting support.</span></span> <span data-ttu-id="2a1c7-112">但是，有少量弯头硅脂，我们可以增加 GridView 以包括插入的接口。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-112">However, with a little elbow grease, we can augment the GridView to include an inserting interface.</span></span>

<span data-ttu-id="2a1c7-113">在将插入功能添加到 GridView，我们是负责确定将添加新记录、 创建插入的接口，和编写代码以插入新记录。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-113">In adding inserting capabilities to the GridView, we are responsible for deciding on how new records will be added, creating the inserting interface, and writing the code to insert the new record.</span></span> <span data-ttu-id="2a1c7-114">在本教程中我们将着眼于将插入接口添加到的 GridView 的页脚行 （请参见图 1）。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-114">In this tutorial we will look at adding the inserting interface to the GridView s footer row (see Figure 1).</span></span> <span data-ttu-id="2a1c7-115">每个列的页脚单元格包括适当的数据集合用户界面元素 （产品 s 名称文本框中，用于供应商，依次类推 DropDownList）。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-115">The footer cell for each column includes the appropriate data collection user interface element (a TextBox for the product s name, a DropDownList for the supplier, and so on).</span></span> <span data-ttu-id="2a1c7-116">我们还需要一个列的添加按钮，单击时，将导致回发并插入新记录到`Products`表使用页脚行中提供的值。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-116">We also need a column for an Add button that, when clicked, will cause a postback and insert a new record into the `Products` table using the values supplied in the footer row.</span></span>


<span data-ttu-id="2a1c7-117">[![页脚行提供用于添加新的产品的接口](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="2a1c7-117">[![The Footer Row Provides an Interface for Adding New Products](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span></span>

<span data-ttu-id="2a1c7-118">**图 1**： 页脚行提供用于添加新产品的接口 ([单击以查看实际尺寸的图像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="2a1c7-118">**Figure 1**: The Footer Row Provides an Interface for Adding New Products ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span></span>


## <a name="step-1-displaying-product-information-in-a-gridview"></a><span data-ttu-id="2a1c7-119">步骤 1： 在一个 GridView 中显示产品信息</span><span class="sxs-lookup"><span data-stu-id="2a1c7-119">Step 1: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="2a1c7-120">我们考虑自行创建 GridView 的脚注中的插入接口之前，让 s 第一个专注于向列出数据库中的产品页中添加一个 GridView。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-120">Before we concern ourselves with creating the inserting interface in the GridView s footer, let s first focus on adding a GridView to the page that lists the products in the database.</span></span> <span data-ttu-id="2a1c7-121">首先打开`InsertThroughFooter.aspx`页面`EnhancedGridView`文件夹，然后拖动一个 GridView 从工具箱中拖动到设计器中，设置 GridView s`ID`属性`Products`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-121">Start by opening the `InsertThroughFooter.aspx` page in the `EnhancedGridView` folder and drag a GridView from the Toolbox onto the Designer, setting the GridView s `ID` property to `Products`.</span></span> <span data-ttu-id="2a1c7-122">接下来，使用 GridView s 智能标记将其绑定到名为新 ObjectDataSource `ProductsDataSource`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-122">Next, use the GridView s smart tag to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span>


<span data-ttu-id="2a1c7-123">[![创建名为 ProductsDataSource 新对象数据源](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="2a1c7-123">[![Create a New ObjectDataSource Named ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span></span>

<span data-ttu-id="2a1c7-124">**图 2**： 创建新对象数据源命名`ProductsDataSource`([单击以查看实际尺寸的图像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="2a1c7-124">**Figure 2**: Create a New ObjectDataSource Named `ProductsDataSource` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span></span>


<span data-ttu-id="2a1c7-125">配置对象数据源以使用`ProductsBLL`类的`GetProducts()`方法以检索产品信息。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method to retrieve product information.</span></span> <span data-ttu-id="2a1c7-126">对于本教程，允许 s 焦点严格上添加插入功能测试和无需担心编辑和删除。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-126">For this tutorial, let s focus strictly on adding inserting capabilities and not worry about editing and deleting.</span></span> <span data-ttu-id="2a1c7-127">因此，请确保插入选项卡中的下拉列表设置为`AddProduct()`并更新和删除选项卡中的下拉列表被设置为 （无）。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-127">Therefore, make sure that the drop-down list in the INSERT tab is set to `AddProduct()` and that the drop-down lists in the UPDATE and DELETE tabs are set to (None) .</span></span>


<span data-ttu-id="2a1c7-128">[![将 AddProduct 方法映射到 ObjectDataSource 的 Insert() 方法](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="2a1c7-128">[![Map the AddProduct Method to the ObjectDataSource s Insert() Method](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span></span>

<span data-ttu-id="2a1c7-129">**图 3**： 映射`AddProduct`ObjectDataSource 的方法`Insert()`方法 ([单击以查看实际尺寸的图像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="2a1c7-129">**Figure 3**: Map the `AddProduct` Method to the ObjectDataSource s `Insert()` Method ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span></span>


<span data-ttu-id="2a1c7-130">[![设置为 （无） 更新和删除选项卡下拉列表](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="2a1c7-130">[![Set the UPDATE and DELETE Tabs Drop-Down Lists to (None)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span></span>

<span data-ttu-id="2a1c7-131">**图 4**： 将更新和删除选项卡下拉列表设置为 （无） ([单击以查看实际尺寸的图像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="2a1c7-131">**Figure 4**: Set the UPDATE and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span></span>


<span data-ttu-id="2a1c7-132">完成 ObjectDataSource s 配置数据源向导后，Visual Studio 将自动将字段添加到 GridView 为每个相应的数据字段。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-132">After completing the ObjectDataSource s Configure Data Source wizard, Visual Studio will automatically add fields to the GridView for each of the corresponding data fields.</span></span> <span data-ttu-id="2a1c7-133">现在，将保留所有由 Visual Studio 添加的字段。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-133">For now, leave all of the fields added by Visual Studio.</span></span> <span data-ttu-id="2a1c7-134">稍后在本教程中我们将返回并删除其中一些字段，其值不需要添加一条新记录时指定。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-134">Later in this tutorial we'll come back and remove some of the fields whose values don t need to be specified when adding a new record.</span></span>

<span data-ttu-id="2a1c7-135">由于存在接近 80 产品在数据库中，用户将需要向下滚动一直到 web 页的底部才能添加新的记录。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-135">Since there are close to 80 products in the database, a user will have to scroll all the way down to the bottom of the web page in order to add a new record.</span></span> <span data-ttu-id="2a1c7-136">因此，让我们来启用分页更可见且可访问使插入的接口。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-136">Therefore, let s enable paging to make the inserting interface more visible and accessible.</span></span> <span data-ttu-id="2a1c7-137">若要打开分页，只需选中从 GridView s 智能标记启用分页复选框。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-137">To turn on paging, simply check the Enable Paging checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="2a1c7-138">此时，GridView 和 ObjectDataSource s 声明性标记应类似以下：</span><span class="sxs-lookup"><span data-stu-id="2a1c7-138">At this point, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample1.aspx)]


<span data-ttu-id="2a1c7-139">[![所有产品数据字段都显示在分页的 GridView](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="2a1c7-139">[![All Product Data Fields are Displayed in a Paged GridView](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span></span>

<span data-ttu-id="2a1c7-140">**图 5**： 所有产品数据字段都显示在分页 GridView ([单击以查看实际尺寸的图像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="2a1c7-140">**Figure 5**: All Product Data Fields are Displayed in a Paged GridView ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span></span>


## <a name="step-2-adding-a-footer-row"></a><span data-ttu-id="2a1c7-141">步骤 2： 添加页脚行</span><span class="sxs-lookup"><span data-stu-id="2a1c7-141">Step 2: Adding a Footer Row</span></span>

<span data-ttu-id="2a1c7-142">其标头和数据行，以及 GridView 包括的页脚行。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-142">Along with its header and data rows, the GridView includes a footer row.</span></span> <span data-ttu-id="2a1c7-143">根据 GridView s 的值显示页眉和页脚行[ `ShowHeader` ](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showheader.aspx)和[ `ShowFooter` ](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showfooter.aspx)属性。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-143">The header and footer rows are displayed depending on the values of the GridView s [`ShowHeader`](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showheader.aspx) and [`ShowFooter`](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showfooter.aspx) properties.</span></span> <span data-ttu-id="2a1c7-144">若要显示页脚行，只需将`ShowFooter`属性`True`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-144">To show the footer row, simply set the `ShowFooter` property to `True`.</span></span> <span data-ttu-id="2a1c7-145">如图 6 所示，设置`ShowFooter`属性`True`将的页脚行添加到网格。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-145">As Figure 6 illustrates, setting the `ShowFooter` property to `True` adds a footer row to the grid.</span></span>


<span data-ttu-id="2a1c7-146">[![若要显示页脚行，请将 ShowFooter 设置为 True](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="2a1c7-146">[![To Display the Footer Row, Set ShowFooter to True](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span></span>

<span data-ttu-id="2a1c7-147">**图 6**： 到显示页脚行中，设置`ShowFooter`到`True`([单击以查看实际尺寸的图像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="2a1c7-147">**Figure 6**: To Display the Footer Row, Set `ShowFooter` to `True` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span></span>


<span data-ttu-id="2a1c7-148">请注意，页脚行深红色背景颜色。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-148">Note that the footer row has a dark red background color.</span></span> <span data-ttu-id="2a1c7-149">这是由于 DataWebControls 主题我们创建并应用于所有页进来[将数据显示与 ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md)教程。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-149">This is due to the DataWebControls Theme we created and applied to all pages back in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial.</span></span> <span data-ttu-id="2a1c7-150">具体而言，`GridView.skin`文件将配置`FooterStyle`属性此类用于`FooterStyle`CSS 类。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-150">Specifically, the `GridView.skin` file configures the `FooterStyle` property such that is uses the `FooterStyle` CSS class.</span></span> <span data-ttu-id="2a1c7-151">`FooterStyle`类中定义`Styles.css`，如下所示：</span><span class="sxs-lookup"><span data-stu-id="2a1c7-151">The `FooterStyle` class is defined in `Styles.css` as follows:</span></span>


[!code-css[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample2.css)]

> [!NOTE]
> <span data-ttu-id="2a1c7-152">我们已介绍了在前面的教程中使用的 GridView 的页脚行。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-152">We ve explored using the GridView s footer row in previous tutorials.</span></span> <span data-ttu-id="2a1c7-153">如果需要回头参考[GridView 的页脚中显示摘要信息](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md)复习教程。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-153">If needed, refer back to the [Displaying Summary Information in the GridView's Footer](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial for a refresher.</span></span>


<span data-ttu-id="2a1c7-154">设置后`ShowFooter`属性`True`，花一些时间才能在浏览器中查看的输出。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-154">After setting the `ShowFooter` property to `True`, take a moment to view the output in a browser.</span></span> <span data-ttu-id="2a1c7-155">当前页脚行不包含任何文本或 Web 控件。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-155">Currently the footer row doesn t contain any text or Web controls.</span></span> <span data-ttu-id="2a1c7-156">在步骤 3 中我们将修改每个 GridView 字段的页脚，以使其包括适当的插入接口。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-156">In Step 3 we'll modify the footer for each GridView field so that it includes the appropriate inserting interface.</span></span>


<span data-ttu-id="2a1c7-157">[![空的页脚行是显示上面分页接口控制](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="2a1c7-157">[![The Empty Footer Row is Displayed Above the Paging Interface Controls](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span></span>

<span data-ttu-id="2a1c7-158">**图 7**: 空页脚行是显示上面分页接口控制 ([单击以查看实际尺寸的图像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="2a1c7-158">**Figure 7**: The Empty Footer Row is Displayed Above the Paging Interface Controls ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span></span>


## <a name="step-3-customizing-the-footer-row"></a><span data-ttu-id="2a1c7-159">步骤 3： 自定义的页脚行</span><span class="sxs-lookup"><span data-stu-id="2a1c7-159">Step 3: Customizing the Footer Row</span></span>

<span data-ttu-id="2a1c7-160">返回[GridView 控件中使用 TemplateFields](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md)教程，我们已了解如何极大地自定义使用 TemplateFields （而不是 BoundFields 或 CheckBoxFields） 的特定 GridView 列的显示; 在[自定义的数据修改界面](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md)我们看使用 TemplateFields 自定义在 GridView 的编辑界面。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-160">Back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial we saw how to greatly customize the display of a particular GridView column using TemplateFields (as opposed to BoundFields or CheckBoxFields); in [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) we looked at using TemplateFields to customize the editing interface in a GridView.</span></span> <span data-ttu-id="2a1c7-161">回想一下 TemplateField 组成了许多的模板定义的标记、 Web 控件和数据绑定语法的组合，用于某些类型的行。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-161">Recall that a TemplateField is composed of a number of templates that defines the mix of markup, Web controls, and databinding syntax used for certain types of rows.</span></span> <span data-ttu-id="2a1c7-162">`ItemTemplate`，例如，指定用于只读的行的模板时`EditItemTemplate`定义可编辑的行的模板。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-162">The `ItemTemplate`, for example, specifies the template used for read-only rows, while the `EditItemTemplate` defines the template for the editable row.</span></span>

<span data-ttu-id="2a1c7-163">连同`ItemTemplate`和`EditItemTemplate`，TemplateField 还包括`FooterTemplate`，它指定页脚行的内容。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-163">Along with the `ItemTemplate` and `EditItemTemplate`, the TemplateField also includes a `FooterTemplate` that specifies the content for the footer row.</span></span> <span data-ttu-id="2a1c7-164">因此，我们可以将添加所需的每个字段 s 插入到接口的 Web 控件`FooterTemplate`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-164">Therefore, we can add the Web controls needed for each field s inserting interface into the `FooterTemplate`.</span></span> <span data-ttu-id="2a1c7-165">若要开始，请将所有 GridView 中的字段转换为 TemplateFields。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-165">To start, convert all of the fields in the GridView to TemplateFields.</span></span> <span data-ttu-id="2a1c7-166">这可以单击 GridView s 智能标记，在左下角，选择每个字段和 TemplateField 链接到单击转换此字段中的编辑列链接。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-166">This can be done by clicking the Edit Columns link in the GridView s smart tag, selecting each field in the lower left corner, and clicking the Convert this field into a TemplateField link.</span></span>


![将每个字段转换为 TemplateField](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.gif)

<span data-ttu-id="2a1c7-168">**图 8**： 将每个字段转换为 TemplateField</span><span class="sxs-lookup"><span data-stu-id="2a1c7-168">**Figure 8**: Convert Each Field Into a TemplateField</span></span>


<span data-ttu-id="2a1c7-169">单击转换转换为 TemplateField 此字段将变为等效 TemplateField 到当前的字段类型。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-169">Clicking the Convert this field into a TemplateField turns the current field type into an equivalent TemplateField.</span></span> <span data-ttu-id="2a1c7-170">例如，每个 BoundField 替换为 TemplateField`ItemTemplate`包含显示相应的数据字段的标签和`EditItemTemplate`文本框中显示数据字段。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-170">For example, each BoundField is replaced by a TemplateField with an `ItemTemplate` that contains a Label that displays the corresponding data field and an `EditItemTemplate` that displays the data field in a TextBox.</span></span> <span data-ttu-id="2a1c7-171">`ProductName` BoundField 已转换为以下 TemplateField 标记：</span><span class="sxs-lookup"><span data-stu-id="2a1c7-171">The `ProductName` BoundField has been converted into the following TemplateField markup:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample3.aspx)]

<span data-ttu-id="2a1c7-172">同样， `Discontinued` CheckBoxField 已转换为 TemplateField 其`ItemTemplate`和`EditItemTemplate`包含复选框 Web 控件 (使用`ItemTemplate`s 禁用的复选框)。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-172">Likewise, the `Discontinued` CheckBoxField has been converted into a TemplateField whose `ItemTemplate` and `EditItemTemplate` contain a CheckBox Web control (with the `ItemTemplate` s CheckBox disabled).</span></span> <span data-ttu-id="2a1c7-173">只读`ProductID`BoundField 已转换为与标签控件中都为 TemplateField`ItemTemplate`和`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-173">The read-only `ProductID` BoundField has been converted into a TemplateField with a Label control in both the `ItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="2a1c7-174">字段转换为 TemplateField 转换现有的 GridView 简单地说，是功能的一种在切换到更容易自定义 TemplateField 而不丢失任何现有字段的快速而简单的方法。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-174">In short, converting an existing GridView field into a TemplateField is a quick and easy way to switch to the more customizable TemplateField without losing any of the existing field s functionality.</span></span>

<span data-ttu-id="2a1c7-175">自 GridView 我们重新使用没有 t 支持编辑，请尝试删除`EditItemTemplate`只需从每个 TemplateField 离开`ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-175">Since the GridView we re working with doesn t support editing, feel free to remove the `EditItemTemplate` from each TemplateField, leaving just the `ItemTemplate`.</span></span> <span data-ttu-id="2a1c7-176">完成后，你 GridView s 声明性标记应如下所示：</span><span class="sxs-lookup"><span data-stu-id="2a1c7-176">After doing this, your GridView s declarative markup should look like the following:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample4.aspx)]

<span data-ttu-id="2a1c7-177">现在，已转换为 TemplateField 转换每个 GridView 字段，我们可以向每个字段 s 输入适当的插入接口`FooterTemplate`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-177">Now that each GridView field has been converted into a TemplateField, we can enter the appropriate inserting interface into each field s `FooterTemplate`.</span></span> <span data-ttu-id="2a1c7-178">某些字段不会插入接口 (`ProductID`，例如); 其他会随之用于收集新的产品的信息的 Web 控件。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-178">Some of the fields will not have an inserting interface (`ProductID`, for instance); others will vary in the Web controls used to collect the new product s information.</span></span>

<span data-ttu-id="2a1c7-179">若要创建的编辑界面，请从 GridView s 智能标记中选择编辑模板链接。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-179">To create the editing interface, choose the Edit Templates link from the GridView s smart tag.</span></span> <span data-ttu-id="2a1c7-180">然后，从下拉列表中，选择相应的字段的`FooterTemplate`并将相应的控件拖到设计器工具箱。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-180">Then, from the drop-down list, select the appropriate field s `FooterTemplate` and drag the appropriate control from the Toolbox onto the Designer.</span></span>


<span data-ttu-id="2a1c7-181">[![将相应的插入接口添加到每个字段的要](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="2a1c7-181">[![Add the Appropriate Inserting Interface to Each Field s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span></span>

<span data-ttu-id="2a1c7-182">**图 9**： 将相应的插入接口添加到每个字段 s `FooterTemplate` ([单击以查看实际尺寸的图像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="2a1c7-182">**Figure 9**: Add the Appropriate Inserting Interface to Each Field s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span></span>


<span data-ttu-id="2a1c7-183">以下项目符号列表枚举 GridView 字段，指定要添加的插入接口：</span><span class="sxs-lookup"><span data-stu-id="2a1c7-183">The following bulleted list enumerates the GridView fields, specifying the inserting interface to add:</span></span>

- <span data-ttu-id="2a1c7-184">`ProductID` 无。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-184">`ProductID` none.</span></span>
- <span data-ttu-id="2a1c7-185">`ProductName` 添加一个文本框，并设置其`ID`到`NewProductName`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-185">`ProductName` add a TextBox and set its `ID` to `NewProductName`.</span></span> <span data-ttu-id="2a1c7-186">添加 RequiredFieldValidator 控件以确保用户输入一个值，新的产品 s 名称。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-186">Add a RequiredFieldValidator control as well to ensure that the user enters a value for the new product s name.</span></span>
- <span data-ttu-id="2a1c7-187">`SupplierID` 无。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-187">`SupplierID` none.</span></span>
- <span data-ttu-id="2a1c7-188">`CategoryID` 无。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-188">`CategoryID` none.</span></span>
- <span data-ttu-id="2a1c7-189">`QuantityPerUnit` 添加文本框中，设置其`ID`到`NewQuantityPerUnit`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-189">`QuantityPerUnit` add a TextBox, setting its `ID` to `NewQuantityPerUnit`.</span></span>
- <span data-ttu-id="2a1c7-190">`UnitPrice` 添加名为的文本框`NewUnitPrice`和 CompareValidator，以确保输入的值是大于或等于零的货币值。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-190">`UnitPrice` add a TextBox named `NewUnitPrice` and a CompareValidator that ensures the value entered is a currency value greater than or equal to zero.</span></span>
- <span data-ttu-id="2a1c7-191">`UnitsInStock` 使用文本框中其`ID`设置为`NewUnitsInStock`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-191">`UnitsInStock` use a TextBox whose `ID` is set to `NewUnitsInStock`.</span></span> <span data-ttu-id="2a1c7-192">包括 CompareValidator，以确保输入的值是大于或等于零的整数值。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-192">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="2a1c7-193">`UnitsOnOrder` 使用文本框中其`ID`设置为`NewUnitsOnOrder`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-193">`UnitsOnOrder` use a TextBox whose `ID` is set to `NewUnitsOnOrder`.</span></span> <span data-ttu-id="2a1c7-194">包括 CompareValidator，以确保输入的值是大于或等于零的整数值。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-194">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="2a1c7-195">`ReorderLevel` 使用文本框中其`ID`设置为`NewReorderLevel`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-195">`ReorderLevel` use a TextBox whose `ID` is set to `NewReorderLevel`.</span></span> <span data-ttu-id="2a1c7-196">包括 CompareValidator，以确保输入的值是大于或等于零的整数值。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-196">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="2a1c7-197">`Discontinued` 添加一个复选框，设置其`ID`到`NewDiscontinued`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-197">`Discontinued` add a CheckBox, setting its `ID` to `NewDiscontinued`.</span></span>
- <span data-ttu-id="2a1c7-198">`CategoryName` 添加的 DropDownList 并设置其`ID`到`NewCategoryID`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-198">`CategoryName` add a DropDownList and set its `ID` to `NewCategoryID`.</span></span> <span data-ttu-id="2a1c7-199">将其绑定到名为新 ObjectDataSource`CategoriesDataSource`和将其配置为使用`CategoriesBLL`类的`GetCategories()`方法。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-199">Bind it to a new ObjectDataSource named `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories()` method.</span></span> <span data-ttu-id="2a1c7-200">具有 DropDownList s `ListItem` s 显示`CategoryName`数据字段中，使用`CategoryID`作为其值的数据字段。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-200">Have the DropDownList s `ListItem` s display the `CategoryName` data field, using the `CategoryID` data field as their values.</span></span>
- <span data-ttu-id="2a1c7-201">`SupplierName` 添加的 DropDownList 并设置其`ID`到`NewSupplierID`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-201">`SupplierName` add a DropDownList and set its `ID` to `NewSupplierID`.</span></span> <span data-ttu-id="2a1c7-202">将其绑定到名为新 ObjectDataSource`SuppliersDataSource`和将其配置为使用`SuppliersBLL`类的`GetSuppliers()`方法。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-202">Bind it to a new ObjectDataSource named `SuppliersDataSource` and configure it to use the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="2a1c7-203">具有 DropDownList s `ListItem` s 显示`CompanyName`数据字段中，使用`SupplierID`作为其值的数据字段。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-203">Have the DropDownList s `ListItem` s display the `CompanyName` data field, using the `SupplierID` data field as their values.</span></span>

<span data-ttu-id="2a1c7-204">对于每个验证控件中，清除`ForeColor`属性以便`FooterStyle`CSS 类 s 白色前景颜色将代替红色默认值。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-204">For each of the validation controls, clear out the `ForeColor` property so that the `FooterStyle` CSS class s white foreground color will be used in place of the default red.</span></span> <span data-ttu-id="2a1c7-205">此外使用`ErrorMessage`属性的详细说明，但设置`Text`为星号的属性。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-205">Also use the `ErrorMessage` property for a detailed description, but set the `Text` property to an asterisk.</span></span> <span data-ttu-id="2a1c7-206">若要防止验证控件的文本导致要换到两个行的插入接口，设置`FooterStyle`s`Wrap`属性设置为 false 的每个`FooterTemplate`使用验证控件的 s。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-206">To prevent the validation control s text from causing the inserting interface to wrap to two lines, set the `FooterStyle` s `Wrap` property to false for each of the `FooterTemplate` s that use a validation control.</span></span> <span data-ttu-id="2a1c7-207">最后，添加 ValidationSummary 控件下 GridView 并设置其`ShowMessageBox`属性`True`及其`ShowSummary`属性`False`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-207">Finally, add a ValidationSummary control beneath the GridView and set its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span>

<span data-ttu-id="2a1c7-208">在添加新产品时，我们需要提供`CategoryID`和`SupplierID`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-208">When adding a new product, we need to provide the `CategoryID` and `SupplierID`.</span></span> <span data-ttu-id="2a1c7-209">通过中的页脚单元格 DropDownLists 捕获此信息`CategoryName`和`SupplierName`字段。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-209">This information is captured through the DropDownLists in the footer cells for the `CategoryName` and `SupplierName` fields.</span></span> <span data-ttu-id="2a1c7-210">我选择了使用这些字段相对于`CategoryID`和`SupplierID`TemplateFields 因为网格的数据行用户很可能更感兴趣的类别和供应商名称而不是其 ID 值。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-210">I chose to use these fields as opposed to the `CategoryID` and `SupplierID` TemplateFields because in the grid s data rows the user is likely more interested in seeing the category and supplier names rather than their ID values.</span></span> <span data-ttu-id="2a1c7-211">由于`CategoryID`和`SupplierID`值现在正在以捕获`CategoryName`和`SupplierName`字段 s 插入接口，我们可以删除`CategoryID`和`SupplierID`TemplateFields 从 GridView。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-211">Since the `CategoryID` and `SupplierID` values are now being captured in the `CategoryName` and `SupplierName` field s inserting interfaces, we can remove the `CategoryID` and `SupplierID` TemplateFields from the GridView.</span></span>

<span data-ttu-id="2a1c7-212">同样，`ProductID`未使用时添加一个新的产品，因此`ProductID`TemplateField 可以以及删除。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-212">Similarly, the `ProductID` is not used when adding a new product, so the `ProductID` TemplateField can be removed as well.</span></span> <span data-ttu-id="2a1c7-213">但是，让我们来保留`ProductID`字段在网格中。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-213">However, let s leave the `ProductID` field in the grid.</span></span> <span data-ttu-id="2a1c7-214">除了文本框中、 DropDownLists、 复选框，和构成插入接口的验证控件中，我们还需要添加按钮，单击时，执行逻辑，以向数据库添加新的产品。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-214">In addition to the TextBoxes, DropDownLists, CheckBoxes, and validation controls that make up the inserting interface, we'll also need an Add button that, when clicked, performs the logic to add the new product to the database.</span></span> <span data-ttu-id="2a1c7-215">在步骤 4 中，我们将包含插入接口中添加按钮`ProductID`TemplateField 的`FooterTemplate`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-215">In Step 4 we'll include an Add button in the inserting interface in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="2a1c7-216">随意提高各种 GridView 字段的外观。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-216">Feel free to improve the appearance of the various GridView fields.</span></span> <span data-ttu-id="2a1c7-217">例如，你可能想要设置格式`UnitPrice`值作为货币、 右对齐`UnitsInStock`， `UnitsOnOrder`，和`ReorderLevel`字段和更新`HeaderText`TemplateFields 的值。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-217">For example, you might want to format the `UnitPrice` values as a currency, right-align the `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` fields, and update the `HeaderText` values for the TemplateFields.</span></span>

<span data-ttu-id="2a1c7-218">创建插入接口中的许多之后`FooterTemplate`s，删除`SupplierID`，和`CategoryID`TemplateFields，并提高的格式和对齐方式 TemplateFields，声明性你 GridView s 通过网格美感标记应类似于以下形式：</span><span class="sxs-lookup"><span data-stu-id="2a1c7-218">After creating the slew of inserting interfaces in the `FooterTemplate` s, removing the `SupplierID`, and `CategoryID` TemplateFields, and improving the aesthetics of the grid through formatting and aligning the TemplateFields, your GridView s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample5.aspx)]

<span data-ttu-id="2a1c7-219">查看通过浏览器时, 的 GridView 的页脚行现在包含完成插入接口 （请参阅图 10）。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-219">When viewed through a browser, the GridView s footer row now includes the completed inserting interface (see Figure 10).</span></span> <span data-ttu-id="2a1c7-220">此时，插入的接口不包括用户指示该她 s 为新产品输入数据，并且想要将一个新记录插入数据库的一种方法。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-220">At this point, the inserting interface doesn t include a means for the user to indicate that she s entered the data for the new product and wants to insert a new record into the database.</span></span> <span data-ttu-id="2a1c7-221">此外，我们已有待解决如何插入页脚输入的数据将转换到一条新记录中`Products`数据库。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-221">Also, we ve yet to address how the data entered into the footer will translate into a new record in the `Products` database.</span></span> <span data-ttu-id="2a1c7-222">在步骤 4 中我们将查看如何包含添加按钮对插入的接口以及如何在执行代码回发时它 s 单击。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-222">In Step 4 we'll look at how to include an Add button to the inserting interface and how to execute code on postback when it s clicked.</span></span> <span data-ttu-id="2a1c7-223">第 5 步演示如何插入新记录使用页脚中的数据。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-223">Step 5 shows how to insert a new record using the data from the footer.</span></span>


<span data-ttu-id="2a1c7-224">[![GridView 页脚提供用于添加新记录的接口](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="2a1c7-224">[![The GridView Footer Provides an Interface for Adding a New Record](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span></span>

<span data-ttu-id="2a1c7-225">**图 10**: GridView 页脚提供用于添加新记录的接口 ([单击以查看实际尺寸的图像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="2a1c7-225">**Figure 10**: The GridView Footer Provides an Interface for Adding a New Record ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span></span>


## <a name="step-4-including-an-add-button-in-the-inserting-interface"></a><span data-ttu-id="2a1c7-226">步骤 4： 在插入界面中包括的添加按钮</span><span class="sxs-lookup"><span data-stu-id="2a1c7-226">Step 4: Including an Add Button in the Inserting Interface</span></span>

<span data-ttu-id="2a1c7-227">我们需要添加按钮某个位置在接口中包含插入因为当前插入接口的页脚行 s 中没有用于用户指示他们已完成输入新的产品的信息的方法。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-227">We need to include an Add button somewhere in the inserting interface since the footer row s inserting interface currently lacks the means for the user to indicate that they have completed entering the new product s information.</span></span> <span data-ttu-id="2a1c7-228">这无法放入一个现有`FooterTemplate`s，或者我们无法添加一个新列在网格为此目的。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-228">This could be placed in one of the existing `FooterTemplate` s or we could add a new column to the grid for this purpose.</span></span> <span data-ttu-id="2a1c7-229">对于本教程中，让 s 将放在添加按钮`ProductID`TemplateField 的`FooterTemplate`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-229">For this tutorial, let s place the Add button in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="2a1c7-230">从设计器中，单击 GridView s 智能标记中的编辑模板链接，然后选择`ProductID`字段的`FooterTemplate`从下拉列表。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-230">From the Designer, click on the Edit Templates link in the GridView s smart tag and then choose the `ProductID` field s `FooterTemplate` from the drop-down list.</span></span> <span data-ttu-id="2a1c7-231">添加到模板，将其 ID 设置为的 Button Web 控件 （或 LinkButton 或 ImageButton，如果你愿意） `AddProduct`，将其`CommandName`插入，并且其`Text`添加图 11 中所示的属性。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-231">Add a Button Web control (or a LinkButton or ImageButton, if you prefer) to the template, setting its ID to `AddProduct`, its `CommandName` to Insert, and its `Text` property to Add as shown in Figure 11.</span></span>


<span data-ttu-id="2a1c7-232">[![添加按钮置于 ProductID TemplateField 的要](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="2a1c7-232">[![Place the Add Button in the ProductID TemplateField s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span></span>

<span data-ttu-id="2a1c7-233">**图 11**： 放置在添加按钮`ProductID`TemplateField s `FooterTemplate` ([单击以查看实际尺寸的图像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="2a1c7-233">**Figure 11**: Place the Add Button in the `ProductID` TemplateField s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span></span>


<span data-ttu-id="2a1c7-234">一旦你已包含添加按钮，测试浏览器中的页。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-234">Once you ve included the Add button, test out the page in a browser.</span></span> <span data-ttu-id="2a1c7-235">请注意，当单击添加按钮使用插入的接口中的数据无效，简单地说 circuited 回发 ValidationSummary 控件指示无效的数据 （请参阅图 12）。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-235">Note that when clicking the Add button with invalid data in the inserting interface, the postback is short circuited and the ValidationSummary control indicates the invalid data (see Figure 12).</span></span> <span data-ttu-id="2a1c7-236">输入适当的数据，单击添加按钮会导致回发。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-236">With appropriate data entered, clicking the Add button causes a postback.</span></span> <span data-ttu-id="2a1c7-237">没有记录添加到数据库，但是。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-237">No record is added to the database, however.</span></span> <span data-ttu-id="2a1c7-238">我们将需要编写的代码来实际执行插入。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-238">We will need to write a bit of code to actually perform the insert.</span></span>


<span data-ttu-id="2a1c7-239">[![添加按钮 s 回发，则短 Circuited 如果插入界面中存在无效的数据](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="2a1c7-239">[![The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span></span>

<span data-ttu-id="2a1c7-240">**图 12**: 添加按钮 s 回发是短 Circuited 如果插入界面中存在无效的数据 ([单击以查看实际尺寸的图像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="2a1c7-240">**Figure 12**: The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span></span>


> [!NOTE]
> <span data-ttu-id="2a1c7-241">插入的接口中的验证控件不会将分配给验证组。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-241">The validation controls in the inserting interface were not assigned to a validation group.</span></span> <span data-ttu-id="2a1c7-242">这很好地配合只要插入接口是唯一的页面上的验证控件集。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-242">This works fine so long as the inserting interface is the only set of validation controls on the page.</span></span> <span data-ttu-id="2a1c7-243">如果，但是，有其他验证控件 （如网格 s 编辑界面中的验证控件） 页上，验证控件中插入接口，并添加按钮的`ValidationGroup`属性应分配相同的值作为 so 到将这些控件与特定的验证组相关联。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-243">If, however, there are other validation controls on the page (such as validation controls in the grid s editing interface), the validation controls in the inserting interface and Add button s `ValidationGroup` properties should be assigned the same value so as to associate these controls with a particular validation group.</span></span> <span data-ttu-id="2a1c7-244">请参阅[将 ASP.NET 2.0 中的验证控件](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)有关分区的验证控件和在页面上的按钮为验证组的详细信息。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-244">See [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) for more information on partitioning the validation controls and buttons on a page into validation groups.</span></span>


## <a name="step-5-inserting-a-new-record-into-theproductstable"></a><span data-ttu-id="2a1c7-245">步骤 5： 插入一条新记录到`Products`表</span><span class="sxs-lookup"><span data-stu-id="2a1c7-245">Step 5: Inserting a New Record Into the`Products`Table</span></span>

<span data-ttu-id="2a1c7-246">当利用内置的编辑功能的 GridView，GridView 自动处理所有所需执行更新的工作。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-246">When utilizing the built-in editing features of the GridView, the GridView automatically handles all of the work necessary for performing the update.</span></span> <span data-ttu-id="2a1c7-247">具体而言，单击更新按钮时复制从编辑接口输入到 ObjectDataSource s 中的参数的值`UpdateParameters`集合和关闭通过调用 ObjectDataSource 的更新的启动`Update()`方法。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-247">In particular, when the Update button is clicked it copies the values entered from the editing interface to the parameters in the ObjectDataSource s `UpdateParameters` collection and kicks off the update by invoking the ObjectDataSource s `Update()` method.</span></span> <span data-ttu-id="2a1c7-248">由于 GridView 不提供此类用于插入的内置功能，我们必须实现调用 ObjectDataSource 的代码`Insert()`方法和 ObjectDataSource s 接口中插入的值的副本`InsertParameters`集合.</span><span class="sxs-lookup"><span data-stu-id="2a1c7-248">Since the GridView does not provide such built-in functionality for inserting, we must implement code that calls the ObjectDataSource s `Insert()` method and copies the values from the inserting interface to the ObjectDataSource s `InsertParameters` collection.</span></span>

<span data-ttu-id="2a1c7-249">后单击添加按钮后，应执行此插入逻辑。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-249">This insert logic should be executed after the Add button has been clicked.</span></span> <span data-ttu-id="2a1c7-250">中所述[添加和响应中 GridView 按钮](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md)教程中，每当按钮、 LinkButton 或在 GridView ImageButton 单击后，GridView 的`RowCommand`在回发事件激发。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-250">As discussed in the [Adding and Responding to Buttons in a GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) tutorial, anytime a Button, LinkButton, or ImageButton in a GridView is clicked, the GridView s `RowCommand` event fires on postback.</span></span> <span data-ttu-id="2a1c7-251">是否按钮、 LinkButton 或 ImageButton 已添加显式如页脚行中的添加按钮，或如果它已自动添加通过 GridView 会激发此事件 (如选中启用排序后，每个列顶部 LinkButtons 或在分页界面当选中启用分页时 LinkButtons)。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-251">This event fires whether the Button, LinkButton, or ImageButton was added explicitly such as the Add button in the footer row or if it was automatically added by the GridView (such as the LinkButtons at the top of each column when Enable Sorting is selected, or the LinkButtons in the paging interface when Enable Paging is selected).</span></span>

<span data-ttu-id="2a1c7-252">因此，若要响应用户单击添加按钮，我们需要创建的事件处理程序 GridView 的`RowCommand`事件。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-252">Therefore, to respond to the user clicking the Add button, we need to create an event handler for the GridView s `RowCommand` event.</span></span> <span data-ttu-id="2a1c7-253">由于此事件时将触发*任何*单击按钮、 LinkButton 或在 GridView ImageButton 后，它 s 重要，我们仅使用插入的逻辑的情况下继续`CommandName`属性到传递到事件处理程序映射`CommandName`的添加按钮 (Insert) 的值。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-253">Since this event fires whenever *any* Button, LinkButton, or ImageButton in the GridView is clicked, it s vital that we only proceed with the inserting logic if the `CommandName` property passed into the event handler maps to the `CommandName` value of the Add button ( Insert ).</span></span> <span data-ttu-id="2a1c7-254">此外，我们还仅在才继续验证控件报告有效的数据。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-254">Moreover, we should also only proceed if the validation controls report valid data.</span></span> <span data-ttu-id="2a1c7-255">为此，创建的事件处理程序`RowCommand`事件替换为以下代码：</span><span class="sxs-lookup"><span data-stu-id="2a1c7-255">To accommodate this, create an event handler for the `RowCommand` event with the following code:</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample6.vb)]

> [!NOTE]
> <span data-ttu-id="2a1c7-256">你可能想知道为什么事件处理程序厌烦检查`Page.IsValid`属性。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-256">You may be wondering why the event handler bothers checking the `Page.IsValid` property.</span></span> <span data-ttu-id="2a1c7-257">在所有情况中插入的接口提供无效的数据，被抑制获胜的 t 回发？</span><span class="sxs-lookup"><span data-stu-id="2a1c7-257">After all, won t the postback be suppressed if invalid data is provided in the inserting interface?</span></span> <span data-ttu-id="2a1c7-258">此假设是正确的只要用户具有未禁用 JavaScript 或执行了步骤，若要避免客户端验证逻辑。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-258">This assumption is correct as long as the user has not disabled JavaScript or has taken steps to circumvent the client-side validation logic.</span></span> <span data-ttu-id="2a1c7-259">简单地说，一个应永远不会完全依赖于客户端验证，则为始终应使用的数据之前执行服务器端检查的有效性。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-259">In short, one should never rely strictly on client-side validation; a server-side check for validity should always be performed before working with the data.</span></span>


<span data-ttu-id="2a1c7-260">在步骤 1 中，我们创建`ProductsDataSource`ObjectDataSource 以便其`Insert()`方法映射到`ProductsBLL`类的`AddProduct`方法。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-260">In Step 1 we created the `ProductsDataSource` ObjectDataSource such that its `Insert()` method is mapped to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="2a1c7-261">用于插入新记录到`Products`表，我们可以只需调用 ObjectDataSource 的`Insert()`方法：</span><span class="sxs-lookup"><span data-stu-id="2a1c7-261">To insert the new record into the `Products` table, we can simply invoke the ObjectDataSource s `Insert()` method:</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample7.vb)]

<span data-ttu-id="2a1c7-262">现在，`Insert()`调用方法时，所有剩下就是进行插入的接口的值复制到的参数传递到`ProductsBLL`类的`AddProduct`方法。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-262">Now that the `Insert()` method has been invoked, all that remains is to copy the values from the inserting interface to the parameters passed to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="2a1c7-263">正如我们所看到的进来[检查与插入、 更新和删除的事件相关联](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)教程，则这可以通过 ObjectDataSource s 来实现`Inserting`事件。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-263">As we saw back in the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial, this can be accomplished through the ObjectDataSource s `Inserting` event.</span></span> <span data-ttu-id="2a1c7-264">在`Inserting`我们需要以编程方式引用中的所有控件的事件`Products`GridView 的页脚行并将分配到其值`e.InputParameters`集合。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-264">In the `Inserting` event we need to programmatically reference the controls from the `Products` GridView s footer row and assign their values to the `e.InputParameters` collection.</span></span> <span data-ttu-id="2a1c7-265">如果用户省略一个值，如离开`ReorderLevel`文本框中为空白，我们需要指定插入到数据库中的值应为`NULL`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-265">If the user omits a value such as leaving the `ReorderLevel` TextBox blank we need to specify that the value inserted into the database should be `NULL`.</span></span> <span data-ttu-id="2a1c7-266">由于`AddProducts`方法接受可以为 null 的数据库字段可以为 null 的类型，只需使用可以为 null 的类型，并将其值设置为`Nothing`在其中省略用户输入的情况下。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-266">Since the `AddProducts` method accepts nullable types for the nullable database fields, simply use a nullable type and set its value to `Nothing` in the case where user input is omitted.</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample8.vb)]

<span data-ttu-id="2a1c7-267">与`Inserting`完成的事件处理程序，新的记录可以添加到`Products`通过 GridView 的页脚行的数据库表。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-267">With the `Inserting` event handler completed, new records can be added to the `Products` database table via the GridView s footer row.</span></span> <span data-ttu-id="2a1c7-268">请继续并尝试添加几个新产品。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-268">Go ahead and try adding several new products.</span></span>

## <a name="enhancing-and-customizing-the-add-operation"></a><span data-ttu-id="2a1c7-269">增强和自定义添加的操作</span><span class="sxs-lookup"><span data-stu-id="2a1c7-269">Enhancing and Customizing the Add Operation</span></span>

<span data-ttu-id="2a1c7-270">目前，单击添加按钮将一条新记录添加到数据库表，但不提供任何种类的可视反馈，已成功添加记录。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-270">Currently, clicking the Add button adds a new record to the database table but does not provide any sort of visual feedback that the record has successfully been added.</span></span> <span data-ttu-id="2a1c7-271">理想情况下，标签 Web 控件或客户端警报框将通知用户他们插入已成功完成。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-271">Ideally, a Label Web control or client-side alert box would inform the user that their insert has completed with success.</span></span> <span data-ttu-id="2a1c7-272">我将此作为练习为读取器。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-272">I leave this as an exercise for the reader.</span></span>

<span data-ttu-id="2a1c7-273">本教程中使用 GridView 不适用于任何排序顺序列出的产品中，也不允许最终用户对数据进行排序。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-273">The GridView used in this tutorial does not apply any sort order to the listed products, nor does it allow the end user to sort the data.</span></span> <span data-ttu-id="2a1c7-274">因此，记录进行排序，因为它们是由其主键的主键字段数据库中。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-274">Consequently, the records are ordered as they are in the database by their primary key field.</span></span> <span data-ttu-id="2a1c7-275">由于每个新的记录具有`ProductID`大于最后一个，每次新产品添加到网格的末尾附加在值。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-275">Since each new record has a `ProductID` value greater than the last one, every time a new product is added it is tacked on to the end of the grid.</span></span> <span data-ttu-id="2a1c7-276">因此，你可能想要自动将用户发送到的 GridView 的最后一页，添加一条新记录后。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-276">Therefore, you may want to automatically send the user to the last page of the GridView after adding a new record.</span></span> <span data-ttu-id="2a1c7-277">这可以通过在调用后添加以下代码行来实现`ProductsDataSource.Insert()`中`RowCommand`事件处理程序，以指示用户需要发送的最后一页数据绑定到 GridView 后：</span><span class="sxs-lookup"><span data-stu-id="2a1c7-277">This can be accomplished by adding the following line of code after the call to `ProductsDataSource.Insert()` in the `RowCommand` event handler to indicate that the user needs to be sent to the last page after binding the data to the GridView:</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample9.vb)]

<span data-ttu-id="2a1c7-278">`SendUserToLastPage` 最初的页级别布尔变量分配值`False`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-278">`SendUserToLastPage` is a page-level Boolean variable that is initially assigned a value of `False`.</span></span> <span data-ttu-id="2a1c7-279">在 GridView`DataBound`事件处理程序，如果`SendUserToLastPage`为 false，`PageIndex`属性进行更新，向用户发送的最后一页。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-279">In the GridView s `DataBound` event handler, if `SendUserToLastPage` is false, the `PageIndex` property is updated to send the user to the last page.</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample10.vb)]

<span data-ttu-id="2a1c7-280">原因`PageIndex`属性在中设置`DataBound`事件处理程序 (而非`RowCommand`事件处理程序) 是因为当`RowCommand`事件处理程序，将引发我们遇到有待向其中添加新记录`Products`数据库表。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-280">The reason the `PageIndex` property is set in the `DataBound` event handler (as opposed to the `RowCommand` event handler) is because when the `RowCommand` event handler fires we ve yet to add the new record to the `Products` database table.</span></span> <span data-ttu-id="2a1c7-281">因此，在`RowCommand`事件处理程序的最后一个的页索引 (`PageCount - 1`) 表示最后一个的页索引*之前*已添加新的产品。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-281">Therefore, in the `RowCommand` event handler the last page index (`PageCount - 1`) represents the last page index *before* the new product has been added.</span></span> <span data-ttu-id="2a1c7-282">对于所添加的产品的大多数，最后一个的页索引是相同的后添加新的产品。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-282">For the majority of products being added, the last page index is the same after adding the new product.</span></span> <span data-ttu-id="2a1c7-283">但是当添加一项产品会导致新的最后一页索引，如果我们将错误地更新`PageIndex`中`RowCommand`事件处理程序然后我们将转到第二个到最后一页 （在添加新产品之前的最后一页索引） 而不是新的最后一页 index。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-283">But when the added product results in a new last page index, if we incorrectly update the `PageIndex` in the `RowCommand` event handler then we'll be taken to the second to last page (the last page index prior to adding the new product) as opposed to the new last page index.</span></span> <span data-ttu-id="2a1c7-284">由于`DataBound`之后添加了新的产品，通过设置，数据重新绑定到网格中，将触发的事件处理程序`PageIndex`属性存在我们知道我们重新获取正确的最后一页索引。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-284">Since the `DataBound` event handler fires after the new product has been added and the data rebound to the grid, by setting the `PageIndex` property there we know we re getting the correct last page index.</span></span>

<span data-ttu-id="2a1c7-285">最后，本教程中使用 GridView 是相当宽由于必须为添加新产品收集的字段数。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-285">Finally, the GridView used in this tutorial is quite wide due to the number of fields that must be collected for adding a new product.</span></span> <span data-ttu-id="2a1c7-286">由于此宽度，说明如何 s 垂直布局可能是首选。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-286">Due to this width, a DetailsView s vertical layout might be preferred.</span></span> <span data-ttu-id="2a1c7-287">GridView s 可通过收集较少输入减少总体宽度。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-287">The GridView s overall width could be reduced by collecting fewer inputs.</span></span> <span data-ttu-id="2a1c7-288">可能是我们不收集 t 需要`UnitsOnOrder`， `UnitsInStock`，和`ReorderLevel`字段时添加一个新的产品，在这种情况下可能从 GridView 中删除这些字段。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-288">Perhaps we don t need to collect the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields when adding a new product, in which case these fields could be removed from the GridView.</span></span>

<span data-ttu-id="2a1c7-289">若要调整收集的数据，我们可以使用两种方法之一：</span><span class="sxs-lookup"><span data-stu-id="2a1c7-289">To adjust the data collected, we can use one of two approaches:</span></span>

- <span data-ttu-id="2a1c7-290">继续使用`AddProduct`需要为值的方法`UnitsOnOrder`， `UnitsInStock`，和`ReorderLevel`字段。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-290">Continue to use the `AddProduct` method that expects values for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="2a1c7-291">在`Inserting`事件处理程序，提供硬编码，默认值用于已从插入的接口中删除这些输入。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-291">In the `Inserting` event handler, provide hard-coded, default values to use for these inputs that have been removed from the inserting interface.</span></span>
- <span data-ttu-id="2a1c7-292">创建的新重载`AddProduct`中的方法`ProductsBLL`不接受输入的类`UnitsOnOrder`， `UnitsInStock`，和`ReorderLevel`字段。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-292">Create a new overload of the `AddProduct` method in the `ProductsBLL` class that does not accept inputs for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="2a1c7-293">然后，在 ASP.NET 页中，配置对象数据源以使用此新的重载。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-293">Then, in the ASP.NET page, configure the ObjectDataSource to use this new overload.</span></span>

<span data-ttu-id="2a1c7-294">这两个选项同样也将工作。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-294">Either option will work equally as well.</span></span> <span data-ttu-id="2a1c7-295">在过去的教程我们使用后一种方式，创建多个重载`ProductsBLL`类的`UpdateProduct`方法。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-295">In past tutorials we used the latter option, creating multiple overloads for the `ProductsBLL` class s `UpdateProduct` method.</span></span>

## <a name="summary"></a><span data-ttu-id="2a1c7-296">总结</span><span class="sxs-lookup"><span data-stu-id="2a1c7-296">Summary</span></span>

<span data-ttu-id="2a1c7-297">GridView 缺少内置插入中的功能之外的说明和 FormView，但进行少量的工作量插入接口可以添加到页脚行。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-297">The GridView lacks the built-in inserting capabilities found in the DetailsView and FormView, but with a bit of effort an inserting interface can be added to the footer row.</span></span> <span data-ttu-id="2a1c7-298">若要只需在一个 GridView 中显示的页脚行设置其`ShowFooter`属性`True`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-298">To display the footer row in a GridView simply set its `ShowFooter` property to `True`.</span></span> <span data-ttu-id="2a1c7-299">由字段转换为 TemplateField，可以为每个字段定制的页脚行内容，并添加插入接口`FooterTemplate`。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-299">The footer row content can be customized for each field by converting the field to a TemplateField and adding the inserting interface to the `FooterTemplate`.</span></span> <span data-ttu-id="2a1c7-300">正如我们在本教程中，看到`FooterTemplate`只能包含按钮、 文本框中，DropDownLists、 复选框，用于填充数据驱动的 Web 控件 （如 DropDownLists)，数据源控件和验证控件。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-300">As we saw in this tutorial, the `FooterTemplate` can contain Buttons, TextBoxes, DropDownLists, CheckBoxes, data source controls for populating data-driven Web controls (such as DropDownLists), and validation controls.</span></span> <span data-ttu-id="2a1c7-301">用于收集用户的输入控件，以及需要添加按钮、 LinkButton 或 ImageButton。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-301">Along with controls for collecting the user s input, an Add Button, LinkButton, or ImageButton is needed.</span></span>

<span data-ttu-id="2a1c7-302">单击添加按钮后，ObjectDataSource 的`Insert()`方法调用以启动插入工作流。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-302">When the Add button is clicked, the ObjectDataSource s `Insert()` method is invoked to start the inserting workflow.</span></span> <span data-ttu-id="2a1c7-303">ObjectDataSource 然后调用配置的 insert 方法 (`ProductsBLL`类的`AddProduct`方法，在本教程中)。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-303">The ObjectDataSource will then call the configured insert method (the `ProductsBLL` class s `AddProduct` method, in this tutorial).</span></span> <span data-ttu-id="2a1c7-304">我们必须将值插入到 ObjectDataSource s 的接口的 GridView s 从复制`InsertParameters`之前正在调用的插入方法的集合。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-304">We must copy the values from the GridView s inserting interface to the ObjectDataSource s `InsertParameters` collection prior to the insert method being invoked.</span></span> <span data-ttu-id="2a1c7-305">这可以通过以编程方式引用 ObjectDataSource s 中的插入接口 Web 控件来实现`Inserting`事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-305">This can be accomplished by programmatically referencing the inserting interface Web controls in the ObjectDataSource s `Inserting` event handler.</span></span>

<span data-ttu-id="2a1c7-306">本教程中完成我们看增强 GridView 的外观的技术。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-306">This tutorial completes our look at techniques for enhancing the GridView s appearance.</span></span> <span data-ttu-id="2a1c7-307">教程的下一组将检查如何处理二进制数据，如图像、 Pdf、 Word 文档中，依次类推和 Web 控件的数据。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-307">The next set of tutorials will examine how to work with binary data such as images, PDFs, Word documents, and so on and the data Web controls.</span></span>

<span data-ttu-id="2a1c7-308">尽情享受编程 ！</span><span class="sxs-lookup"><span data-stu-id="2a1c7-308">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="2a1c7-309">关于作者</span><span class="sxs-lookup"><span data-stu-id="2a1c7-309">About the Author</span></span>

<span data-ttu-id="2a1c7-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七个 ASP/ASP.NET 书籍和的创始人[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年使用与 Microsoft Web 技术。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="2a1c7-311">Scott 的作用是作为独立的顾问、 培训师和编写器。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-311">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="2a1c7-312">最新书籍是[ *Sam 教授自己 ASP.NET 2.0 24 小时内*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-312">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="2a1c7-313">他可以达到在[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)或通过他的博客，其中可以找到在[ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-313">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="2a1c7-314">特别感谢</span><span class="sxs-lookup"><span data-stu-id="2a1c7-314">Special Thanks To</span></span>

<span data-ttu-id="2a1c7-315">本教程系列已由许多有用的审阅者评审。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-315">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="2a1c7-316">本教程中的前导审阅者已伯纳黛特 Leigh。</span><span class="sxs-lookup"><span data-stu-id="2a1c7-316">Lead reviewer for this tutorial was Bernadette Leigh.</span></span> <span data-ttu-id="2a1c7-317">对感兴趣查看我即将到来的 MSDN 文章？</span><span class="sxs-lookup"><span data-stu-id="2a1c7-317">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="2a1c7-318">如果是这样，删除我一行[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2a1c7-318">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="2a1c7-319">上一篇</span><span class="sxs-lookup"><span data-stu-id="2a1c7-319">Previous</span></span>](adding-a-gridview-column-of-checkboxes-vb.md)
